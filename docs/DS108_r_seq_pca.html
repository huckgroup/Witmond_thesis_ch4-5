<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="mwitmond" />

<meta name="date" content="2024-03-12" />

<title>DS108 ID-seq analysis: PCA exploration</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Chapters on DLBCL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Paper
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="y_paper_main.html">Main</a>
    </li>
    <li>
      <a href="z_paper_suppl.html">Supplementary</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Proteins ch
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="t_proteins_main.html.html">Main</a>
    </li>
    <li>
      <a href="u_proteins_suppl.html.html">Supplementary</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    States ch
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="v_states_main.html.html">Main</a>
    </li>
    <li>
      <a href="w_states_suppl.html.html">Supplementary</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Flow
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="a_flow_gating.html">Gating</a>
    </li>
    <li>
      <a href="b_flow_ann.html">Annotation</a>
    </li>
    <li>
      <a href="c_flow_vis.html">Visualisation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    IDseq
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="d_IDseq_count.html">Count tables</a>
    </li>
    <li>
      <a href="DS108_p_seq_comparisons.html">DS108 clean</a>
    </li>
    <li>
      <a href="DS108_q_seq_thresholds.html">DS108 thresholds</a>
    </li>
    <li>
      <a href="DS108_r_seq_pca.html">DS108 PCA</a>
    </li>
  </ul>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">DS108 ID-seq analysis: PCA exploration</h1>
<h4 class="author">mwitmond</h4>
<h4 class="date">2024-03-12</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2025-02-12
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>chapters_DLBCL/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20241022code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20241022)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20241022code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20241022)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrong1ffbd94">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong> 1ffbd94
</a>
</p>
</div>
<div id="strongRepositoryversionstrong1ffbd94"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version 1ffbd94.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/figure/

Untracked files:
    Untracked:  code/packages_FACS.R
    Untracked:  code/packages_seq.R
    Untracked:  data/AL006_InhibCombiTest/
    Untracked:  data/DS102_StimTest/
    Untracked:  data/DS103_ViabilityTest/
    Untracked:  data/DS104_StimInhibTest/
    Untracked:  data/DS108_StimInhibIDseq/
    Untracked:  data/DS113_InhibCombiIDseq/
    Untracked:  output/DS102_StimTest/
    Untracked:  output/DS103_ViabilityTest/
    Untracked:  output/DS104_StimInhibTest/
    Untracked:  output/DS108_StimInhibIDseq/
    Untracked:  output/DS113_InhibCombiIDseq/
    Untracked:  output/figures/
    Untracked:  output/network_visual_DLBCL/
    Untracked:  output/network_visual_paper/

Unstaged changes:
    Deleted:    analysis/about.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/DS108_r_seq_pca.Rmd</code>) and
HTML (<code>docs/DS108_r_seq_pca.html</code>) files. If you’ve
configured a remote Git repository (see <code>?wflow_git_remote</code>),
click on the hyperlinks in the table below to view the files as they
were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
6559698
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
<td>
Paper figs + analysis files for ch figs
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="set-up" class="section level2">
<h2>Set-up</h2>
<pre class="r"><code>row_order = c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;H&quot;)
col_order = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;)
panel_labels &lt;- c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;,&quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;i&quot;, &quot;j&quot;, &quot;k&quot;, &quot;l&quot;, &quot;m&quot;)

textsize &lt;- theme(axis.text.x = element_text(colour = &quot;grey&quot;, size = 11), #, face = &quot;bold&quot;
                  axis.text.y = element_text(colour = &quot;grey&quot;, size = 11),
                  axis.title = element_text(colour = &quot;black&quot;, size = 12), 
                  legend.title = element_text(colour = &quot;black&quot;, size = 12),
                  # legend.title = element_blank(), 
                  legend.text = element_text(colour = &quot;grey&quot;, size = 11), 
                  strip.text.x = element_text(colour = &quot;black&quot;, size = 12)
)

# textsize_small &lt;- theme(text = element_text(size = 7, family = &quot;sans&quot;, colour = &quot;black&quot;),
#                         plot.title = element_text(size = 8)
# )
textsize_small &lt;- theme(axis.text.x = element_text(colour = &quot;black&quot;, size = 9),
                        axis.text.y = element_text(colour = &quot;black&quot;, size = 9),
                        axis.title = element_text(colour = &quot;black&quot;, size = 10),
                        legend.text = element_text(colour = &quot;black&quot;, size = 9),
                        title = element_text(color = &quot;black&quot;, size = 10),
                        strip.text.x = element_text(colour = &quot;black&quot;, size = 10),
                        strip.text.y = element_text(colour = &quot;black&quot;, size = 10)
)

colors_dark9 &lt;- c(&quot;#4daf4a&quot;, &quot;#984ea3&quot;, &quot;#377eb8&quot;, &quot;#ff7f00&quot;, &quot;#f781bf&quot;, &quot;#ffff33&quot;, &quot;#e41a1c&quot;, &quot;#a65628&quot;, &quot;#999999&quot;)
colors_light12 &lt;- c(&quot;#8dd3c7&quot;,&quot;#ffffb3&quot;,&quot;#bebada&quot;,&quot;#fb8072&quot;,&quot;#80b1d3&quot;,&quot;#fdb462&quot;,&quot;#b3de69&quot;,&quot;#fccde5&quot;,&quot;#d9d9d9&quot;,&quot;#bc80bd&quot;,&quot;#ccebc5&quot;,&quot;#ffed6f&quot;)
colors_paired10 &lt;- c(&quot;#a6cee3&quot;, &quot;#1f78b4&quot;, &quot;#b2df8a&quot;, &quot;#33a02c&quot;, &quot;#fdbf6f&quot;, &quot;#ff7f00&quot;, &quot;#cab2d6&quot;, &quot;#6a3d9a&quot;, &quot;#fb9a99&quot;, &quot;#e31a1c&quot;)

colors_blue9 &lt;- c(&quot;#f7fbff&quot;, &quot;#deebf7&quot;, &quot;#c6dbef&quot;, &quot;#9ecae1&quot;, &quot;#6baed6&quot;, &quot;#4292c6&quot;, &quot;#2171b5&quot;, &quot;#08519c&quot;, &quot;#08306b&quot;)
colors_green9 &lt;- c(&quot;#f7fcf5&quot;, &quot;#e5f5e0&quot;, &quot;#c7e9c0&quot;, &quot;#a1d99b&quot;, &quot;#74c476&quot;, &quot;#41ab5d&quot;, &quot;#238b45&quot;, &quot;#006d2c&quot;, &quot;#00441b&quot;)
colors_purple9 &lt;- c(&quot;#fcfbfd&quot;, &quot;#efedf5&quot;, &quot;#dadaeb&quot;, &quot;#bcbddc&quot;, &quot;#9e9ac8&quot;, &quot;#807dba&quot;, &quot;#6a51a3&quot;, &quot;#54278f&quot;, &quot;#3f007d&quot;)
colors_red9 &lt;- c(&quot;#fff5f0&quot;, &quot;#fee0d2&quot;, &quot;#fcbba1&quot;, &quot;#fc9272&quot;, &quot;#fb6a4a&quot;, &quot;#ef3b2c&quot;, &quot;#cb181d&quot;, &quot;#a50f15&quot;, &quot;#67000d&quot;)
colors_orange9 &lt;- c(&quot;#fff5eb&quot;, &quot;#fee6ce&quot;, &quot;#fdd0a2&quot;, &quot;#fdae6b&quot;, &quot;#fd8d3c&quot;, &quot;#f16913&quot;, &quot;#d94801&quot;, &quot;#a63603&quot;, &quot;#7f2704&quot;)
colors_grey9 &lt;- c(&quot;#ffffff&quot;, &quot;#f0f0f0&quot;, &quot;#d9d9d9&quot;, &quot;#bdbdbd&quot;, &quot;#969696&quot;, &quot;#737373&quot;, &quot;#525252&quot;, &quot;#252525&quot;, &quot;#000000&quot;)

colors_yb9 &lt;- c(&quot;#ffffd9&quot;, &quot;#edf8b1&quot;, &quot;#c7e9b4&quot;, &quot;#7fcdbb&quot;, &quot;#41b6c4&quot;, &quot;#1d91c0&quot;, &quot;#225ea8&quot;, &quot;#253494&quot;, &quot;#081d58&quot;)
colors_pr9 &lt;- c(&quot;#f7f4f9&quot;, &quot;#e7e1ef&quot;, &quot;#d4b9da&quot;, &quot;#c994c7&quot;, &quot;#df65b0&quot;, &quot;#e7298a&quot;, &quot;#ce1256&quot;, &quot;#980043&quot;, &quot;#67001f&quot;)

colors_proteins &lt;- c(&quot;pCD79a (Y182)&quot; = &quot;#892BE1&quot;, &quot;pSYK (Y525/Y526)&quot; = &quot;#1E8FFF&quot;, &quot;pPLCy2 (Y759)&quot; = &quot;#20B1A9&quot;)
colors_inhib &lt;- c(&quot;iSYK&quot; = &quot;#41ab5d&quot;, &quot;iBTK&quot; = &quot;#807dba&quot;, &quot;iPI3Kd&quot; = &quot;#4292c6&quot;, &quot;iNFkB&quot; = &quot;#f16913&quot;)
colors_stim &lt;- c(&quot;PBS&quot; = &quot;#525252&quot;, &quot;aIg+H2O2&quot; = &quot;#fdae6b&quot;)
colors_cell &lt;- c(&quot;HBL1&quot; = &quot;#df65b0&quot;, &quot;OCI-Ly8&quot; = &quot;#41b6c4&quot;)
colors_inhib_conc &lt;- c(colors_green9[c(2, 3, 5, 7, 9)], colors_purple9[c(2, 3, 5, 7, 9)], colors_orange9[c(2, 3, 5, 7, 9)])
names(colors_inhib_conc) &lt;- c(&quot;0 uM iSYK (DMSO)&quot;, &quot;0.1 uM iSYK&quot;, &quot;1 uM iSYK&quot;, &quot;10 uM iSYK&quot;, &quot;100 uM iSYK&quot;, 
                              &quot;0 uM iBTK (DMSO)&quot;, &quot;0.1 uM iBTK&quot;, &quot;1 uM iBTK&quot;, &quot;10 uM iBTK&quot;, &quot;100 uM iBTK&quot;, 
                              &quot;0 uM iNFkB (DMSO)&quot;, &quot;0.1 uM iNFkB&quot;, &quot;1 uM iNFkB&quot;, &quot;10 uM iNFkB&quot;, &quot;100 uM iNFkB&quot;)</code></pre>
<pre class="r"><code>plates_DS108 &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;)
cells_DS108 &lt;- c(&quot;HBL1&quot;, &quot;OCI-Ly8&quot;)
stim_DS108 &lt;- c(&quot;PBS&quot;, &quot;aIg+H2O2&quot;)
inhib_DS108 &lt;- c(&quot;iSYK&quot;, &quot;iBTK&quot;, &quot;iPI3Kd&quot;, &quot;iNFkB&quot;)
inhib_conc_DS108 &lt;- c(&quot;0 uM (nostain)&quot;, &quot;0 uM (PBS)&quot;, &quot;0 uM (DMSO)&quot;, &quot;0.1 uM&quot;, &quot;1 uM&quot;, &quot;10 uM&quot;, &quot;100 uM&quot;)
inhib_conc_label &lt;- c(&quot;0 uM\n(nostain)&quot;, &quot;0 uM\n(PBS)&quot;, &quot;0 uM\n(DMSO)&quot;, &quot;0.1 uM&quot;, &quot;1 uM&quot;, &quot;10 uM&quot;, &quot;100 uM&quot;)
inhib_full_DS108 &lt;- c(&quot;0 uM iSYK (nostain)&quot;, &quot;0 uM iSYK (PBS)&quot;, &quot;0 uM iSYK (DMSO)&quot;, &quot;0.1 uM iSYK&quot;, &quot;1 uM iSYK&quot;, &quot;10 uM iSYK&quot;, &quot;100 uM iSYK&quot;, 
                      &quot;0 uM iBTK (nostain)&quot;, &quot;0 uM iBTK (PBS)&quot;, &quot;0 uM iBTK (DMSO)&quot;, &quot;0.1 uM iBTK&quot;, &quot;1 uM iBTK&quot;, &quot;10 uM iBTK&quot;, &quot;100 uM iBTK&quot;, 
                      &quot;0 uM iPI3Kd (nostain)&quot;, &quot;0 uM iPI3Kd (PBS)&quot;, &quot;0 uM iPI3Kd (DMSO)&quot;, &quot;0.1 uM iPI3Kd&quot;, &quot;1 uM iPI3Kd&quot;, &quot;10 uM iPI3Kd&quot;, &quot;100 uM iPI3Kd&quot;,
                      &quot;0 uM iNFkB (nostain)&quot;, &quot;0 uM iNFkB (PBS)&quot;, &quot;0 uM iNFkB (DMSO)&quot;, &quot;0.1 uM iNFkB&quot;, &quot;1 uM iNFkB&quot;, &quot;10 uM iNFkB&quot;, &quot;100 uM iNFkB&quot;)</code></pre>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<pre class="r"><code>data_well_all &lt;- read_csv(&quot;output/DS108_StimInhibIDseq/IDseq_ann/IDseq_data_sample.csv&quot;)
data_mean_all &lt;- read_csv(&quot;output/DS108_StimInhibIDseq/IDseq_ann/IDseq_data_condition.csv&quot;)

meta_cols &lt;- c(&quot;plate_well&quot;, &quot;plate&quot;, &quot;well&quot;, &quot;experiment&quot;, &quot;cell_line&quot;, &quot;stimulus&quot;, &quot;inhibitor&quot;, &quot;inhib_conc_uM&quot;, &quot;inhib_conc&quot;, &quot;inhib_conc_text&quot;, &quot;inhib_text_new&quot;, &quot;replicate&quot;, &quot;description&quot;, &quot;descript_rep&quot;)

# Add a column with DMSO ctrl and PBS ctrl as inhibitors (instead of only under conc)
data_well_all &lt;- data_well_all %&gt;%
  mutate(inhib_new = case_when(inhib_conc == &quot;0 uM (PBS)&quot; ~ &quot;PBS ctrl&quot;, 
                               inhib_conc == &quot;0 uM (DMSO)&quot; ~ &quot;DMSO ctrl&quot;, 
                               .default = inhibitor), 
         inhib_text_new = case_when(inhib_conc == &quot;0 uM (PBS)&quot; ~ &quot;PBS ctrl&quot;, 
                                    inhib_conc == &quot;0 uM (DMSO)&quot; ~ &quot;DMSO ctrl&quot;, 
                                    .default = inhib_conc_text))
data_mean_all &lt;- data_mean_all %&gt;%
  mutate(inhib_new = case_when(inhib_conc == &quot;0 uM (PBS)&quot; ~ &quot;PBS ctrl&quot;, 
                               inhib_conc == &quot;0 uM (DMSO)&quot; ~ &quot;DMSO ctrl&quot;, 
                               .default = inhibitor), 
         inhib_text_new = case_when(inhib_conc == &quot;0 uM (PBS)&quot; ~ &quot;PBS ctrl&quot;, 
                                    inhib_conc == &quot;0 uM (DMSO)&quot; ~ &quot;DMSO ctrl&quot;, 
                                    .default = inhib_conc_text))

inhib_new_DS108 &lt;- c(&quot;DMSO ctrl&quot;, &quot;PBS ctrl&quot;, &quot;iSYK&quot;, &quot;iBTK&quot;, &quot;iPI3Kd&quot;, &quot;iNFkB&quot;)

# Remove iPI3Kd, 0 uM (PBS) and proteins BIM and Histone H2A.X S139 samples from the dataset
data_well_all &lt;- data_well_all %&gt;%
  filter(inhibitor != &quot;iPI3Kd&quot; &amp; inhib_conc != &quot;0 uM (PBS)&quot; &amp; target_nospace != &quot;BIM&quot;&amp; target_nospace != &quot;Histone_H2AX_S139&quot;) #
data_mean_all &lt;- data_mean_all %&gt;%
  filter(inhibitor != &quot;iPI3Kd&quot; &amp; inhib_conc != &quot;0 uM (PBS)&quot; &amp; target_nospace != &quot;BIM&quot;&amp; target_nospace != &quot;Histone_H2AX_S139&quot;) #</code></pre>
</div>
<div id="pca-via-deseq2-analysis" class="section level2">
<h2>PCA via DEseq2 analysis</h2>
<p><a
href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html"
class="uri">https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html</a></p>
<div id="all-samples" class="section level3">
<h3>All samples</h3>
<p>DESeq2 analysis parameters:</p>
<ul>
<li><p>all samples except nostain</p></li>
<li><p>Compensated counts (&gt;= 1)</p></li>
<li><p>Model design: description</p></li>
</ul>
<pre class="r"><code># Prepare data to load into DESeq dataset
# cts: dataframe with proteins as row names, wells as column names, and count data as cell values
# coldata: dataframe with wells as row names and all metadata as columns
cts &lt;- data_well_all  %&gt;%
  filter(counts &gt;= 1) %&gt;%
  dplyr::select(target_nospace, plate_well, counts) %&gt;%
  filter(!is.na(counts)) %&gt;%
  spread(plate_well, counts) %&gt;%
  replace(is.na(.), 0)

rownames(cts) &lt;- cts$target_nospace
cts &lt;- as.matrix(as.data.frame(cts[2:ncol(cts)]))

coldata &lt;- data.frame(plate_well = colnames(cts)) %&gt;%
  left_join(distinct(dplyr::select(data_well_all, all_of(meta_cols)))) %&gt;%
  mutate(stimulus = factor(stimulus, levels = stim_DS108), 
         cell_line = factor(cell_line, levels = cells_DS108), 
         inhibitor = factor(inhibitor, levels = inhib_DS108), 
         inhib_conc = factor(inhib_conc, levels = inhib_conc_DS108)) #If necessary, make factors of some metadata columns

rownames(coldata) &lt;- coldata$plate_well

# Create DESeq object
# First define how the model is designed. Place most important parameter last
# modeldesign &lt;- ~ cell_line + inhibitor + inhib_conc + stimulus
modeldesign &lt;- ~ description

# Then create the DESeq dataset
dds &lt;- DESeqDataSetFromMatrix(countData = cts,
                              colData = coldata,
                              design = modeldesign)
# Define the reference samples for design parameter
# dds$cell_line &lt;- relevel(dds$cell_line, ref = &quot;HBL1&quot;)
# dds$inhibitor &lt;- relevel(dds$inhibitor, ref = &quot;iSYK&quot;)
# dds$stimulus &lt;- relevel(dds$stimulus, ref = &quot;PBS&quot;)
# dds$inhib_conc &lt;- relevel(dds$inhib_conc, ref = &quot;0 uM (DMSO)&quot;)

# Run DESeq2: 
  # This function performs a default analysis through the steps:
  # Estimation of size factors: estimateSizeFactors
  # Estimation of dispersion: estimateDispersions
  # Negative Binomial GLM fitting and Wald statistics: nbinomWaldTest

# dds &lt;- estimateSizeFactors(dds, controlGenes = ctrl_genes) # OPTIONAL: normalise data with specified control genes
dds &lt;- DESeq(dds, test = &quot;Wald&quot;, fitType = &quot;local&quot;)
DESeq_comparisons &lt;- resultsNames(dds) # lists the coefficients
# DESeq_comparisons</code></pre>
<pre class="r"><code># Normtransform (log2(n+1))
DESeq2_ntd &lt;- normTransform(dds)

# Variance stabilising transform
DESeq2_vsd &lt;- vst(dds, blind = FALSE, nsub = nrow(dds))

# Regularized log transform
DESeq2_rld &lt;- rlog(dds, blind = FALSE)</code></pre>
<pre class="r"><code># Results
DESeq2_pcaData &lt;- plotPCA(unlist(DESeq2_rld), intgroup = c(&quot;stimulus&quot;, &quot;cell_line&quot;, &quot;inhibitor&quot;, &quot;inhib_conc&quot;), returnData = TRUE)
percentVar &lt;- round(100 * attr(DESeq2_pcaData, &quot;percentVar&quot;))

# Test
rv &lt;- rowVars(assay(DESeq2_rld), useNames = TRUE) # calculate the variance for each gene
select &lt;- order(rv, decreasing=TRUE)[seq_len(min(106, length(rv)))] # select the ntop genes by variance
test_pca &lt;- prcomp(t(assay(DESeq2_rld)[select,])) # perform a PCA on the data in assay(x) for the selected genes

test_percentVar &lt;- test_pca$sdev^2 / sum(test_pca$sdev^2) # the contribution to the total variance for each component

test_comp &lt;- test_pca[[&quot;x&quot;]]
test_comp &lt;- data.frame(test_comp)
test_comp$PC2 &lt;- test_comp$PC2
test_comp$PC3 &lt;- -test_comp$PC3
test_data &lt;- test_comp[, 1:3] %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  left_join(coldata)

test_expl_var &lt;- (summary(test_pca)[[&quot;importance&quot;]][&#39;Proportion of Variance&#39;,]) * 100
test_expl_var3 &lt;- sum(test_expl_var[1:3])

# # Test 2
# rv &lt;- rowVars(assay(DESeq2_rld), useNames = FALSE) # calculate the variance for each gene
# select &lt;- order(rv, decreasing=TRUE)[seq_len(min(106, length(rv)))] # select the ntop genes by variance
# test2_pca &lt;- PCA(t(assay(DESeq2_rld)[unique(c(data_well_all$target_nospace)), rownames(coldata)]), scale.unit = FALSE, ncp = 5, graph = FALSE) # perform a PCA on the data in assay(x) for the selected genes
# # Percentage variance explained by each PC
# test2_expl_var &lt;- as.data.frame(get_eigenvalue(test2_pca)) %&gt;%
#   rownames_to_column(&quot;PC&quot;) %&gt;%
#   pull(var = variance.percent, name = PC) %&gt;%
#   round(digits = 1)
# 
# # Results focused on variables (proteins)
# test2_variab &lt;- get_pca_var(test2_pca)
# 
# # Results focused on individuals (wells)
# test2_indiv &lt;- get_pca_ind(test2_pca)
# test2_data &lt;- as.data.frame(test2_indiv$coord[, 1:3]) %&gt;%
#   rownames_to_column(&quot;plate_well&quot;) %&gt;%
#   dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3) %&gt;%
#   left_join(coldata)</code></pre>
<pre class="r"><code>plot &lt;- ggplot(DESeq2_pcaData, aes(PC1, PC2, color = stimulus, fill = stimulus, shape = inhib_conc)) +
  geom_point(size = 2) +
  xlab(paste0(&quot;PC1: &quot;, percentVar[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, percentVar[2], &quot;% variance&quot;)) + 
  coord_fixed() +
  facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(&quot;PBS&quot; = &quot;black&quot;, &quot;aIg+H2O2&quot;= &quot;orange&quot;), name = &quot;Stimulus&quot;) + 
  scale_fill_manual(values = c(&quot;PBS&quot; = &quot;black&quot;, &quot;aIg+H2O2&quot;= &quot;orange&quot;), name = &quot;Stimulus&quot;) + 
  scale_shape_manual(values = c(16, 17, 10, 7, 3, 8), name = &quot;Inhib conc&quot;) +
  # ggtitle(titles_datatransform[data]) +
  theme_bw() +
  textsize_small

print(plot)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/DESeq2_PCA-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-DESeq2_PCA-1">
Past versions of DESeq2_PCA-1.png
</button>
</p>
<div id="fig-DESeq2_PCA-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fig &lt;- plot_ly(test_data, x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_conc, colors = colors_blue9[3:7]) %&gt;%
#   add_markers(size = 12) %&gt;%
#   layout(title = paste(&quot;Variance explained:&quot;, sum(test_expl_var[1:3])))
# fig

plot &lt;- ggplot(test_data, aes(PC1, PC2, color = paste(stimulus, &quot;-&quot;, inhib_conc), shape = cell_line)) +
  geom_point(size = 2) +
  # xlab(paste0(&quot;PC1: &quot;, test_expl_var[1], &quot;% variance&quot;)) +
  # ylab(paste0(&quot;PC3: &quot;, test_expl_var[3], &quot;% variance&quot;)) +
  coord_fixed() +
  # facet_grid(cell_line~inhibitor) +
  # scale_color_manual(values = c(&quot;PBS&quot; = &quot;black&quot;, &quot;aIg+H2O2&quot;= &quot;orange&quot;), name = &quot;Stimulus&quot;) + 
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  # scale_shape_manual(values = c(16, 17, 10, 7, 3, 8), name = &quot;Inhib conc&quot;) +
  # ggtitle(titles_datatransform[data]) +
  theme_bw() +
  textsize_small
print(plot)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/DESeq2_test-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-DESeq2_test-1">
Past versions of DESeq2_test-1.png
</button>
</p>
<div id="fig-DESeq2_test-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>fviz_eig(test2_pca, addlabels = TRUE)

contrib_2.5p &lt;- as.data.frame(test2_variab$contrib) %&gt;%
  # rownames_to_column(&quot;target_nospace&quot;) %&gt;%
  filter(Dim.1 &gt;= 2.5 | Dim.2 &gt;= 2.5 | Dim.3 &gt;= 2.5) %&gt;% # | Dim.4 &gt;= 1 | Dim.5 &gt;= 1
  dplyr::rename(PC1 = Dim.1, PC2 =  Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC5 = Dim.5) %&gt;%
  dplyr::select(c(PC1, PC2, PC3)) %&gt;%
  as.matrix()
  # filter_all(any_vars(.&gt;1))
corrplot(contrib_2.5p, is.corr = FALSE, method = &quot;circle&quot;, outline = TRUE, 
         tl.col = &quot;black&quot;, cl.ratio = 0.75, cl.offset = 1, 
         title = &quot;Protein contributions to PC (&gt;2.5% in any PC)&quot;)</code></pre>
</div>
</div>
<div id="pca-via-factominer" class="section level2">
<h2>PCA via FactoMineR</h2>
<div id="all-samples-1" class="section level3">
<h3>All samples</h3>
<p>PCA with all samples together, followed by subsetting for
visualisation</p>
<div id="pca" class="section level4">
<h4>PCA</h4>
<pre class="r"><code># Prepare data for FactoMineR package
# cts: dataframe with wells as row names, proteins as column names, and count data as cell values
# coldata: dataframe with wells as row names and all metadata as columns
cts &lt;- data_well_all  %&gt;%
  filter(counts &gt;= 1) %&gt;%
  dplyr::select(target_nospace, plate_well, counts_norm) %&gt;%
  filter(!is.na(counts_norm)) %&gt;%
  spread(target_nospace, counts_norm) %&gt;%
  replace(is.na(.), 0)

cts &lt;- column_to_rownames(cts, &quot;plate_well&quot;)
# cts2 &lt;- as.matrix(as.data.frame(cts), row_names = TRUE)

coldata &lt;- data.frame(plate_well = rownames(cts)) %&gt;%
  left_join(distinct(dplyr::select(data_well_all, all_of(meta_cols)))) %&gt;%
  mutate(stimulus = factor(stimulus, levels = stim_DS108), 
         cell_line = factor(cell_line, levels = cells_DS108), 
         inhibitor = factor(inhibitor, levels = inhib_DS108), 
         inhib_conc = factor(inhib_conc, levels = inhib_conc_DS108)) #If necessary, make factors of some metadata columns

rownames(coldata) &lt;- coldata$plate_well</code></pre>
<pre class="r"><code># Results
results_all &lt;- PCA(cts, scale.unit = FALSE, ncp = 5, graph = FALSE)

# Percentage variance explained by each PC
expl_var_all &lt;- as.data.frame(get_eigenvalue(results_all)) %&gt;%
  rownames_to_column(&quot;PC&quot;) %&gt;%
  pull(var = variance.percent, name = PC) %&gt;%
  round(digits = 1)

# Results focused on variables (proteins)
variab_all &lt;- get_pca_var(results_all) 
# head(variab$contrib)

# Results focused on individuals (wells)
indiv_all &lt;- get_pca_ind(results_all) 
# head(indiv$contrib)
pca_data_all &lt;- as.data.frame(indiv_all$coord[, 1:3]) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3) %&gt;% 
  left_join(coldata)</code></pre>
<pre class="r"><code># Variance explained by each PC (eigenvalues)
fviz_eig(results_all, addlabels = TRUE)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_all-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_all-1">
Past versions of Facto_vis_all-1.png
</button>
</p>
<div id="fig-Facto_vis_all-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>fviz_pca_var(results_all, col.var = &quot;black&quot;)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_all-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_all-2">
Past versions of Facto_vis_all-2.png
</button>
</p>
<div id="fig-Facto_vis_all-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Quality of representation for variables
# corrplot(variab_all$cos2, is.corr = FALSE)
# corrplot(variab_all$contrib, is.corr = FALSE)

contrib_2.5p &lt;- as.data.frame(variab_all$contrib) %&gt;%
  # rownames_to_column(&quot;target_nospace&quot;) %&gt;%
  filter(Dim.1 &gt;= 2.5 | Dim.2 &gt;= 2.5 | Dim.3 &gt;= 2.5) %&gt;% # | Dim.4 &gt;= 1 | Dim.5 &gt;= 1
  dplyr::rename(PC1 = Dim.1, PC2 =  Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC5 = Dim.5) %&gt;%
  dplyr::select(c(PC1, PC2, PC3)) %&gt;%
  as.matrix()
  # filter_all(any_vars(.&gt;1))
corrplot(contrib_2.5p, is.corr = FALSE, method = &quot;circle&quot;, outline = TRUE, 
         tl.col = &quot;black&quot;, cl.ratio = 0.75, cl.offset = 1, 
         title = &quot;Protein contributions to PC (&gt;2.5% in any PC)(all)&quot;)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_all-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_all-3">
Past versions of Facto_vis_all-3.png
</button>
</p>
<div id="fig-Facto_vis_all-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Top10 contributing proteins to PC1-3
fig_PC1 &lt;- fviz_contrib(results_all, choice = &quot;var&quot;, axes = 1, top = 10)
fig_PC2 &lt;- fviz_contrib(results_all, choice = &quot;var&quot;, axes = 2, top = 10)
fig_PC3 &lt;- fviz_contrib(results_all, choice = &quot;var&quot;, axes = 3, top = 10)
plot_grid(fig_PC1, fig_PC2, fig_PC3, ncol = 3)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_all-4.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_all-4">
Past versions of Facto_vis_all-4.png
</button>
</p>
<div id="fig-Facto_vis_all-4" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>fig_PC12 &lt;- fviz_pca_ind(results_all,
             axes = c(1, 2),
             geom.ind = &quot;point&quot;,
             mean.point = FALSE,
             col.ind = paste(coldata$cell_line, coldata$stimulus),
             addEllipses = TRUE)
fig_PC13 &lt;- fviz_pca_ind(results_all,
             axes = c(1, 3),
             geom.ind = &quot;point&quot;,
             mean.point = FALSE,
             col.ind = paste(coldata$cell_line, coldata$stimulus),
             addEllipses = TRUE)
fig_PC23 &lt;- fviz_pca_ind(results_all,
             axes = c(2, 3),
             geom.ind = &quot;point&quot;,
             mean.point = FALSE,
             col.ind = paste(coldata$cell_line, coldata$stimulus),
             addEllipses = TRUE)
plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_all-5.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_all-5">
Past versions of Facto_vis_all-5.png
</button>
</p>
<div id="fig-Facto_vis_all-5" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="umap-visualisation" class="section level4">
<h4>UMAP visualisation</h4>
<pre class="r"><code># Data
pca_data_5PC &lt;- as.data.frame(indiv_all$coord[, 1:5]) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC53 = Dim.5) %&gt;% 
  left_join(coldata)

# UMAP data reduction
umap_pca &lt;- umap::umap(as.data.frame(indiv_all$coord[, 1:5]))
# umap.defaults
# head(umap_pca$layout)
umap_pca_ann &lt;- as.data.frame(umap_pca$layout) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(UMAP1 = V1, UMAP2 = V2) %&gt;% 
  left_join(coldata)

# Basic fig of everything
fig &lt;- ggplot(umap_pca_ann, aes(x = UMAP1, y = UMAP2)) + 
  geom_point(aes(shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 2) + 
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  ggtitle(&quot;UMAP with PC1-5&quot;) +
  theme_bw() +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_UMAP_PCA-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_UMAP_PCA-1">
Past versions of Facto_UMAP_PCA-1.png
</button>
</p>
<div id="fig-Facto_UMAP_PCA-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Figure variations
fig &lt;- ggplot(umap_pca_ann, aes(x = UMAP1, y = UMAP2)) + 
  geom_point(aes(color = inhibitor), size = 1.5) + 
  # scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  facet_grid(cell_line~stimulus) +
  ggtitle(&quot;UMAP with PC1-5&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_UMAP_PCA-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_UMAP_PCA-2">
Past versions of Facto_UMAP_PCA-2.png
</button>
</p>
<div id="fig-Facto_UMAP_PCA-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>fig &lt;- ggplot(umap_pca_ann, aes(x = UMAP1, y = UMAP2)) + 
  geom_point(aes(color = inhib_conc), size = 1.5) + 
  scale_color_manual(values = colors_purple9[c(3, 5, 6, 8, 9)]) +
  facet_grid(cell_line~stimulus) +
  ggtitle(&quot;UMAP with PC1-5&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_UMAP_PCA-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_UMAP_PCA-3">
Past versions of Facto_UMAP_PCA-3.png
</button>
</p>
<div id="fig-Facto_UMAP_PCA-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>fig &lt;- ggplot(umap_pca_ann, aes(x = UMAP1, y = UMAP2)) + 
  geom_point(aes(color = paste(cell_line, &quot;-&quot;, inhib_conc)), size = 1.5) + 
  scale_color_manual(values = c(colors_yb9[3:7], colors_pr9[3:7]), name = &quot;Cell line - Inhib conc&quot;) +
  facet_grid(inhibitor~stimulus) +
  ggtitle(&quot;UMAP with PC1-5&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_UMAP_PCA-4.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_UMAP_PCA-4">
Past versions of Facto_UMAP_PCA-4.png
</button>
</p>
<div id="fig-Facto_UMAP_PCA-4" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>fig &lt;- ggplot(umap_pca_ann, aes(x = UMAP1, y = UMAP2)) + 
  geom_point(aes(color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 1.5) + 
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  facet_grid(inhibitor~cell_line) +
  ggtitle(&quot;UMAP with PC1-5&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_UMAP_PCA-5.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_UMAP_PCA-5">
Past versions of Facto_UMAP_PCA-5.png
</button>
</p>
<div id="fig-Facto_UMAP_PCA-5" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>cts &lt;- data_well_all  %&gt;%
  filter(counts &gt;= 1) %&gt;%
  dplyr::select(target_nospace, plate_well, counts) %&gt;%
  filter(!is.na(counts)) %&gt;%
  spread(target_nospace, counts) %&gt;%
  replace(is.na(.), 0)
cts &lt;- column_to_rownames(cts, &quot;plate_well&quot;)

coldata &lt;- data.frame(plate_well = rownames(cts)) %&gt;%
  left_join(distinct(dplyr::select(data_well_all, all_of(meta_cols)))) %&gt;%
  mutate(stimulus = factor(stimulus, levels = stim_DS108), 
         cell_line = factor(cell_line, levels = cells_DS108), 
         inhibitor = factor(inhibitor, levels = inhib_DS108), 
         inhib_conc = factor(inhib_conc, levels = inhib_conc_DS108)) #If necessary, make factors of some metadata columns
rownames(coldata) &lt;- coldata$plate_well

umap_raw &lt;- umap::umap(cts)
# head(umap_pca$layout)
umap_raw_ann &lt;- as.data.frame(umap_raw$layout) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(UMAP1 = V1, UMAP2 = V2) %&gt;% 
  left_join(coldata)

fig &lt;- ggplot(umap_raw_ann) + 
  geom_point(aes(x = UMAP1, y = UMAP2, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc))) + 
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  # facet_wrap(~inhibitor) +
  ggtitle(&quot;UMAP with raw data (counts)&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_UMAP_raw-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_UMAP_raw-1">
Past versions of Facto_UMAP_raw-1.png
</button>
</p>
<div id="fig-Facto_UMAP_raw-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="everything" class="section level4">
<h4>Everything</h4>
<pre class="r"><code>fig_PC12 &lt;- ggplot(pca_data_all) + 
  geom_point(aes(x = PC1, y = PC2, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, expl_var_all[2], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC2&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC12
fig_PC13 &lt;- ggplot(pca_data_all) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC3&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC13
fig_PC23 &lt;- ggplot(pca_data_all) + 
  geom_point(aes(x = PC2, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC2: &quot;, expl_var_all[2], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC2 vs PC3&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC23

fig &lt;- plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3, align = &quot;h&quot;, rel_widths = c(1, 1, 1.5))
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_all-1.png" width="1536" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_all-1">
Past versions of Facto_2D_all-1.png
</button>
</p>
<div id="fig-Facto_2D_all-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Faceted per inhib
fig &lt;- ggplot(pca_data_all) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  facet_grid(~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_all_facet-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_all_facet-1">
Past versions of Facto_2D_all_facet-1.png
</button>
</p>
<div id="fig-Facto_2D_all_facet-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Faceted per cell line
fig &lt;- ggplot(pca_data_all) + 
  geom_point(aes(x = PC1, y = PC3, shape = stimulus, color = inhib_conc_text), size = 3) + 
  facet_grid(~cell_line) +
  scale_color_manual(values = colors_inhib_conc) +
  # scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_all_facet-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_all_facet-2">
Past versions of Facto_2D_all_facet-2.png
</button>
</p>
<div id="fig-Facto_2D_all_facet-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Faceted per inhib per cell line
fig &lt;- ggplot(pca_data_all) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_all_facet-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_all_facet-3">
Past versions of Facto_2D_all_facet-3.png
</button>
</p>
<div id="fig-Facto_2D_all_facet-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Faceted per stimulus
fig &lt;- ggplot(pca_data_all) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(cell_line, &quot;-&quot;, inhib_conc)), size = 3) + 
  facet_grid(~stimulus) +
  scale_color_manual(values = c(colors_yb9[3:7], colors_pr9[3:7]), name = &quot;Cell_line - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_all_facet-4.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_all_facet-4">
Past versions of Facto_2D_all_facet-4.png
</button>
</p>
<div id="fig-Facto_2D_all_facet-4" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Faceted per stimulus per cell line
fig &lt;- ggplot(pca_data_all) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  facet_grid(cell_line~stimulus) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_all_facet-5.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_all_facet-5">
Past versions of Facto_2D_all_facet-5.png
</button>
</p>
<div id="fig-Facto_2D_all_facet-5" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Faceted per inhib conc
fig &lt;- ggplot(pca_data_all) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  facet_grid(~inhib_conc) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_all_facet-6.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_all_facet-6">
Past versions of Facto_2D_all_facet-6.png
</button>
</p>
<div id="fig-Facto_2D_all_facet-6" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Faceted per inhib per inhib conc
fig &lt;- ggplot(pca_data_all) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  facet_grid(inhibitor~inhib_conc) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_all_facet-7.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_all_facet-7">
Past versions of Facto_2D_all_facet-7.png
</button>
</p>
<div id="fig-Facto_2D_all_facet-7" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># 3D scatter plot of PC1-3
# cell_line
fig &lt;- plot_ly(pca_data_all, x = ~PC1, y = ~PC2, z = ~PC3, color = ~cell_line, colors = colors_cell) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-4afd3cd136b767d83b20" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4afd3cd136b767d83b20">{"x":{"visdat":{"a6048ec3e44":["function () ","plotlyVisDat"]},"cur_data":"a6048ec3e44","attrs":{"a6048ec3e44":{"x":{},"y":{},"z":{},"color":{},"colors":["#df65b0","#41b6c4"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-673.90949363469122,-557.08260305166141,-223.90100292554956,-281.34024880674264,172.96450279533511,232.11926359048053,-59.280109635970298,298.79566019763263,206.46806408778528,-204.07148340617118,-173.11657670760275,-122.61556007153493,-67.960766317522172,-65.974463522210087,-55.409082066732751,111.16792567829702,219.0095239548105,-106.65087587111805,124.00431231315571,135.86758419342854,167.5375443213953,223.64870528052174,524.12776288089447,236.23807134207004,192.07749685337572,319.89521727812769,482.09615482421111,-4.9359431838147563,-155.71066136205039,-75.358415568623329,-142.74557208123869,-220.97341180202329,-75.334404999847294,-331.4889123863361,-258.12307197762635,-14.885724683435994,-178.29631391235785,-95.460529735750939,-84.121699088777589,344.28911358434004,432.8180684505229,194.29366891798554,-832.89220573075852,-769.67628693410029,-489.23408225055357,4414.9924374935554,4100.8990130043821,3594.5571379429089,3706.046249196208,5498.3100404712859,5588.125934548083,4680.4927616607947,5452.0773107539626,5368.2011400680003,3181.170633843039,3388.182264750521,3460.3379347348168,3776.3028386628821,3769.2518453780772,3736.2029343658573,2851.0384408242999,2855.2002543044377,2859.1736328732236,2261.1744610103201,2308.7000202646186,2371.7279429837458,3130.2881458945208,4597.4295676875827,3668.4793996943326,2602.3113849868887,2272.9805650261887,2911.8427999528126,1714.9441019039475,1872.6062492047304,2268.5102080310317,3335.3496980149826,3120.0829924593859,3544.0938574594675,2438.6224997634336,2052.5509321819591,2417.2736245581823,2019.5812702058772,2004.4121395448383,1886.9176757816108,1252.1329925362522,1346.6086550016857,1279.5507675265221,60.146593107046826,65.010855897317143,122.36691805839871],"y":[-1300.0801923119143,-1266.3130137389262,-1341.604238550864,-1351.7540994152216,-1792.7476149114866,-1837.0429236997797,-1598.0932108666877,-1851.105819781096,-1837.1340139835277,-1576.7442332270195,-1438.9174289874722,-1546.2989124621963,-1603.3593830804332,-1660.7449184844299,-1679.9907123223652,-1672.498994874597,-1761.2861227582328,-1465.5597310446158,-1804.0807272558743,-2053.3729715105178,-1888.1939552109379,-1886.4616211841633,-1984.0407646058377,-2045.7598022230195,-1703.8803060716471,-1808.4667779807662,-1971.87575048651,-1960.1164443250109,-1796.9700818208419,-1751.0243422913059,-1753.3243103121615,-1524.3456949767956,-1846.9098595577757,-1422.6981442489141,-1329.6379432494659,-1481.4134880467379,-1701.9196351221321,-1796.9316964160168,-1734.9791438806772,-2281.2168066466538,-2325.9121141230676,-2092.9801467378925,-1605.8842606339144,-1620.5236157756626,-1872.8342642594951,1299.953229680799,1345.7546003124057,1570.6522547186423,1633.9115438434674,1886.4245576498838,1938.54793162891,1990.605082753681,2126.9304711567947,1929.9479951153446,931.75184341564227,1079.2903635155508,1011.3720128786387,850.31323866534046,897.74586319572677,628.51446410457447,-8.498898330296111,-132.03353729581139,301.47828651411896,39.944226315998833,36.678249992775903,52.868540913268511,473.49914866142888,903.17125150775223,547.74120364377313,-187.76413705091949,-84.888986631923046,217.04736935353012,-701.52600992511555,-626.03195952803844,-748.24281219333034,277.89889132549848,384.55764905719616,121.46486888987725,-331.99849384695489,-35.09149574855649,-277.88126666280965,-816.87739889362831,-808.8440333688726,-791.92460277121961,-1878.9701449641561,-2258.158036371995,-1895.0620671821275,-1101.8364490353763,-1440.2995129463716,-1358.9699053177821],"z":[-721.94976862158899,-529.65328055895054,629.88595527179245,419.1535922829699,669.16468924436947,693.92020727310216,814.04565597634542,658.73939310230151,611.76572911636504,51.848863491704257,222.97940714834243,238.89190004239597,296.29616175807348,435.49622411509125,415.57246847339763,691.98499259419611,513.09333434385769,471.0794755833827,658.20961006975392,254.09265164748689,479.50574122910456,614.10125213388039,733.80369777721137,692.94064055949366,784.92759634818071,955.56370606440635,947.32034630293003,-228.28845973957166,-154.79006271097685,-207.12134323169977,43.172286293698228,-101.89545908018782,-43.567067888537352,-43.932634515343011,207.67137320913125,741.05018518797681,106.03111061820886,128.68441963200237,141.87567255472717,-153.08572905274059,16.68164464744072,70.010097277508436,-2060.7186144360016,-1882.7752249241628,-1885.8471614888667,-169.57456511417274,-172.90877236988061,-0.0062075790503665134,-294.85485393023424,143.91595597139536,59.054512725008493,-40.069492711451119,-154.0651826339319,-215.64457379328235,-460.57799458147701,-203.58723475288625,-137.34027494527902,29.933562077148061,-6.1152103298461702,-55.520274526589375,194.37720154253316,159.41371210012565,-200.16005739600217,-480.70568433043962,-290.69363440015724,-542.56823239929122,-416.77820178968852,-416.93032639805108,-455.04169146468712,51.733702880876571,-48.93058591575975,-261.59921211554121,-359.2304205241586,-147.25312371859127,-178.16583349818853,-326.88454370142381,-48.673283141869163,-283.8825831504044,213.33509495597067,55.551209827920331,13.866187794541519,-126.11708010706744,-103.22494406726599,-94.014095622252626,-51.970873839002032,44.531334299086751,47.491413368716799,-1371.9340226893025,-1716.3450062409634,-1530.8926800196828],"type":"scatter3d","mode":"markers","name":"HBL1","marker":{"color":"rgba(223,101,176,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(223,101,176,1)"}},"textfont":{"color":"rgba(223,101,176,1)","size":55},"error_y":{"color":"rgba(223,101,176,1)","width":55},"error_x":{"color":"rgba(223,101,176,1)","width":55},"line":{"color":"rgba(223,101,176,1)","width":55},"frame":null},{"x":[-1499.8045140840065,-1565.8493297244552,-1746.5838554191123,-1783.7082840614391,-1489.545060620982,-1507.2019451139079,-1582.7569750198641,-1586.8287383842694,-1466.9628095203047,-1461.1158296579774,-1599.379626492424,-1629.2190047367767,-1595.1501730791435,-1500.1401879218226,-1415.3243870397832,-1649.9332733786571,-1534.4295212826794,-1494.7169814202214,-1748.8192230804216,-1728.7303898675268,-1661.5152456255646,-1584.5925293832936,-1458.05259323365,-1674.0715302640422,-1484.8350894699936,-1547.0341009743329,-1416.4480715372379,-1650.4085008243976,-1652.7307778944064,-1627.8930316963897,-1680.1013114934083,-1638.562870422975,-1447.8801156941242,-1624.6156578638315,-1611.4919618008771,-1555.9151417114233,-1994.9546824636782,-1928.6585693169675,-1993.2219917993286,-1696.4815776954683,-1777.7046671094483,-1751.3981790047865,-2306.3446701498174,-2288.5816682148443,-2315.0284528086859,-581.98396418201708,-640.92136152967896,-857.54959625467939,-808.25908616588879,-563.40855940524841,-513.52641389066969,-662.14947671035532,-516.22389550062064,-391.84013959419934,-1111.9771424546886,-1163.4047822044945,-1037.6019843044439,-716.82379654232739,-724.95764174632575,-879.36017935845166,-1030.6361658090207,-1048.1550789146545,-1225.8528911142796,-1495.2934230838823,-1569.8388933349092,-1497.357683159433,-994.39322351232829,-995.78730879183206,-928.06753933087998,-1169.2298249063263,-1134.221309663096,-1098.6615803941354,-1539.5777957381038,-1528.5158928658864,-1457.1444893454866,-1277.394503784149,-1414.0731601689299,-1064.6338565355659,-1308.8636100825138,-1324.2227977524401,-1343.8705437195731,-1802.9001967576983,-1695.9458511335527,-1829.3025764796041,-1792.7746914212778,-1561.9587054789911,-1773.3404866695396,-2016.255997187511,-2306.5504084477629,-2153.5966586574073],"y":[416.7191890449779,458.93416326165465,790.42590971721677,669.20679358870859,607.14169351247756,469.75695432523207,779.86809627861192,475.83856857833598,545.23845903210758,305.74570358034657,416.52651611609201,522.67159764881512,402.22223340908079,459.09856876053902,559.04031952156106,558.707182907581,569.73170147319581,656.88150799089931,364.77894929845604,455.24276867262341,413.32056164012903,449.0806328257969,457.44397245715737,537.80752648156704,596.13153755288067,695.11483581239895,570.56739798049966,230.29938934282848,318.32148860700437,305.16104314466952,382.78472709784234,446.92722821068827,226.331741586059,764.69418508482238,874.04854173635681,645.33679057747838,534.93807984502314,477.80570999598228,379.37567915150623,277.06159548504246,506.48271754617423,388.71108259686434,299.01454556862359,443.90914426288805,601.170555318742,1216.241336888053,1266.8728396866682,1498.9330981645492,1389.9708189807977,1486.9819686346286,1372.9210975768406,1630.2316476927692,1591.4067836845334,1703.0213510048131,900.40638216936952,884.84054054106196,1023.0043757215162,1310.5500433700377,1380.7342491048116,1270.2319695520594,1165.1181718189455,1145.3662071461324,1039.0687639895543,578.12316224738913,757.20691277379342,787.92875098817001,1135.4418091592572,1087.9747629687033,1586.4508942224536,1124.3224630607331,1229.584561531123,900.15633668523446,455.03696049764466,573.11297406719996,685.6852880313229,873.74655568870196,1016.3102887125827,876.79997251896452,1099.5356987339403,1101.1066190902727,1148.4802986380953,489.26112841960696,606.71014139766555,607.33362881409903,619.14064416773726,543.02326848701296,782.60503943065692,801.35334799227144,853.27751719784339,732.63658483220524],"z":[183.34075576003013,182.6452285949097,664.81699005384064,496.71835903586805,699.79550113086805,400.83681849546167,741.21814724948615,332.91691874211398,545.60972800726256,200.21891459449583,201.93267268945377,249.64860547072362,270.87854283376038,456.01231468382628,521.29086199956589,151.28805975220939,554.36034964947737,632.653811110677,-450.25625111121741,-334.21465100676232,-310.08704955900998,170.94693922665948,401.8965896950989,401.13125161145535,524.40511174759683,757.87699994554896,762.45413710407934,-467.08160540962785,-373.48320177318647,-314.41464114158816,-268.44884133575232,-302.03062297704332,-79.512915838424519,665.85274252940746,716.51240764046395,750.6776319010304,-840.32777840581446,-742.15369633253181,-936.74160036206683,-298.28578877793609,-271.64060425249562,-331.14458741750127,-1801.5131602878644,-2101.3940403613988,-1648.8342101177204,85.52324936301585,156.30974184229783,399.58314810822941,148.27016396906492,272.35880048650569,287.44658578643532,281.79593671519194,295.60010794914456,331.65652179326412,221.0350207600454,105.61862919435329,362.15103549843218,493.37758768839245,503.6207405610977,614.03376961482581,604.42755186888576,416.44451686015555,226.82652205978465,-71.405534557097539,194.45798191252544,190.66521941816373,590.44353240296687,419.87902733510435,1074.6325798160201,587.61958726818386,608.56315210128878,318.01272476855655,-595.61031234269342,-178.57153776757599,-128.75933364105711,114.91220293555192,14.463009024693473,268.01087043083936,343.20960290043661,411.35484984579836,290.06092930199736,-725.01670352082692,-582.55450118849353,-559.01511554778176,-234.79410662048494,-248.53163280826109,-270.84049868809831,-1599.5497799277032,-1988.045612394717,-1862.9197842315455],"type":"scatter3d","mode":"markers","name":"OCI-Ly8","marker":{"color":"rgba(65,182,196,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(65,182,196,1)"}},"textfont":{"color":"rgba(65,182,196,1)","size":55},"error_y":{"color":"rgba(65,182,196,1)","width":55},"error_x":{"color":"rgba(65,182,196,1)","width":55},"line":{"color":"rgba(65,182,196,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># stimulus
fig &lt;- plot_ly(pca_data_all, x = ~PC1, y = ~PC2, z = ~PC3, color = ~stimulus, colors = colors_stim) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-5314ad47e0460929156f" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-5314ad47e0460929156f">{"x":{"visdat":{"a607086504":["function () ","plotlyVisDat"]},"cur_data":"a607086504","attrs":{"a607086504":{"x":{},"y":{},"z":{},"color":{},"colors":["#525252","#fdae6b"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-673.90949363469122,-557.08260305166141,-223.90100292554956,-281.34024880674264,172.96450279533511,232.11926359048053,-59.280109635970298,298.79566019763263,206.46806408778528,-204.07148340617118,-173.11657670760275,-122.61556007153493,-67.960766317522172,-65.974463522210087,-55.409082066732751,111.16792567829702,219.0095239548105,-106.65087587111805,124.00431231315571,135.86758419342854,167.5375443213953,223.64870528052174,524.12776288089447,236.23807134207004,192.07749685337572,319.89521727812769,482.09615482421111,-4.9359431838147563,-155.71066136205039,-75.358415568623329,-142.74557208123869,-220.97341180202329,-75.334404999847294,-331.4889123863361,-258.12307197762635,-14.885724683435994,-178.29631391235785,-95.460529735750939,-84.121699088777589,344.28911358434004,432.8180684505229,194.29366891798554,-832.89220573075852,-769.67628693410029,-489.23408225055357,-1499.8045140840065,-1565.8493297244552,-1746.5838554191123,-1783.7082840614391,-1489.545060620982,-1507.2019451139079,-1582.7569750198641,-1586.8287383842694,-1466.9628095203047,-1461.1158296579774,-1599.379626492424,-1629.2190047367767,-1595.1501730791435,-1500.1401879218226,-1415.3243870397832,-1649.9332733786571,-1534.4295212826794,-1494.7169814202214,-1748.8192230804216,-1728.7303898675268,-1661.5152456255646,-1584.5925293832936,-1458.05259323365,-1674.0715302640422,-1484.8350894699936,-1547.0341009743329,-1416.4480715372379,-1650.4085008243976,-1652.7307778944064,-1627.8930316963897,-1680.1013114934083,-1638.562870422975,-1447.8801156941242,-1624.6156578638315,-1611.4919618008771,-1555.9151417114233,-1994.9546824636782,-1928.6585693169675,-1993.2219917993286,-1696.4815776954683,-1777.7046671094483,-1751.3981790047865,-2306.3446701498174,-2288.5816682148443,-2315.0284528086859],"y":[-1300.0801923119143,-1266.3130137389262,-1341.604238550864,-1351.7540994152216,-1792.7476149114866,-1837.0429236997797,-1598.0932108666877,-1851.105819781096,-1837.1340139835277,-1576.7442332270195,-1438.9174289874722,-1546.2989124621963,-1603.3593830804332,-1660.7449184844299,-1679.9907123223652,-1672.498994874597,-1761.2861227582328,-1465.5597310446158,-1804.0807272558743,-2053.3729715105178,-1888.1939552109379,-1886.4616211841633,-1984.0407646058377,-2045.7598022230195,-1703.8803060716471,-1808.4667779807662,-1971.87575048651,-1960.1164443250109,-1796.9700818208419,-1751.0243422913059,-1753.3243103121615,-1524.3456949767956,-1846.9098595577757,-1422.6981442489141,-1329.6379432494659,-1481.4134880467379,-1701.9196351221321,-1796.9316964160168,-1734.9791438806772,-2281.2168066466538,-2325.9121141230676,-2092.9801467378925,-1605.8842606339144,-1620.5236157756626,-1872.8342642594951,416.7191890449779,458.93416326165465,790.42590971721677,669.20679358870859,607.14169351247756,469.75695432523207,779.86809627861192,475.83856857833598,545.23845903210758,305.74570358034657,416.52651611609201,522.67159764881512,402.22223340908079,459.09856876053902,559.04031952156106,558.707182907581,569.73170147319581,656.88150799089931,364.77894929845604,455.24276867262341,413.32056164012903,449.0806328257969,457.44397245715737,537.80752648156704,596.13153755288067,695.11483581239895,570.56739798049966,230.29938934282848,318.32148860700437,305.16104314466952,382.78472709784234,446.92722821068827,226.331741586059,764.69418508482238,874.04854173635681,645.33679057747838,534.93807984502314,477.80570999598228,379.37567915150623,277.06159548504246,506.48271754617423,388.71108259686434,299.01454556862359,443.90914426288805,601.170555318742],"z":[-721.94976862158899,-529.65328055895054,629.88595527179245,419.1535922829699,669.16468924436947,693.92020727310216,814.04565597634542,658.73939310230151,611.76572911636504,51.848863491704257,222.97940714834243,238.89190004239597,296.29616175807348,435.49622411509125,415.57246847339763,691.98499259419611,513.09333434385769,471.0794755833827,658.20961006975392,254.09265164748689,479.50574122910456,614.10125213388039,733.80369777721137,692.94064055949366,784.92759634818071,955.56370606440635,947.32034630293003,-228.28845973957166,-154.79006271097685,-207.12134323169977,43.172286293698228,-101.89545908018782,-43.567067888537352,-43.932634515343011,207.67137320913125,741.05018518797681,106.03111061820886,128.68441963200237,141.87567255472717,-153.08572905274059,16.68164464744072,70.010097277508436,-2060.7186144360016,-1882.7752249241628,-1885.8471614888667,183.34075576003013,182.6452285949097,664.81699005384064,496.71835903586805,699.79550113086805,400.83681849546167,741.21814724948615,332.91691874211398,545.60972800726256,200.21891459449583,201.93267268945377,249.64860547072362,270.87854283376038,456.01231468382628,521.29086199956589,151.28805975220939,554.36034964947737,632.653811110677,-450.25625111121741,-334.21465100676232,-310.08704955900998,170.94693922665948,401.8965896950989,401.13125161145535,524.40511174759683,757.87699994554896,762.45413710407934,-467.08160540962785,-373.48320177318647,-314.41464114158816,-268.44884133575232,-302.03062297704332,-79.512915838424519,665.85274252940746,716.51240764046395,750.6776319010304,-840.32777840581446,-742.15369633253181,-936.74160036206683,-298.28578877793609,-271.64060425249562,-331.14458741750127,-1801.5131602878644,-2101.3940403613988,-1648.8342101177204],"type":"scatter3d","mode":"markers","name":"PBS","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[4414.9924374935554,4100.8990130043821,3594.5571379429089,3706.046249196208,5498.3100404712859,5588.125934548083,4680.4927616607947,5452.0773107539626,5368.2011400680003,3181.170633843039,3388.182264750521,3460.3379347348168,3776.3028386628821,3769.2518453780772,3736.2029343658573,2851.0384408242999,2855.2002543044377,2859.1736328732236,2261.1744610103201,2308.7000202646186,2371.7279429837458,3130.2881458945208,4597.4295676875827,3668.4793996943326,2602.3113849868887,2272.9805650261887,2911.8427999528126,1714.9441019039475,1872.6062492047304,2268.5102080310317,3335.3496980149826,3120.0829924593859,3544.0938574594675,2438.6224997634336,2052.5509321819591,2417.2736245581823,2019.5812702058772,2004.4121395448383,1886.9176757816108,1252.1329925362522,1346.6086550016857,1279.5507675265221,60.146593107046826,65.010855897317143,122.36691805839871,-581.98396418201708,-640.92136152967896,-857.54959625467939,-808.25908616588879,-563.40855940524841,-513.52641389066969,-662.14947671035532,-516.22389550062064,-391.84013959419934,-1111.9771424546886,-1163.4047822044945,-1037.6019843044439,-716.82379654232739,-724.95764174632575,-879.36017935845166,-1030.6361658090207,-1048.1550789146545,-1225.8528911142796,-1495.2934230838823,-1569.8388933349092,-1497.357683159433,-994.39322351232829,-995.78730879183206,-928.06753933087998,-1169.2298249063263,-1134.221309663096,-1098.6615803941354,-1539.5777957381038,-1528.5158928658864,-1457.1444893454866,-1277.394503784149,-1414.0731601689299,-1064.6338565355659,-1308.8636100825138,-1324.2227977524401,-1343.8705437195731,-1802.9001967576983,-1695.9458511335527,-1829.3025764796041,-1792.7746914212778,-1561.9587054789911,-1773.3404866695396,-2016.255997187511,-2306.5504084477629,-2153.5966586574073],"y":[1299.953229680799,1345.7546003124057,1570.6522547186423,1633.9115438434674,1886.4245576498838,1938.54793162891,1990.605082753681,2126.9304711567947,1929.9479951153446,931.75184341564227,1079.2903635155508,1011.3720128786387,850.31323866534046,897.74586319572677,628.51446410457447,-8.498898330296111,-132.03353729581139,301.47828651411896,39.944226315998833,36.678249992775903,52.868540913268511,473.49914866142888,903.17125150775223,547.74120364377313,-187.76413705091949,-84.888986631923046,217.04736935353012,-701.52600992511555,-626.03195952803844,-748.24281219333034,277.89889132549848,384.55764905719616,121.46486888987725,-331.99849384695489,-35.09149574855649,-277.88126666280965,-816.87739889362831,-808.8440333688726,-791.92460277121961,-1878.9701449641561,-2258.158036371995,-1895.0620671821275,-1101.8364490353763,-1440.2995129463716,-1358.9699053177821,1216.241336888053,1266.8728396866682,1498.9330981645492,1389.9708189807977,1486.9819686346286,1372.9210975768406,1630.2316476927692,1591.4067836845334,1703.0213510048131,900.40638216936952,884.84054054106196,1023.0043757215162,1310.5500433700377,1380.7342491048116,1270.2319695520594,1165.1181718189455,1145.3662071461324,1039.0687639895543,578.12316224738913,757.20691277379342,787.92875098817001,1135.4418091592572,1087.9747629687033,1586.4508942224536,1124.3224630607331,1229.584561531123,900.15633668523446,455.03696049764466,573.11297406719996,685.6852880313229,873.74655568870196,1016.3102887125827,876.79997251896452,1099.5356987339403,1101.1066190902727,1148.4802986380953,489.26112841960696,606.71014139766555,607.33362881409903,619.14064416773726,543.02326848701296,782.60503943065692,801.35334799227144,853.27751719784339,732.63658483220524],"z":[-169.57456511417274,-172.90877236988061,-0.0062075790503665134,-294.85485393023424,143.91595597139536,59.054512725008493,-40.069492711451119,-154.0651826339319,-215.64457379328235,-460.57799458147701,-203.58723475288625,-137.34027494527902,29.933562077148061,-6.1152103298461702,-55.520274526589375,194.37720154253316,159.41371210012565,-200.16005739600217,-480.70568433043962,-290.69363440015724,-542.56823239929122,-416.77820178968852,-416.93032639805108,-455.04169146468712,51.733702880876571,-48.93058591575975,-261.59921211554121,-359.2304205241586,-147.25312371859127,-178.16583349818853,-326.88454370142381,-48.673283141869163,-283.8825831504044,213.33509495597067,55.551209827920331,13.866187794541519,-126.11708010706744,-103.22494406726599,-94.014095622252626,-51.970873839002032,44.531334299086751,47.491413368716799,-1371.9340226893025,-1716.3450062409634,-1530.8926800196828,85.52324936301585,156.30974184229783,399.58314810822941,148.27016396906492,272.35880048650569,287.44658578643532,281.79593671519194,295.60010794914456,331.65652179326412,221.0350207600454,105.61862919435329,362.15103549843218,493.37758768839245,503.6207405610977,614.03376961482581,604.42755186888576,416.44451686015555,226.82652205978465,-71.405534557097539,194.45798191252544,190.66521941816373,590.44353240296687,419.87902733510435,1074.6325798160201,587.61958726818386,608.56315210128878,318.01272476855655,-595.61031234269342,-178.57153776757599,-128.75933364105711,114.91220293555192,14.463009024693473,268.01087043083936,343.20960290043661,411.35484984579836,290.06092930199736,-725.01670352082692,-582.55450118849353,-559.01511554778176,-234.79410662048494,-248.53163280826109,-270.84049868809831,-1599.5497799277032,-1988.045612394717,-1862.9197842315455],"type":"scatter3d","mode":"markers","name":"aIg+H2O2","marker":{"color":"rgba(253,174,107,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(253,174,107,1)"}},"textfont":{"color":"rgba(253,174,107,1)","size":55},"error_y":{"color":"rgba(253,174,107,1)","width":55},"error_x":{"color":"rgba(253,174,107,1)","width":55},"line":{"color":"rgba(253,174,107,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># inhib_conc
fig &lt;- plot_ly(arrange(pca_data_all, inhibitor), x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_conc, colors = colors_blue9[c(2, 3, 5, 7, 9)]) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-262d82fdef13d33ea86f" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-262d82fdef13d33ea86f">{"x":{"visdat":{"a604a2665b2":["function () ","plotlyVisDat"]},"cur_data":"a604a2665b2","attrs":{"a604a2665b2":{"x":{},"y":{},"z":{},"color":{},"colors":["#deebf7","#c6dbef","#6baed6","#2171b5","#08306b"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-673.90949363469122,-557.08260305166141,-223.90100292554956,4414.9924374935554,4100.8990130043821,3594.5571379429089,-1499.8045140840065,-1565.8493297244552,-1746.5838554191123,-581.98396418201708,-640.92136152967896,-857.54959625467939,-281.34024880674264,172.96450279533511,232.11926359048053,3706.046249196208,5498.3100404712859,5588.125934548083,-1783.7082840614391,-1489.545060620982,-1507.2019451139079,-808.25908616588879,-563.40855940524841,-513.52641389066969,-59.280109635970298,298.79566019763263,206.46806408778528,4680.4927616607947,5452.0773107539626,5368.2011400680003,-1582.7569750198641,-1586.8287383842694,-1466.9628095203047,-662.14947671035532,-516.22389550062064,-391.84013959419934],"y":[-1300.0801923119143,-1266.3130137389262,-1341.604238550864,1299.953229680799,1345.7546003124057,1570.6522547186423,416.7191890449779,458.93416326165465,790.42590971721677,1216.241336888053,1266.8728396866682,1498.9330981645492,-1351.7540994152216,-1792.7476149114866,-1837.0429236997797,1633.9115438434674,1886.4245576498838,1938.54793162891,669.20679358870859,607.14169351247756,469.75695432523207,1389.9708189807977,1486.9819686346286,1372.9210975768406,-1598.0932108666877,-1851.105819781096,-1837.1340139835277,1990.605082753681,2126.9304711567947,1929.9479951153446,779.86809627861192,475.83856857833598,545.23845903210758,1630.2316476927692,1591.4067836845334,1703.0213510048131],"z":[-721.94976862158899,-529.65328055895054,629.88595527179245,-169.57456511417274,-172.90877236988061,-0.0062075790503665134,183.34075576003013,182.6452285949097,664.81699005384064,85.52324936301585,156.30974184229783,399.58314810822941,419.1535922829699,669.16468924436947,693.92020727310216,-294.85485393023424,143.91595597139536,59.054512725008493,496.71835903586805,699.79550113086805,400.83681849546167,148.27016396906492,272.35880048650569,287.44658578643532,814.04565597634542,658.73939310230151,611.76572911636504,-40.069492711451119,-154.0651826339319,-215.64457379328235,741.21814724948615,332.91691874211398,545.60972800726256,281.79593671519194,295.60010794914456,331.65652179326412],"type":"scatter3d","mode":"markers","name":"0 uM (DMSO)","marker":{"color":"rgba(170,204,231,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(170,204,231,1)"}},"textfont":{"color":"rgba(170,204,231,1)","size":55},"error_y":{"color":"rgba(170,204,231,1)","width":55},"error_x":{"color":"rgba(170,204,231,1)","width":55},"line":{"color":"rgba(170,204,231,1)","width":55},"frame":null},{"x":[-204.07148340617118,-173.11657670760275,-122.61556007153493,3181.170633843039,3388.182264750521,3460.3379347348168,-1461.1158296579774,-1599.379626492424,-1629.2190047367767,-1111.9771424546886,-1163.4047822044945,-1037.6019843044439,-67.960766317522172,-65.974463522210087,-55.409082066732751,3776.3028386628821,3769.2518453780772,3736.2029343658573,-1595.1501730791435,-1500.1401879218226,-1415.3243870397832,-716.82379654232739,-724.95764174632575,-879.36017935845166,111.16792567829702,219.0095239548105,-106.65087587111805,2851.0384408242999,2855.2002543044377,2859.1736328732236,-1649.9332733786571,-1534.4295212826794,-1494.7169814202214,-1030.6361658090207,-1048.1550789146545,-1225.8528911142796],"y":[-1576.7442332270195,-1438.9174289874722,-1546.2989124621963,931.75184341564227,1079.2903635155508,1011.3720128786387,305.74570358034657,416.52651611609201,522.67159764881512,900.40638216936952,884.84054054106196,1023.0043757215162,-1603.3593830804332,-1660.7449184844299,-1679.9907123223652,850.31323866534046,897.74586319572677,628.51446410457447,402.22223340908079,459.09856876053902,559.04031952156106,1310.5500433700377,1380.7342491048116,1270.2319695520594,-1672.498994874597,-1761.2861227582328,-1465.5597310446158,-8.498898330296111,-132.03353729581139,301.47828651411896,558.707182907581,569.73170147319581,656.88150799089931,1165.1181718189455,1145.3662071461324,1039.0687639895543],"z":[51.848863491704257,222.97940714834243,238.89190004239597,-460.57799458147701,-203.58723475288625,-137.34027494527902,200.21891459449583,201.93267268945377,249.64860547072362,221.0350207600454,105.61862919435329,362.15103549843218,296.29616175807348,435.49622411509125,415.57246847339763,29.933562077148061,-6.1152103298461702,-55.520274526589375,270.87854283376038,456.01231468382628,521.29086199956589,493.37758768839245,503.6207405610977,614.03376961482581,691.98499259419611,513.09333434385769,471.0794755833827,194.37720154253316,159.41371210012565,-200.16005739600217,151.28805975220939,554.36034964947737,632.653811110677,604.42755186888576,416.44451686015555,226.82652205978465],"type":"scatter3d","mode":"markers","name":"0.1 uM","marker":{"color":"rgba(107,174,214,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(107,174,214,1)"}},"textfont":{"color":"rgba(107,174,214,1)","size":55},"error_y":{"color":"rgba(107,174,214,1)","width":55},"error_x":{"color":"rgba(107,174,214,1)","width":55},"line":{"color":"rgba(107,174,214,1)","width":55},"frame":null},{"x":[124.00431231315571,135.86758419342854,167.5375443213953,2261.1744610103201,2308.7000202646186,2371.7279429837458,-1748.8192230804216,-1728.7303898675268,-1661.5152456255646,-1495.2934230838823,-1569.8388933349092,-1497.357683159433,223.64870528052174,524.12776288089447,236.23807134207004,3130.2881458945208,4597.4295676875827,3668.4793996943326,-1584.5925293832936,-1458.05259323365,-1674.0715302640422,-994.39322351232829,-995.78730879183206,-928.06753933087998,192.07749685337572,319.89521727812769,482.09615482421111,2602.3113849868887,2272.9805650261887,2911.8427999528126,-1484.8350894699936,-1547.0341009743329,-1416.4480715372379,-1169.2298249063263,-1134.221309663096,-1098.6615803941354],"y":[-1804.0807272558743,-2053.3729715105178,-1888.1939552109379,39.944226315998833,36.678249992775903,52.868540913268511,364.77894929845604,455.24276867262341,413.32056164012903,578.12316224738913,757.20691277379342,787.92875098817001,-1886.4616211841633,-1984.0407646058377,-2045.7598022230195,473.49914866142888,903.17125150775223,547.74120364377313,449.0806328257969,457.44397245715737,537.80752648156704,1135.4418091592572,1087.9747629687033,1586.4508942224536,-1703.8803060716471,-1808.4667779807662,-1971.87575048651,-187.76413705091949,-84.888986631923046,217.04736935353012,596.13153755288067,695.11483581239895,570.56739798049966,1124.3224630607331,1229.584561531123,900.15633668523446],"z":[658.20961006975392,254.09265164748689,479.50574122910456,-480.70568433043962,-290.69363440015724,-542.56823239929122,-450.25625111121741,-334.21465100676232,-310.08704955900998,-71.405534557097539,194.45798191252544,190.66521941816373,614.10125213388039,733.80369777721137,692.94064055949366,-416.77820178968852,-416.93032639805108,-455.04169146468712,170.94693922665948,401.8965896950989,401.13125161145535,590.44353240296687,419.87902733510435,1074.6325798160201,784.92759634818071,955.56370606440635,947.32034630293003,51.733702880876571,-48.93058591575975,-261.59921211554121,524.40511174759683,757.87699994554896,762.45413710407934,587.61958726818386,608.56315210128878,318.01272476855655],"type":"scatter3d","mode":"markers","name":"1 uM","marker":{"color":"rgba(64,133,192,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(64,133,192,1)"}},"textfont":{"color":"rgba(64,133,192,1)","size":55},"error_y":{"color":"rgba(64,133,192,1)","width":55},"error_x":{"color":"rgba(64,133,192,1)","width":55},"line":{"color":"rgba(64,133,192,1)","width":55},"frame":null},{"x":[-4.9359431838147563,-155.71066136205039,-75.358415568623329,1714.9441019039475,1872.6062492047304,2268.5102080310317,-1650.4085008243976,-1652.7307778944064,-1627.8930316963897,-1539.5777957381038,-1528.5158928658864,-1457.1444893454866,-142.74557208123869,-220.97341180202329,-75.334404999847294,3335.3496980149826,3120.0829924593859,3544.0938574594675,-1680.1013114934083,-1638.562870422975,-1447.8801156941242,-1277.394503784149,-1414.0731601689299,-1064.6338565355659,-331.4889123863361,-258.12307197762635,-14.885724683435994,2438.6224997634336,2052.5509321819591,2417.2736245581823,-1624.6156578638315,-1611.4919618008771,-1555.9151417114233,-1308.8636100825138,-1324.2227977524401,-1343.8705437195731],"y":[-1960.1164443250109,-1796.9700818208419,-1751.0243422913059,-701.52600992511555,-626.03195952803844,-748.24281219333034,230.29938934282848,318.32148860700437,305.16104314466952,455.03696049764466,573.11297406719996,685.6852880313229,-1753.3243103121615,-1524.3456949767956,-1846.9098595577757,277.89889132549848,384.55764905719616,121.46486888987725,382.78472709784234,446.92722821068827,226.331741586059,873.74655568870196,1016.3102887125827,876.79997251896452,-1422.6981442489141,-1329.6379432494659,-1481.4134880467379,-331.99849384695489,-35.09149574855649,-277.88126666280965,764.69418508482238,874.04854173635681,645.33679057747838,1099.5356987339403,1101.1066190902727,1148.4802986380953],"z":[-228.28845973957166,-154.79006271097685,-207.12134323169977,-359.2304205241586,-147.25312371859127,-178.16583349818853,-467.08160540962785,-373.48320177318647,-314.41464114158816,-595.61031234269342,-178.57153776757599,-128.75933364105711,43.172286293698228,-101.89545908018782,-43.567067888537352,-326.88454370142381,-48.673283141869163,-283.8825831504044,-268.44884133575232,-302.03062297704332,-79.512915838424519,114.91220293555192,14.463009024693473,268.01087043083936,-43.932634515343011,207.67137320913125,741.05018518797681,213.33509495597067,55.551209827920331,13.866187794541519,665.85274252940746,716.51240764046395,750.6776319010304,343.20960290043661,411.35484984579836,290.06092930199736],"type":"scatter3d","mode":"markers","name":"10 uM","marker":{"color":"rgba(26,90,156,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(26,90,156,1)"}},"textfont":{"color":"rgba(26,90,156,1)","size":55},"error_y":{"color":"rgba(26,90,156,1)","width":55},"error_x":{"color":"rgba(26,90,156,1)","width":55},"line":{"color":"rgba(26,90,156,1)","width":55},"frame":null},{"x":[-178.29631391235785,-95.460529735750939,-84.121699088777589,2019.5812702058772,2004.4121395448383,1886.9176757816108,-1994.9546824636782,-1928.6585693169675,-1993.2219917993286,-1802.9001967576983,-1695.9458511335527,-1829.3025764796041,344.28911358434004,432.8180684505229,194.29366891798554,1252.1329925362522,1346.6086550016857,1279.5507675265221,-1696.4815776954683,-1777.7046671094483,-1751.3981790047865,-1792.7746914212778,-1561.9587054789911,-1773.3404866695396,-832.89220573075852,-769.67628693410029,-489.23408225055357,60.146593107046826,65.010855897317143,122.36691805839871,-2306.3446701498174,-2288.5816682148443,-2315.0284528086859,-2016.255997187511,-2306.5504084477629,-2153.5966586574073],"y":[-1701.9196351221321,-1796.9316964160168,-1734.9791438806772,-816.87739889362831,-808.8440333688726,-791.92460277121961,534.93807984502314,477.80570999598228,379.37567915150623,489.26112841960696,606.71014139766555,607.33362881409903,-2281.2168066466538,-2325.9121141230676,-2092.9801467378925,-1878.9701449641561,-2258.158036371995,-1895.0620671821275,277.06159548504246,506.48271754617423,388.71108259686434,619.14064416773726,543.02326848701296,782.60503943065692,-1605.8842606339144,-1620.5236157756626,-1872.8342642594951,-1101.8364490353763,-1440.2995129463716,-1358.9699053177821,299.01454556862359,443.90914426288805,601.170555318742,801.35334799227144,853.27751719784339,732.63658483220524],"z":[106.03111061820886,128.68441963200237,141.87567255472717,-126.11708010706744,-103.22494406726599,-94.014095622252626,-840.32777840581446,-742.15369633253181,-936.74160036206683,-725.01670352082692,-582.55450118849353,-559.01511554778176,-153.08572905274059,16.68164464744072,70.010097277508436,-51.970873839002032,44.531334299086751,47.491413368716799,-298.28578877793609,-271.64060425249562,-331.14458741750127,-234.79410662048494,-248.53163280826109,-270.84049868809831,-2060.7186144360016,-1882.7752249241628,-1885.8471614888667,-1371.9340226893025,-1716.3450062409634,-1530.8926800196828,-1801.5131602878644,-2101.3940403613988,-1648.8342101177204,-1599.5497799277032,-1988.045612394717,-1862.9197842315455],"type":"scatter3d","mode":"markers","name":"100 uM","marker":{"color":"rgba(8,48,107,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(8,48,107,1)"}},"textfont":{"color":"rgba(8,48,107,1)","size":55},"error_y":{"color":"rgba(8,48,107,1)","width":55},"error_x":{"color":"rgba(8,48,107,1)","width":55},"line":{"color":"rgba(8,48,107,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># inhibitor
fig &lt;- plot_ly(pca_data_all, x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhibitor, colors = colors_inhib) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-b13c7bd4559deb50fe21" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-b13c7bd4559deb50fe21">{"x":{"visdat":{"a6019a673b5":["function () ","plotlyVisDat"]},"cur_data":"a6019a673b5","attrs":{"a6019a673b5":{"x":{},"y":{},"z":{},"color":{},"colors":["#41ab5d","#807dba","#4292c6","#f16913"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-673.90949363469122,-557.08260305166141,-223.90100292554956,-204.07148340617118,-173.11657670760275,-122.61556007153493,124.00431231315571,135.86758419342854,167.5375443213953,-4.9359431838147563,-155.71066136205039,-75.358415568623329,-178.29631391235785,-95.460529735750939,-84.121699088777589,4414.9924374935554,4100.8990130043821,3594.5571379429089,3181.170633843039,3388.182264750521,3460.3379347348168,2261.1744610103201,2308.7000202646186,2371.7279429837458,1714.9441019039475,1872.6062492047304,2268.5102080310317,2019.5812702058772,2004.4121395448383,1886.9176757816108,-1499.8045140840065,-1565.8493297244552,-1746.5838554191123,-1461.1158296579774,-1599.379626492424,-1629.2190047367767,-1748.8192230804216,-1728.7303898675268,-1661.5152456255646,-1650.4085008243976,-1652.7307778944064,-1627.8930316963897,-1994.9546824636782,-1928.6585693169675,-1993.2219917993286,-581.98396418201708,-640.92136152967896,-857.54959625467939,-1111.9771424546886,-1163.4047822044945,-1037.6019843044439,-1495.2934230838823,-1569.8388933349092,-1497.357683159433,-1539.5777957381038,-1528.5158928658864,-1457.1444893454866,-1802.9001967576983,-1695.9458511335527,-1829.3025764796041],"y":[-1300.0801923119143,-1266.3130137389262,-1341.604238550864,-1576.7442332270195,-1438.9174289874722,-1546.2989124621963,-1804.0807272558743,-2053.3729715105178,-1888.1939552109379,-1960.1164443250109,-1796.9700818208419,-1751.0243422913059,-1701.9196351221321,-1796.9316964160168,-1734.9791438806772,1299.953229680799,1345.7546003124057,1570.6522547186423,931.75184341564227,1079.2903635155508,1011.3720128786387,39.944226315998833,36.678249992775903,52.868540913268511,-701.52600992511555,-626.03195952803844,-748.24281219333034,-816.87739889362831,-808.8440333688726,-791.92460277121961,416.7191890449779,458.93416326165465,790.42590971721677,305.74570358034657,416.52651611609201,522.67159764881512,364.77894929845604,455.24276867262341,413.32056164012903,230.29938934282848,318.32148860700437,305.16104314466952,534.93807984502314,477.80570999598228,379.37567915150623,1216.241336888053,1266.8728396866682,1498.9330981645492,900.40638216936952,884.84054054106196,1023.0043757215162,578.12316224738913,757.20691277379342,787.92875098817001,455.03696049764466,573.11297406719996,685.6852880313229,489.26112841960696,606.71014139766555,607.33362881409903],"z":[-721.94976862158899,-529.65328055895054,629.88595527179245,51.848863491704257,222.97940714834243,238.89190004239597,658.20961006975392,254.09265164748689,479.50574122910456,-228.28845973957166,-154.79006271097685,-207.12134323169977,106.03111061820886,128.68441963200237,141.87567255472717,-169.57456511417274,-172.90877236988061,-0.0062075790503665134,-460.57799458147701,-203.58723475288625,-137.34027494527902,-480.70568433043962,-290.69363440015724,-542.56823239929122,-359.2304205241586,-147.25312371859127,-178.16583349818853,-126.11708010706744,-103.22494406726599,-94.014095622252626,183.34075576003013,182.6452285949097,664.81699005384064,200.21891459449583,201.93267268945377,249.64860547072362,-450.25625111121741,-334.21465100676232,-310.08704955900998,-467.08160540962785,-373.48320177318647,-314.41464114158816,-840.32777840581446,-742.15369633253181,-936.74160036206683,85.52324936301585,156.30974184229783,399.58314810822941,221.0350207600454,105.61862919435329,362.15103549843218,-71.405534557097539,194.45798191252544,190.66521941816373,-595.61031234269342,-178.57153776757599,-128.75933364105711,-725.01670352082692,-582.55450118849353,-559.01511554778176],"type":"scatter3d","mode":"markers","name":"iSYK","marker":{"color":"rgba(65,171,93,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(65,171,93,1)"}},"textfont":{"color":"rgba(65,171,93,1)","size":55},"error_y":{"color":"rgba(65,171,93,1)","width":55},"error_x":{"color":"rgba(65,171,93,1)","width":55},"line":{"color":"rgba(65,171,93,1)","width":55},"frame":null},{"x":[-281.34024880674264,172.96450279533511,232.11926359048053,-67.960766317522172,-65.974463522210087,-55.409082066732751,223.64870528052174,524.12776288089447,236.23807134207004,-142.74557208123869,-220.97341180202329,-75.334404999847294,344.28911358434004,432.8180684505229,194.29366891798554,3706.046249196208,5498.3100404712859,5588.125934548083,3776.3028386628821,3769.2518453780772,3736.2029343658573,3130.2881458945208,4597.4295676875827,3668.4793996943326,3335.3496980149826,3120.0829924593859,3544.0938574594675,1252.1329925362522,1346.6086550016857,1279.5507675265221,-1783.7082840614391,-1489.545060620982,-1507.2019451139079,-1595.1501730791435,-1500.1401879218226,-1415.3243870397832,-1584.5925293832936,-1458.05259323365,-1674.0715302640422,-1680.1013114934083,-1638.562870422975,-1447.8801156941242,-1696.4815776954683,-1777.7046671094483,-1751.3981790047865,-808.25908616588879,-563.40855940524841,-513.52641389066969,-716.82379654232739,-724.95764174632575,-879.36017935845166,-994.39322351232829,-995.78730879183206,-928.06753933087998,-1277.394503784149,-1414.0731601689299,-1064.6338565355659,-1792.7746914212778,-1561.9587054789911,-1773.3404866695396],"y":[-1351.7540994152216,-1792.7476149114866,-1837.0429236997797,-1603.3593830804332,-1660.7449184844299,-1679.9907123223652,-1886.4616211841633,-1984.0407646058377,-2045.7598022230195,-1753.3243103121615,-1524.3456949767956,-1846.9098595577757,-2281.2168066466538,-2325.9121141230676,-2092.9801467378925,1633.9115438434674,1886.4245576498838,1938.54793162891,850.31323866534046,897.74586319572677,628.51446410457447,473.49914866142888,903.17125150775223,547.74120364377313,277.89889132549848,384.55764905719616,121.46486888987725,-1878.9701449641561,-2258.158036371995,-1895.0620671821275,669.20679358870859,607.14169351247756,469.75695432523207,402.22223340908079,459.09856876053902,559.04031952156106,449.0806328257969,457.44397245715737,537.80752648156704,382.78472709784234,446.92722821068827,226.331741586059,277.06159548504246,506.48271754617423,388.71108259686434,1389.9708189807977,1486.9819686346286,1372.9210975768406,1310.5500433700377,1380.7342491048116,1270.2319695520594,1135.4418091592572,1087.9747629687033,1586.4508942224536,873.74655568870196,1016.3102887125827,876.79997251896452,619.14064416773726,543.02326848701296,782.60503943065692],"z":[419.1535922829699,669.16468924436947,693.92020727310216,296.29616175807348,435.49622411509125,415.57246847339763,614.10125213388039,733.80369777721137,692.94064055949366,43.172286293698228,-101.89545908018782,-43.567067888537352,-153.08572905274059,16.68164464744072,70.010097277508436,-294.85485393023424,143.91595597139536,59.054512725008493,29.933562077148061,-6.1152103298461702,-55.520274526589375,-416.77820178968852,-416.93032639805108,-455.04169146468712,-326.88454370142381,-48.673283141869163,-283.8825831504044,-51.970873839002032,44.531334299086751,47.491413368716799,496.71835903586805,699.79550113086805,400.83681849546167,270.87854283376038,456.01231468382628,521.29086199956589,170.94693922665948,401.8965896950989,401.13125161145535,-268.44884133575232,-302.03062297704332,-79.512915838424519,-298.28578877793609,-271.64060425249562,-331.14458741750127,148.27016396906492,272.35880048650569,287.44658578643532,493.37758768839245,503.6207405610977,614.03376961482581,590.44353240296687,419.87902733510435,1074.6325798160201,114.91220293555192,14.463009024693473,268.01087043083936,-234.79410662048494,-248.53163280826109,-270.84049868809831],"type":"scatter3d","mode":"markers","name":"iBTK","marker":{"color":"rgba(128,125,186,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(128,125,186,1)"}},"textfont":{"color":"rgba(128,125,186,1)","size":55},"error_y":{"color":"rgba(128,125,186,1)","width":55},"error_x":{"color":"rgba(128,125,186,1)","width":55},"line":{"color":"rgba(128,125,186,1)","width":55},"frame":null},{"x":[-59.280109635970298,298.79566019763263,206.46806408778528,111.16792567829702,219.0095239548105,-106.65087587111805,192.07749685337572,319.89521727812769,482.09615482421111,-331.4889123863361,-258.12307197762635,-14.885724683435994,-832.89220573075852,-769.67628693410029,-489.23408225055357,4680.4927616607947,5452.0773107539626,5368.2011400680003,2851.0384408242999,2855.2002543044377,2859.1736328732236,2602.3113849868887,2272.9805650261887,2911.8427999528126,2438.6224997634336,2052.5509321819591,2417.2736245581823,60.146593107046826,65.010855897317143,122.36691805839871,-1582.7569750198641,-1586.8287383842694,-1466.9628095203047,-1649.9332733786571,-1534.4295212826794,-1494.7169814202214,-1484.8350894699936,-1547.0341009743329,-1416.4480715372379,-1624.6156578638315,-1611.4919618008771,-1555.9151417114233,-2306.3446701498174,-2288.5816682148443,-2315.0284528086859,-662.14947671035532,-516.22389550062064,-391.84013959419934,-1030.6361658090207,-1048.1550789146545,-1225.8528911142796,-1169.2298249063263,-1134.221309663096,-1098.6615803941354,-1308.8636100825138,-1324.2227977524401,-1343.8705437195731,-2016.255997187511,-2306.5504084477629,-2153.5966586574073],"y":[-1598.0932108666877,-1851.105819781096,-1837.1340139835277,-1672.498994874597,-1761.2861227582328,-1465.5597310446158,-1703.8803060716471,-1808.4667779807662,-1971.87575048651,-1422.6981442489141,-1329.6379432494659,-1481.4134880467379,-1605.8842606339144,-1620.5236157756626,-1872.8342642594951,1990.605082753681,2126.9304711567947,1929.9479951153446,-8.498898330296111,-132.03353729581139,301.47828651411896,-187.76413705091949,-84.888986631923046,217.04736935353012,-331.99849384695489,-35.09149574855649,-277.88126666280965,-1101.8364490353763,-1440.2995129463716,-1358.9699053177821,779.86809627861192,475.83856857833598,545.23845903210758,558.707182907581,569.73170147319581,656.88150799089931,596.13153755288067,695.11483581239895,570.56739798049966,764.69418508482238,874.04854173635681,645.33679057747838,299.01454556862359,443.90914426288805,601.170555318742,1630.2316476927692,1591.4067836845334,1703.0213510048131,1165.1181718189455,1145.3662071461324,1039.0687639895543,1124.3224630607331,1229.584561531123,900.15633668523446,1099.5356987339403,1101.1066190902727,1148.4802986380953,801.35334799227144,853.27751719784339,732.63658483220524],"z":[814.04565597634542,658.73939310230151,611.76572911636504,691.98499259419611,513.09333434385769,471.0794755833827,784.92759634818071,955.56370606440635,947.32034630293003,-43.932634515343011,207.67137320913125,741.05018518797681,-2060.7186144360016,-1882.7752249241628,-1885.8471614888667,-40.069492711451119,-154.0651826339319,-215.64457379328235,194.37720154253316,159.41371210012565,-200.16005739600217,51.733702880876571,-48.93058591575975,-261.59921211554121,213.33509495597067,55.551209827920331,13.866187794541519,-1371.9340226893025,-1716.3450062409634,-1530.8926800196828,741.21814724948615,332.91691874211398,545.60972800726256,151.28805975220939,554.36034964947737,632.653811110677,524.40511174759683,757.87699994554896,762.45413710407934,665.85274252940746,716.51240764046395,750.6776319010304,-1801.5131602878644,-2101.3940403613988,-1648.8342101177204,281.79593671519194,295.60010794914456,331.65652179326412,604.42755186888576,416.44451686015555,226.82652205978465,587.61958726818386,608.56315210128878,318.01272476855655,343.20960290043661,411.35484984579836,290.06092930199736,-1599.5497799277032,-1988.045612394717,-1862.9197842315455],"type":"scatter3d","mode":"markers","name":"iNFkB","marker":{"color":"rgba(241,105,19,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(241,105,19,1)"}},"textfont":{"color":"rgba(241,105,19,1)","size":55},"error_y":{"color":"rgba(241,105,19,1)","width":55},"error_x":{"color":"rgba(241,105,19,1)","width":55},"line":{"color":"rgba(241,105,19,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># inhib_conc_text
fig &lt;- plot_ly(arrange(pca_data_all, inhibitor), x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_conc_text, colors = colors_inhib_conc) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-499ee8f9be0f0c4782d5" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-499ee8f9be0f0c4782d5">{"x":{"visdat":{"a6026b32165":["function () ","plotlyVisDat"]},"cur_data":"a6026b32165","attrs":{"a6026b32165":{"x":{},"y":{},"z":{},"color":{},"colors":["#e5f5e0","#c7e9c0","#74c476","#238b45","#00441b","#efedf5","#dadaeb","#9e9ac8","#6a51a3","#3f007d","#fee6ce","#fdd0a2","#fd8d3c","#d94801","#7f2704"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-281.34024880674264,172.96450279533511,232.11926359048053,3706.046249196208,5498.3100404712859,5588.125934548083,-1783.7082840614391,-1489.545060620982,-1507.2019451139079,-808.25908616588879,-563.40855940524841,-513.52641389066969],"y":[-1351.7540994152216,-1792.7476149114866,-1837.0429236997797,1633.9115438434674,1886.4245576498838,1938.54793162891,669.20679358870859,607.14169351247756,469.75695432523207,1389.9708189807977,1486.9819686346286,1372.9210975768406],"z":[419.1535922829699,669.16468924436947,693.92020727310216,-294.85485393023424,143.91595597139536,59.054512725008493,496.71835903586805,699.79550113086805,400.83681849546167,148.27016396906492,272.35880048650569,287.44658578643532],"type":"scatter3d","mode":"markers","name":"0 uM iBTK (DMSO)","marker":{"color":"rgba(239,237,245,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(239,237,245,1)"}},"textfont":{"color":"rgba(239,237,245,1)","size":55},"error_y":{"color":"rgba(239,237,245,1)","width":55},"error_x":{"color":"rgba(239,237,245,1)","width":55},"line":{"color":"rgba(239,237,245,1)","width":55},"frame":null},{"x":[-59.280109635970298,298.79566019763263,206.46806408778528,4680.4927616607947,5452.0773107539626,5368.2011400680003,-1582.7569750198641,-1586.8287383842694,-1466.9628095203047,-662.14947671035532,-516.22389550062064,-391.84013959419934],"y":[-1598.0932108666877,-1851.105819781096,-1837.1340139835277,1990.605082753681,2126.9304711567947,1929.9479951153446,779.86809627861192,475.83856857833598,545.23845903210758,1630.2316476927692,1591.4067836845334,1703.0213510048131],"z":[814.04565597634542,658.73939310230151,611.76572911636504,-40.069492711451119,-154.0651826339319,-215.64457379328235,741.21814724948615,332.91691874211398,545.60972800726256,281.79593671519194,295.60010794914456,331.65652179326412],"type":"scatter3d","mode":"markers","name":"0 uM iNFkB (DMSO)","marker":{"color":"rgba(254,230,206,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(254,230,206,1)"}},"textfont":{"color":"rgba(254,230,206,1)","size":55},"error_y":{"color":"rgba(254,230,206,1)","width":55},"error_x":{"color":"rgba(254,230,206,1)","width":55},"line":{"color":"rgba(254,230,206,1)","width":55},"frame":null},{"x":[-673.90949363469122,-557.08260305166141,-223.90100292554956,4414.9924374935554,4100.8990130043821,3594.5571379429089,-1499.8045140840065,-1565.8493297244552,-1746.5838554191123,-581.98396418201708,-640.92136152967896,-857.54959625467939],"y":[-1300.0801923119143,-1266.3130137389262,-1341.604238550864,1299.953229680799,1345.7546003124057,1570.6522547186423,416.7191890449779,458.93416326165465,790.42590971721677,1216.241336888053,1266.8728396866682,1498.9330981645492],"z":[-721.94976862158899,-529.65328055895054,629.88595527179245,-169.57456511417274,-172.90877236988061,-0.0062075790503665134,183.34075576003013,182.6452285949097,664.81699005384064,85.52324936301585,156.30974184229783,399.58314810822941],"type":"scatter3d","mode":"markers","name":"0 uM iSYK (DMSO)","marker":{"color":"rgba(229,245,224,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(229,245,224,1)"}},"textfont":{"color":"rgba(229,245,224,1)","size":55},"error_y":{"color":"rgba(229,245,224,1)","width":55},"error_x":{"color":"rgba(229,245,224,1)","width":55},"line":{"color":"rgba(229,245,224,1)","width":55},"frame":null},{"x":[-67.960766317522172,-65.974463522210087,-55.409082066732751,3776.3028386628821,3769.2518453780772,3736.2029343658573,-1595.1501730791435,-1500.1401879218226,-1415.3243870397832,-716.82379654232739,-724.95764174632575,-879.36017935845166],"y":[-1603.3593830804332,-1660.7449184844299,-1679.9907123223652,850.31323866534046,897.74586319572677,628.51446410457447,402.22223340908079,459.09856876053902,559.04031952156106,1310.5500433700377,1380.7342491048116,1270.2319695520594],"z":[296.29616175807348,435.49622411509125,415.57246847339763,29.933562077148061,-6.1152103298461702,-55.520274526589375,270.87854283376038,456.01231468382628,521.29086199956589,493.37758768839245,503.6207405610977,614.03376961482581],"type":"scatter3d","mode":"markers","name":"0.1 uM iBTK","marker":{"color":"rgba(218,218,235,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(218,218,235,1)"}},"textfont":{"color":"rgba(218,218,235,1)","size":55},"error_y":{"color":"rgba(218,218,235,1)","width":55},"error_x":{"color":"rgba(218,218,235,1)","width":55},"line":{"color":"rgba(218,218,235,1)","width":55},"frame":null},{"x":[111.16792567829702,219.0095239548105,-106.65087587111805,2851.0384408242999,2855.2002543044377,2859.1736328732236,-1649.9332733786571,-1534.4295212826794,-1494.7169814202214,-1030.6361658090207,-1048.1550789146545,-1225.8528911142796],"y":[-1672.498994874597,-1761.2861227582328,-1465.5597310446158,-8.498898330296111,-132.03353729581139,301.47828651411896,558.707182907581,569.73170147319581,656.88150799089931,1165.1181718189455,1145.3662071461324,1039.0687639895543],"z":[691.98499259419611,513.09333434385769,471.0794755833827,194.37720154253316,159.41371210012565,-200.16005739600217,151.28805975220939,554.36034964947737,632.653811110677,604.42755186888576,416.44451686015555,226.82652205978465],"type":"scatter3d","mode":"markers","name":"0.1 uM iNFkB","marker":{"color":"rgba(253,208,162,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(253,208,162,1)"}},"textfont":{"color":"rgba(253,208,162,1)","size":55},"error_y":{"color":"rgba(253,208,162,1)","width":55},"error_x":{"color":"rgba(253,208,162,1)","width":55},"line":{"color":"rgba(253,208,162,1)","width":55},"frame":null},{"x":[-204.07148340617118,-173.11657670760275,-122.61556007153493,3181.170633843039,3388.182264750521,3460.3379347348168,-1461.1158296579774,-1599.379626492424,-1629.2190047367767,-1111.9771424546886,-1163.4047822044945,-1037.6019843044439],"y":[-1576.7442332270195,-1438.9174289874722,-1546.2989124621963,931.75184341564227,1079.2903635155508,1011.3720128786387,305.74570358034657,416.52651611609201,522.67159764881512,900.40638216936952,884.84054054106196,1023.0043757215162],"z":[51.848863491704257,222.97940714834243,238.89190004239597,-460.57799458147701,-203.58723475288625,-137.34027494527902,200.21891459449583,201.93267268945377,249.64860547072362,221.0350207600454,105.61862919435329,362.15103549843218],"type":"scatter3d","mode":"markers","name":"0.1 uM iSYK","marker":{"color":"rgba(199,233,192,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(199,233,192,1)"}},"textfont":{"color":"rgba(199,233,192,1)","size":55},"error_y":{"color":"rgba(199,233,192,1)","width":55},"error_x":{"color":"rgba(199,233,192,1)","width":55},"line":{"color":"rgba(199,233,192,1)","width":55},"frame":null},{"x":[223.64870528052174,524.12776288089447,236.23807134207004,3130.2881458945208,4597.4295676875827,3668.4793996943326,-1584.5925293832936,-1458.05259323365,-1674.0715302640422,-994.39322351232829,-995.78730879183206,-928.06753933087998],"y":[-1886.4616211841633,-1984.0407646058377,-2045.7598022230195,473.49914866142888,903.17125150775223,547.74120364377313,449.0806328257969,457.44397245715737,537.80752648156704,1135.4418091592572,1087.9747629687033,1586.4508942224536],"z":[614.10125213388039,733.80369777721137,692.94064055949366,-416.77820178968852,-416.93032639805108,-455.04169146468712,170.94693922665948,401.8965896950989,401.13125161145535,590.44353240296687,419.87902733510435,1074.6325798160201],"type":"scatter3d","mode":"markers","name":"1 uM iBTK","marker":{"color":"rgba(158,154,200,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(158,154,200,1)"}},"textfont":{"color":"rgba(158,154,200,1)","size":55},"error_y":{"color":"rgba(158,154,200,1)","width":55},"error_x":{"color":"rgba(158,154,200,1)","width":55},"line":{"color":"rgba(158,154,200,1)","width":55},"frame":null},{"x":[192.07749685337572,319.89521727812769,482.09615482421111,2602.3113849868887,2272.9805650261887,2911.8427999528126,-1484.8350894699936,-1547.0341009743329,-1416.4480715372379,-1169.2298249063263,-1134.221309663096,-1098.6615803941354],"y":[-1703.8803060716471,-1808.4667779807662,-1971.87575048651,-187.76413705091949,-84.888986631923046,217.04736935353012,596.13153755288067,695.11483581239895,570.56739798049966,1124.3224630607331,1229.584561531123,900.15633668523446],"z":[784.92759634818071,955.56370606440635,947.32034630293003,51.733702880876571,-48.93058591575975,-261.59921211554121,524.40511174759683,757.87699994554896,762.45413710407934,587.61958726818386,608.56315210128878,318.01272476855655],"type":"scatter3d","mode":"markers","name":"1 uM iNFkB","marker":{"color":"rgba(253,141,60,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(253,141,60,1)"}},"textfont":{"color":"rgba(253,141,60,1)","size":55},"error_y":{"color":"rgba(253,141,60,1)","width":55},"error_x":{"color":"rgba(253,141,60,1)","width":55},"line":{"color":"rgba(253,141,60,1)","width":55},"frame":null},{"x":[124.00431231315571,135.86758419342854,167.5375443213953,2261.1744610103201,2308.7000202646186,2371.7279429837458,-1748.8192230804216,-1728.7303898675268,-1661.5152456255646,-1495.2934230838823,-1569.8388933349092,-1497.357683159433],"y":[-1804.0807272558743,-2053.3729715105178,-1888.1939552109379,39.944226315998833,36.678249992775903,52.868540913268511,364.77894929845604,455.24276867262341,413.32056164012903,578.12316224738913,757.20691277379342,787.92875098817001],"z":[658.20961006975392,254.09265164748689,479.50574122910456,-480.70568433043962,-290.69363440015724,-542.56823239929122,-450.25625111121741,-334.21465100676232,-310.08704955900998,-71.405534557097539,194.45798191252544,190.66521941816373],"type":"scatter3d","mode":"markers","name":"1 uM iSYK","marker":{"color":"rgba(116,196,118,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(116,196,118,1)"}},"textfont":{"color":"rgba(116,196,118,1)","size":55},"error_y":{"color":"rgba(116,196,118,1)","width":55},"error_x":{"color":"rgba(116,196,118,1)","width":55},"line":{"color":"rgba(116,196,118,1)","width":55},"frame":null},{"x":[-142.74557208123869,-220.97341180202329,-75.334404999847294,3335.3496980149826,3120.0829924593859,3544.0938574594675,-1680.1013114934083,-1638.562870422975,-1447.8801156941242,-1277.394503784149,-1414.0731601689299,-1064.6338565355659],"y":[-1753.3243103121615,-1524.3456949767956,-1846.9098595577757,277.89889132549848,384.55764905719616,121.46486888987725,382.78472709784234,446.92722821068827,226.331741586059,873.74655568870196,1016.3102887125827,876.79997251896452],"z":[43.172286293698228,-101.89545908018782,-43.567067888537352,-326.88454370142381,-48.673283141869163,-283.8825831504044,-268.44884133575232,-302.03062297704332,-79.512915838424519,114.91220293555192,14.463009024693473,268.01087043083936],"type":"scatter3d","mode":"markers","name":"10 uM iBTK","marker":{"color":"rgba(106,81,163,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(106,81,163,1)"}},"textfont":{"color":"rgba(106,81,163,1)","size":55},"error_y":{"color":"rgba(106,81,163,1)","width":55},"error_x":{"color":"rgba(106,81,163,1)","width":55},"line":{"color":"rgba(106,81,163,1)","width":55},"frame":null},{"x":[-331.4889123863361,-258.12307197762635,-14.885724683435994,2438.6224997634336,2052.5509321819591,2417.2736245581823,-1624.6156578638315,-1611.4919618008771,-1555.9151417114233,-1308.8636100825138,-1324.2227977524401,-1343.8705437195731],"y":[-1422.6981442489141,-1329.6379432494659,-1481.4134880467379,-331.99849384695489,-35.09149574855649,-277.88126666280965,764.69418508482238,874.04854173635681,645.33679057747838,1099.5356987339403,1101.1066190902727,1148.4802986380953],"z":[-43.932634515343011,207.67137320913125,741.05018518797681,213.33509495597067,55.551209827920331,13.866187794541519,665.85274252940746,716.51240764046395,750.6776319010304,343.20960290043661,411.35484984579836,290.06092930199736],"type":"scatter3d","mode":"markers","name":"10 uM iNFkB","marker":{"color":"rgba(217,72,1,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(217,72,1,1)"}},"textfont":{"color":"rgba(217,72,1,1)","size":55},"error_y":{"color":"rgba(217,72,1,1)","width":55},"error_x":{"color":"rgba(217,72,1,1)","width":55},"line":{"color":"rgba(217,72,1,1)","width":55},"frame":null},{"x":[-4.9359431838147563,-155.71066136205039,-75.358415568623329,1714.9441019039475,1872.6062492047304,2268.5102080310317,-1650.4085008243976,-1652.7307778944064,-1627.8930316963897,-1539.5777957381038,-1528.5158928658864,-1457.1444893454866],"y":[-1960.1164443250109,-1796.9700818208419,-1751.0243422913059,-701.52600992511555,-626.03195952803844,-748.24281219333034,230.29938934282848,318.32148860700437,305.16104314466952,455.03696049764466,573.11297406719996,685.6852880313229],"z":[-228.28845973957166,-154.79006271097685,-207.12134323169977,-359.2304205241586,-147.25312371859127,-178.16583349818853,-467.08160540962785,-373.48320177318647,-314.41464114158816,-595.61031234269342,-178.57153776757599,-128.75933364105711],"type":"scatter3d","mode":"markers","name":"10 uM iSYK","marker":{"color":"rgba(35,139,69,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(35,139,69,1)"}},"textfont":{"color":"rgba(35,139,69,1)","size":55},"error_y":{"color":"rgba(35,139,69,1)","width":55},"error_x":{"color":"rgba(35,139,69,1)","width":55},"line":{"color":"rgba(35,139,69,1)","width":55},"frame":null},{"x":[344.28911358434004,432.8180684505229,194.29366891798554,1252.1329925362522,1346.6086550016857,1279.5507675265221,-1696.4815776954683,-1777.7046671094483,-1751.3981790047865,-1792.7746914212778,-1561.9587054789911,-1773.3404866695396],"y":[-2281.2168066466538,-2325.9121141230676,-2092.9801467378925,-1878.9701449641561,-2258.158036371995,-1895.0620671821275,277.06159548504246,506.48271754617423,388.71108259686434,619.14064416773726,543.02326848701296,782.60503943065692],"z":[-153.08572905274059,16.68164464744072,70.010097277508436,-51.970873839002032,44.531334299086751,47.491413368716799,-298.28578877793609,-271.64060425249562,-331.14458741750127,-234.79410662048494,-248.53163280826109,-270.84049868809831],"type":"scatter3d","mode":"markers","name":"100 uM iBTK","marker":{"color":"rgba(63,0,125,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(63,0,125,1)"}},"textfont":{"color":"rgba(63,0,125,1)","size":55},"error_y":{"color":"rgba(63,0,125,1)","width":55},"error_x":{"color":"rgba(63,0,125,1)","width":55},"line":{"color":"rgba(63,0,125,1)","width":55},"frame":null},{"x":[-832.89220573075852,-769.67628693410029,-489.23408225055357,60.146593107046826,65.010855897317143,122.36691805839871,-2306.3446701498174,-2288.5816682148443,-2315.0284528086859,-2016.255997187511,-2306.5504084477629,-2153.5966586574073],"y":[-1605.8842606339144,-1620.5236157756626,-1872.8342642594951,-1101.8364490353763,-1440.2995129463716,-1358.9699053177821,299.01454556862359,443.90914426288805,601.170555318742,801.35334799227144,853.27751719784339,732.63658483220524],"z":[-2060.7186144360016,-1882.7752249241628,-1885.8471614888667,-1371.9340226893025,-1716.3450062409634,-1530.8926800196828,-1801.5131602878644,-2101.3940403613988,-1648.8342101177204,-1599.5497799277032,-1988.045612394717,-1862.9197842315455],"type":"scatter3d","mode":"markers","name":"100 uM iNFkB","marker":{"color":"rgba(127,39,4,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(127,39,4,1)"}},"textfont":{"color":"rgba(127,39,4,1)","size":55},"error_y":{"color":"rgba(127,39,4,1)","width":55},"error_x":{"color":"rgba(127,39,4,1)","width":55},"line":{"color":"rgba(127,39,4,1)","width":55},"frame":null},{"x":[-178.29631391235785,-95.460529735750939,-84.121699088777589,2019.5812702058772,2004.4121395448383,1886.9176757816108,-1994.9546824636782,-1928.6585693169675,-1993.2219917993286,-1802.9001967576983,-1695.9458511335527,-1829.3025764796041],"y":[-1701.9196351221321,-1796.9316964160168,-1734.9791438806772,-816.87739889362831,-808.8440333688726,-791.92460277121961,534.93807984502314,477.80570999598228,379.37567915150623,489.26112841960696,606.71014139766555,607.33362881409903],"z":[106.03111061820886,128.68441963200237,141.87567255472717,-126.11708010706744,-103.22494406726599,-94.014095622252626,-840.32777840581446,-742.15369633253181,-936.74160036206683,-725.01670352082692,-582.55450118849353,-559.01511554778176],"type":"scatter3d","mode":"markers","name":"100 uM iSYK","marker":{"color":"rgba(0,68,27,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,68,27,1)"}},"textfont":{"color":"rgba(0,68,27,1)","size":55},"error_y":{"color":"rgba(0,68,27,1)","width":55},"error_x":{"color":"rgba(0,68,27,1)","width":55},"line":{"color":"rgba(0,68,27,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="inhib-comp-per-cell-line" class="section level4">
<h4>Inhib comp per cell line</h4>
<pre class="r"><code># FIX: PC1 vs PC3 only, each inhib combi (iSYK + iBTK, iSYK + iNFkB, iBTK + iNFkB)

# iSYK and iBTK
fig1 &lt;- ggplot(subset(pca_data_all, inhibitor %in% c(&quot;iSYK&quot;, &quot;iBTK&quot;))) + 
  geom_point(aes(x = PC1, y = PC3, shape = stimulus, color = inhib_conc_text), size = 3) + 
  facet_wrap(~cell_line, ncol = 1, scales = &quot;free_y&quot;) +
  scale_color_manual(values = colors_inhib_conc) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;iSYK and iBTK&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig1

# iSYK and iNFkB
fig2 &lt;- ggplot(subset(pca_data_all, inhibitor %in% c(&quot;iSYK&quot;, &quot;iNFkB&quot;))) + 
  geom_point(aes(x = PC1, y = PC3, shape = stimulus, color = inhib_conc_text), size = 3) + 
  facet_wrap(~cell_line, ncol = 1, scales = &quot;free_y&quot;) +
  scale_color_manual(values = colors_inhib_conc) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;iSYK and iNFkB&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig2

# iBTK and iNFkB
fig3 &lt;- ggplot(subset(pca_data_all, inhibitor %in% c(&quot;iNFkB&quot;, &quot;iBTK&quot;))) + 
  geom_point(aes(x = PC1, y = PC3, shape = stimulus, color = inhib_conc_text), size = 3) + 
  facet_wrap(~cell_line, ncol = 1, scales = &quot;free_y&quot;) +
  scale_color_manual(values = colors_inhib_conc) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;iBTK and iNFkB&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig3

fig &lt;- plot_grid(fig1, fig2, fig3, ncol = 3, align = &quot;h&quot;)
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_cell-1.png" width="1536" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_cell-1">
Past versions of Facto_2D_cell-1.png
</button>
</p>
<div id="fig-Facto_2D_cell-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># 3D scatter plot of PC1-3
pca_data_all$combi &lt;- paste(pca_data_all$stimulus, pca_data_all$inhib_conc_text, sep = &quot; - &quot;)
colors_combi &lt;- c(colors_grey9[c(2, 3, 5, 7, 9)], colors_green9[c(2, 3, 5, 7, 9)], colors_grey9[c(2, 3, 5, 7, 9)], colors_purple9[c(2, 3, 5, 7, 9)], colors_grey9[c(2, 3, 5, 7, 9)], colors_orange9[c(2, 3, 5, 7, 9)])
names(colors_combi) &lt;- unique(arrange(pca_data_all, inhibitor)$combi)

cell &lt;- &quot;HBL1&quot;
# iSYK vs iBTK
fig &lt;- plot_ly(subset(arrange(pca_data_all, inhibitor), cell_line == cell &amp; inhibitor %in% c(&quot;iSYK&quot;, &quot;iBTK&quot;)), 
               x = ~PC1, y = ~PC2, z = ~PC3, 
               color = ~combi, colors = colors_combi) %&gt;%
  add_markers(size = 20) %&gt;%
  layout(title = paste(cell, &quot;- iSYK vs iBTK&quot;, &quot;- Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-2856fe4723593a68b1b4" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-2856fe4723593a68b1b4">{"x":{"visdat":{"a605a1a3b6d":["function () ","plotlyVisDat"]},"cur_data":"a605a1a3b6d","attrs":{"a605a1a3b6d":{"x":{},"y":{},"z":{},"color":{},"colors":["#f0f0f0","#d9d9d9","#969696","#525252","#000000","#e5f5e0","#c7e9c0","#74c476","#238b45","#00441b","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#efedf5","#dadaeb","#9e9ac8","#6a51a3","#3f007d","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#fee6ce","#fdd0a2","#fd8d3c","#d94801","#7f2704"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":20,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"HBL1 - iSYK vs iBTK - Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-281.34024880674264,172.96450279533511,232.11926359048053],"y":[-1351.7540994152216,-1792.7476149114866,-1837.0429236997797],"z":[419.1535922829699,669.16468924436947,693.92020727310216],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iBTK (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-673.90949363469122,-557.08260305166141,-223.90100292554956],"y":[-1300.0801923119143,-1266.3130137389262,-1341.604238550864],"z":[-721.94976862158899,-529.65328055895054,629.88595527179245],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iSYK (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-67.960766317522172,-65.974463522210087,-55.409082066732751],"y":[-1603.3593830804332,-1660.7449184844299,-1679.9907123223652],"z":[296.29616175807348,435.49622411509125,415.57246847339763],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iBTK","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-204.07148340617118,-173.11657670760275,-122.61556007153493],"y":[-1576.7442332270195,-1438.9174289874722,-1546.2989124621963],"z":[51.848863491704257,222.97940714834243,238.89190004239597],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iSYK","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[223.64870528052174,524.12776288089447,236.23807134207004],"y":[-1886.4616211841633,-1984.0407646058377,-2045.7598022230195],"z":[614.10125213388039,733.80369777721137,692.94064055949366],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iBTK","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[124.00431231315571,135.86758419342854,167.5375443213953],"y":[-1804.0807272558743,-2053.3729715105178,-1888.1939552109379],"z":[658.20961006975392,254.09265164748689,479.50574122910456],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iSYK","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-142.74557208123869,-220.97341180202329,-75.334404999847294],"y":[-1753.3243103121615,-1524.3456949767956,-1846.9098595577757],"z":[43.172286293698228,-101.89545908018782,-43.567067888537352],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iBTK","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-4.9359431838147563,-155.71066136205039,-75.358415568623329],"y":[-1960.1164443250109,-1796.9700818208419,-1751.0243422913059],"z":[-228.28845973957166,-154.79006271097685,-207.12134323169977],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iSYK","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[344.28911358434004,432.8180684505229,194.29366891798554],"y":[-2281.2168066466538,-2325.9121141230676,-2092.9801467378925],"z":[-153.08572905274059,16.68164464744072,70.010097277508436],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iBTK","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-178.29631391235785,-95.460529735750939,-84.121699088777589],"y":[-1701.9196351221321,-1796.9316964160168,-1734.9791438806772],"z":[106.03111061820886,128.68441963200237,141.87567255472717],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iSYK","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[3706.046249196208,5498.3100404712859,5588.125934548083],"y":[1633.9115438434674,1886.4245576498838,1938.54793162891],"z":[-294.85485393023424,143.91595597139536,59.054512725008493],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iBTK (DMSO)","marker":{"color":"rgba(239,237,245,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(239,237,245,1)"}},"textfont":{"color":"rgba(239,237,245,1)","size":55},"error_y":{"color":"rgba(239,237,245,1)","width":55},"error_x":{"color":"rgba(239,237,245,1)","width":55},"line":{"color":"rgba(239,237,245,1)","width":55},"frame":null},{"x":[4414.9924374935554,4100.8990130043821,3594.5571379429089],"y":[1299.953229680799,1345.7546003124057,1570.6522547186423],"z":[-169.57456511417274,-172.90877236988061,-0.0062075790503665134],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iSYK (DMSO)","marker":{"color":"rgba(229,245,224,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(229,245,224,1)"}},"textfont":{"color":"rgba(229,245,224,1)","size":55},"error_y":{"color":"rgba(229,245,224,1)","width":55},"error_x":{"color":"rgba(229,245,224,1)","width":55},"line":{"color":"rgba(229,245,224,1)","width":55},"frame":null},{"x":[3776.3028386628821,3769.2518453780772,3736.2029343658573],"y":[850.31323866534046,897.74586319572677,628.51446410457447],"z":[29.933562077148061,-6.1152103298461702,-55.520274526589375],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iBTK","marker":{"color":"rgba(218,218,235,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(218,218,235,1)"}},"textfont":{"color":"rgba(218,218,235,1)","size":55},"error_y":{"color":"rgba(218,218,235,1)","width":55},"error_x":{"color":"rgba(218,218,235,1)","width":55},"line":{"color":"rgba(218,218,235,1)","width":55},"frame":null},{"x":[3181.170633843039,3388.182264750521,3460.3379347348168],"y":[931.75184341564227,1079.2903635155508,1011.3720128786387],"z":[-460.57799458147701,-203.58723475288625,-137.34027494527902],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iSYK","marker":{"color":"rgba(199,233,192,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(199,233,192,1)"}},"textfont":{"color":"rgba(199,233,192,1)","size":55},"error_y":{"color":"rgba(199,233,192,1)","width":55},"error_x":{"color":"rgba(199,233,192,1)","width":55},"line":{"color":"rgba(199,233,192,1)","width":55},"frame":null},{"x":[3130.2881458945208,4597.4295676875827,3668.4793996943326],"y":[473.49914866142888,903.17125150775223,547.74120364377313],"z":[-416.77820178968852,-416.93032639805108,-455.04169146468712],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iBTK","marker":{"color":"rgba(158,154,200,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(158,154,200,1)"}},"textfont":{"color":"rgba(158,154,200,1)","size":55},"error_y":{"color":"rgba(158,154,200,1)","width":55},"error_x":{"color":"rgba(158,154,200,1)","width":55},"line":{"color":"rgba(158,154,200,1)","width":55},"frame":null},{"x":[2261.1744610103201,2308.7000202646186,2371.7279429837458],"y":[39.944226315998833,36.678249992775903,52.868540913268511],"z":[-480.70568433043962,-290.69363440015724,-542.56823239929122],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iSYK","marker":{"color":"rgba(116,196,118,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(116,196,118,1)"}},"textfont":{"color":"rgba(116,196,118,1)","size":55},"error_y":{"color":"rgba(116,196,118,1)","width":55},"error_x":{"color":"rgba(116,196,118,1)","width":55},"line":{"color":"rgba(116,196,118,1)","width":55},"frame":null},{"x":[3335.3496980149826,3120.0829924593859,3544.0938574594675],"y":[277.89889132549848,384.55764905719616,121.46486888987725],"z":[-326.88454370142381,-48.673283141869163,-283.8825831504044],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iBTK","marker":{"color":"rgba(106,81,163,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(106,81,163,1)"}},"textfont":{"color":"rgba(106,81,163,1)","size":55},"error_y":{"color":"rgba(106,81,163,1)","width":55},"error_x":{"color":"rgba(106,81,163,1)","width":55},"line":{"color":"rgba(106,81,163,1)","width":55},"frame":null},{"x":[1714.9441019039475,1872.6062492047304,2268.5102080310317],"y":[-701.52600992511555,-626.03195952803844,-748.24281219333034],"z":[-359.2304205241586,-147.25312371859127,-178.16583349818853],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iSYK","marker":{"color":"rgba(35,139,69,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(35,139,69,1)"}},"textfont":{"color":"rgba(35,139,69,1)","size":55},"error_y":{"color":"rgba(35,139,69,1)","width":55},"error_x":{"color":"rgba(35,139,69,1)","width":55},"line":{"color":"rgba(35,139,69,1)","width":55},"frame":null},{"x":[1252.1329925362522,1346.6086550016857,1279.5507675265221],"y":[-1878.9701449641561,-2258.158036371995,-1895.0620671821275],"z":[-51.970873839002032,44.531334299086751,47.491413368716799],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iBTK","marker":{"color":"rgba(63,0,125,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(63,0,125,1)"}},"textfont":{"color":"rgba(63,0,125,1)","size":55},"error_y":{"color":"rgba(63,0,125,1)","width":55},"error_x":{"color":"rgba(63,0,125,1)","width":55},"line":{"color":"rgba(63,0,125,1)","width":55},"frame":null},{"x":[2019.5812702058772,2004.4121395448383,1886.9176757816108],"y":[-816.87739889362831,-808.8440333688726,-791.92460277121961],"z":[-126.11708010706744,-103.22494406726599,-94.014095622252626],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iSYK","marker":{"color":"rgba(0,68,27,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,68,27,1)"}},"textfont":{"color":"rgba(0,68,27,1)","size":55},"error_y":{"color":"rgba(0,68,27,1)","width":55},"error_x":{"color":"rgba(0,68,27,1)","width":55},"line":{"color":"rgba(0,68,27,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># iSYK vs iNFkB
fig &lt;- plot_ly(subset(arrange(pca_data_all, inhibitor), cell_line == cell &amp; inhibitor %in% c(&quot;iSYK&quot;, &quot;iNFkB&quot;)), 
               x = ~PC1, y = ~PC2, z = ~PC3, 
               color = ~combi, colors = colors_combi) %&gt;%
  add_markers(size = 20) %&gt;%
  layout(title = paste(cell, &quot;- iSYK vs iNFkB&quot;, &quot;- Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-44b87a695bb3b3c9962e" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-44b87a695bb3b3c9962e">{"x":{"visdat":{"a6028d431b0":["function () ","plotlyVisDat"]},"cur_data":"a6028d431b0","attrs":{"a6028d431b0":{"x":{},"y":{},"z":{},"color":{},"colors":["#f0f0f0","#d9d9d9","#969696","#525252","#000000","#e5f5e0","#c7e9c0","#74c476","#238b45","#00441b","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#efedf5","#dadaeb","#9e9ac8","#6a51a3","#3f007d","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#fee6ce","#fdd0a2","#fd8d3c","#d94801","#7f2704"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":20,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"HBL1 - iSYK vs iNFkB - Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-59.280109635970298,298.79566019763263,206.46806408778528],"y":[-1598.0932108666877,-1851.105819781096,-1837.1340139835277],"z":[814.04565597634542,658.73939310230151,611.76572911636504],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iNFkB (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-673.90949363469122,-557.08260305166141,-223.90100292554956],"y":[-1300.0801923119143,-1266.3130137389262,-1341.604238550864],"z":[-721.94976862158899,-529.65328055895054,629.88595527179245],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iSYK (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[111.16792567829702,219.0095239548105,-106.65087587111805],"y":[-1672.498994874597,-1761.2861227582328,-1465.5597310446158],"z":[691.98499259419611,513.09333434385769,471.0794755833827],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iNFkB","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-204.07148340617118,-173.11657670760275,-122.61556007153493],"y":[-1576.7442332270195,-1438.9174289874722,-1546.2989124621963],"z":[51.848863491704257,222.97940714834243,238.89190004239597],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iSYK","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[192.07749685337572,319.89521727812769,482.09615482421111],"y":[-1703.8803060716471,-1808.4667779807662,-1971.87575048651],"z":[784.92759634818071,955.56370606440635,947.32034630293003],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iNFkB","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[124.00431231315571,135.86758419342854,167.5375443213953],"y":[-1804.0807272558743,-2053.3729715105178,-1888.1939552109379],"z":[658.20961006975392,254.09265164748689,479.50574122910456],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iSYK","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-331.4889123863361,-258.12307197762635,-14.885724683435994],"y":[-1422.6981442489141,-1329.6379432494659,-1481.4134880467379],"z":[-43.932634515343011,207.67137320913125,741.05018518797681],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iNFkB","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-4.9359431838147563,-155.71066136205039,-75.358415568623329],"y":[-1960.1164443250109,-1796.9700818208419,-1751.0243422913059],"z":[-228.28845973957166,-154.79006271097685,-207.12134323169977],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iSYK","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-832.89220573075852,-769.67628693410029,-489.23408225055357],"y":[-1605.8842606339144,-1620.5236157756626,-1872.8342642594951],"z":[-2060.7186144360016,-1882.7752249241628,-1885.8471614888667],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iNFkB","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-178.29631391235785,-95.460529735750939,-84.121699088777589],"y":[-1701.9196351221321,-1796.9316964160168,-1734.9791438806772],"z":[106.03111061820886,128.68441963200237,141.87567255472717],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iSYK","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[4680.4927616607947,5452.0773107539626,5368.2011400680003],"y":[1990.605082753681,2126.9304711567947,1929.9479951153446],"z":[-40.069492711451119,-154.0651826339319,-215.64457379328235],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iNFkB (DMSO)","marker":{"color":"rgba(254,230,206,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(254,230,206,1)"}},"textfont":{"color":"rgba(254,230,206,1)","size":55},"error_y":{"color":"rgba(254,230,206,1)","width":55},"error_x":{"color":"rgba(254,230,206,1)","width":55},"line":{"color":"rgba(254,230,206,1)","width":55},"frame":null},{"x":[4414.9924374935554,4100.8990130043821,3594.5571379429089],"y":[1299.953229680799,1345.7546003124057,1570.6522547186423],"z":[-169.57456511417274,-172.90877236988061,-0.0062075790503665134],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iSYK (DMSO)","marker":{"color":"rgba(229,245,224,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(229,245,224,1)"}},"textfont":{"color":"rgba(229,245,224,1)","size":55},"error_y":{"color":"rgba(229,245,224,1)","width":55},"error_x":{"color":"rgba(229,245,224,1)","width":55},"line":{"color":"rgba(229,245,224,1)","width":55},"frame":null},{"x":[2851.0384408242999,2855.2002543044377,2859.1736328732236],"y":[-8.498898330296111,-132.03353729581139,301.47828651411896],"z":[194.37720154253316,159.41371210012565,-200.16005739600217],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iNFkB","marker":{"color":"rgba(253,208,162,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(253,208,162,1)"}},"textfont":{"color":"rgba(253,208,162,1)","size":55},"error_y":{"color":"rgba(253,208,162,1)","width":55},"error_x":{"color":"rgba(253,208,162,1)","width":55},"line":{"color":"rgba(253,208,162,1)","width":55},"frame":null},{"x":[3181.170633843039,3388.182264750521,3460.3379347348168],"y":[931.75184341564227,1079.2903635155508,1011.3720128786387],"z":[-460.57799458147701,-203.58723475288625,-137.34027494527902],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iSYK","marker":{"color":"rgba(199,233,192,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(199,233,192,1)"}},"textfont":{"color":"rgba(199,233,192,1)","size":55},"error_y":{"color":"rgba(199,233,192,1)","width":55},"error_x":{"color":"rgba(199,233,192,1)","width":55},"line":{"color":"rgba(199,233,192,1)","width":55},"frame":null},{"x":[2602.3113849868887,2272.9805650261887,2911.8427999528126],"y":[-187.76413705091949,-84.888986631923046,217.04736935353012],"z":[51.733702880876571,-48.93058591575975,-261.59921211554121],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iNFkB","marker":{"color":"rgba(253,141,60,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(253,141,60,1)"}},"textfont":{"color":"rgba(253,141,60,1)","size":55},"error_y":{"color":"rgba(253,141,60,1)","width":55},"error_x":{"color":"rgba(253,141,60,1)","width":55},"line":{"color":"rgba(253,141,60,1)","width":55},"frame":null},{"x":[2261.1744610103201,2308.7000202646186,2371.7279429837458],"y":[39.944226315998833,36.678249992775903,52.868540913268511],"z":[-480.70568433043962,-290.69363440015724,-542.56823239929122],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iSYK","marker":{"color":"rgba(116,196,118,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(116,196,118,1)"}},"textfont":{"color":"rgba(116,196,118,1)","size":55},"error_y":{"color":"rgba(116,196,118,1)","width":55},"error_x":{"color":"rgba(116,196,118,1)","width":55},"line":{"color":"rgba(116,196,118,1)","width":55},"frame":null},{"x":[2438.6224997634336,2052.5509321819591,2417.2736245581823],"y":[-331.99849384695489,-35.09149574855649,-277.88126666280965],"z":[213.33509495597067,55.551209827920331,13.866187794541519],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iNFkB","marker":{"color":"rgba(217,72,1,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,72,1,1)"}},"textfont":{"color":"rgba(217,72,1,1)","size":55},"error_y":{"color":"rgba(217,72,1,1)","width":55},"error_x":{"color":"rgba(217,72,1,1)","width":55},"line":{"color":"rgba(217,72,1,1)","width":55},"frame":null},{"x":[1714.9441019039475,1872.6062492047304,2268.5102080310317],"y":[-701.52600992511555,-626.03195952803844,-748.24281219333034],"z":[-359.2304205241586,-147.25312371859127,-178.16583349818853],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iSYK","marker":{"color":"rgba(35,139,69,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(35,139,69,1)"}},"textfont":{"color":"rgba(35,139,69,1)","size":55},"error_y":{"color":"rgba(35,139,69,1)","width":55},"error_x":{"color":"rgba(35,139,69,1)","width":55},"line":{"color":"rgba(35,139,69,1)","width":55},"frame":null},{"x":[60.146593107046826,65.010855897317143,122.36691805839871],"y":[-1101.8364490353763,-1440.2995129463716,-1358.9699053177821],"z":[-1371.9340226893025,-1716.3450062409634,-1530.8926800196828],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iNFkB","marker":{"color":"rgba(127,39,4,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(127,39,4,1)"}},"textfont":{"color":"rgba(127,39,4,1)","size":55},"error_y":{"color":"rgba(127,39,4,1)","width":55},"error_x":{"color":"rgba(127,39,4,1)","width":55},"line":{"color":"rgba(127,39,4,1)","width":55},"frame":null},{"x":[2019.5812702058772,2004.4121395448383,1886.9176757816108],"y":[-816.87739889362831,-808.8440333688726,-791.92460277121961],"z":[-126.11708010706744,-103.22494406726599,-94.014095622252626],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iSYK","marker":{"color":"rgba(0,68,27,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,68,27,1)"}},"textfont":{"color":"rgba(0,68,27,1)","size":55},"error_y":{"color":"rgba(0,68,27,1)","width":55},"error_x":{"color":"rgba(0,68,27,1)","width":55},"line":{"color":"rgba(0,68,27,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># iBTK vs iNFkB
fig &lt;- plot_ly(subset(arrange(pca_data_all, inhibitor), cell_line == cell &amp; inhibitor %in% c(&quot;iBTK&quot;, &quot;iNFkB&quot;)), 
               x = ~PC1, y = ~PC2, z = ~PC3, 
               color = ~combi, colors = colors_combi) %&gt;%
  add_markers(size = 20) %&gt;%
  layout(title = paste(cell, &quot;- iBTK vs iNFkB&quot;, &quot;- Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-b32bd53b8112fd0c4aa5" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-b32bd53b8112fd0c4aa5">{"x":{"visdat":{"a605457635f":["function () ","plotlyVisDat"]},"cur_data":"a605457635f","attrs":{"a605457635f":{"x":{},"y":{},"z":{},"color":{},"colors":["#f0f0f0","#d9d9d9","#969696","#525252","#000000","#e5f5e0","#c7e9c0","#74c476","#238b45","#00441b","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#efedf5","#dadaeb","#9e9ac8","#6a51a3","#3f007d","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#fee6ce","#fdd0a2","#fd8d3c","#d94801","#7f2704"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":20,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"HBL1 - iBTK vs iNFkB - Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-281.34024880674264,172.96450279533511,232.11926359048053],"y":[-1351.7540994152216,-1792.7476149114866,-1837.0429236997797],"z":[419.1535922829699,669.16468924436947,693.92020727310216],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iBTK (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-59.280109635970298,298.79566019763263,206.46806408778528],"y":[-1598.0932108666877,-1851.105819781096,-1837.1340139835277],"z":[814.04565597634542,658.73939310230151,611.76572911636504],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iNFkB (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-67.960766317522172,-65.974463522210087,-55.409082066732751],"y":[-1603.3593830804332,-1660.7449184844299,-1679.9907123223652],"z":[296.29616175807348,435.49622411509125,415.57246847339763],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iBTK","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[111.16792567829702,219.0095239548105,-106.65087587111805],"y":[-1672.498994874597,-1761.2861227582328,-1465.5597310446158],"z":[691.98499259419611,513.09333434385769,471.0794755833827],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iNFkB","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[223.64870528052174,524.12776288089447,236.23807134207004],"y":[-1886.4616211841633,-1984.0407646058377,-2045.7598022230195],"z":[614.10125213388039,733.80369777721137,692.94064055949366],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iBTK","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[192.07749685337572,319.89521727812769,482.09615482421111],"y":[-1703.8803060716471,-1808.4667779807662,-1971.87575048651],"z":[784.92759634818071,955.56370606440635,947.32034630293003],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iNFkB","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-142.74557208123869,-220.97341180202329,-75.334404999847294],"y":[-1753.3243103121615,-1524.3456949767956,-1846.9098595577757],"z":[43.172286293698228,-101.89545908018782,-43.567067888537352],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iBTK","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-331.4889123863361,-258.12307197762635,-14.885724683435994],"y":[-1422.6981442489141,-1329.6379432494659,-1481.4134880467379],"z":[-43.932634515343011,207.67137320913125,741.05018518797681],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iNFkB","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[344.28911358434004,432.8180684505229,194.29366891798554],"y":[-2281.2168066466538,-2325.9121141230676,-2092.9801467378925],"z":[-153.08572905274059,16.68164464744072,70.010097277508436],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iBTK","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-832.89220573075852,-769.67628693410029,-489.23408225055357],"y":[-1605.8842606339144,-1620.5236157756626,-1872.8342642594951],"z":[-2060.7186144360016,-1882.7752249241628,-1885.8471614888667],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iNFkB","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[3706.046249196208,5498.3100404712859,5588.125934548083],"y":[1633.9115438434674,1886.4245576498838,1938.54793162891],"z":[-294.85485393023424,143.91595597139536,59.054512725008493],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iBTK (DMSO)","marker":{"color":"rgba(239,237,245,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(239,237,245,1)"}},"textfont":{"color":"rgba(239,237,245,1)","size":55},"error_y":{"color":"rgba(239,237,245,1)","width":55},"error_x":{"color":"rgba(239,237,245,1)","width":55},"line":{"color":"rgba(239,237,245,1)","width":55},"frame":null},{"x":[4680.4927616607947,5452.0773107539626,5368.2011400680003],"y":[1990.605082753681,2126.9304711567947,1929.9479951153446],"z":[-40.069492711451119,-154.0651826339319,-215.64457379328235],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iNFkB (DMSO)","marker":{"color":"rgba(254,230,206,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(254,230,206,1)"}},"textfont":{"color":"rgba(254,230,206,1)","size":55},"error_y":{"color":"rgba(254,230,206,1)","width":55},"error_x":{"color":"rgba(254,230,206,1)","width":55},"line":{"color":"rgba(254,230,206,1)","width":55},"frame":null},{"x":[3776.3028386628821,3769.2518453780772,3736.2029343658573],"y":[850.31323866534046,897.74586319572677,628.51446410457447],"z":[29.933562077148061,-6.1152103298461702,-55.520274526589375],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iBTK","marker":{"color":"rgba(218,218,235,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(218,218,235,1)"}},"textfont":{"color":"rgba(218,218,235,1)","size":55},"error_y":{"color":"rgba(218,218,235,1)","width":55},"error_x":{"color":"rgba(218,218,235,1)","width":55},"line":{"color":"rgba(218,218,235,1)","width":55},"frame":null},{"x":[2851.0384408242999,2855.2002543044377,2859.1736328732236],"y":[-8.498898330296111,-132.03353729581139,301.47828651411896],"z":[194.37720154253316,159.41371210012565,-200.16005739600217],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iNFkB","marker":{"color":"rgba(253,208,162,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(253,208,162,1)"}},"textfont":{"color":"rgba(253,208,162,1)","size":55},"error_y":{"color":"rgba(253,208,162,1)","width":55},"error_x":{"color":"rgba(253,208,162,1)","width":55},"line":{"color":"rgba(253,208,162,1)","width":55},"frame":null},{"x":[3130.2881458945208,4597.4295676875827,3668.4793996943326],"y":[473.49914866142888,903.17125150775223,547.74120364377313],"z":[-416.77820178968852,-416.93032639805108,-455.04169146468712],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iBTK","marker":{"color":"rgba(158,154,200,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(158,154,200,1)"}},"textfont":{"color":"rgba(158,154,200,1)","size":55},"error_y":{"color":"rgba(158,154,200,1)","width":55},"error_x":{"color":"rgba(158,154,200,1)","width":55},"line":{"color":"rgba(158,154,200,1)","width":55},"frame":null},{"x":[2602.3113849868887,2272.9805650261887,2911.8427999528126],"y":[-187.76413705091949,-84.888986631923046,217.04736935353012],"z":[51.733702880876571,-48.93058591575975,-261.59921211554121],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iNFkB","marker":{"color":"rgba(253,141,60,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(253,141,60,1)"}},"textfont":{"color":"rgba(253,141,60,1)","size":55},"error_y":{"color":"rgba(253,141,60,1)","width":55},"error_x":{"color":"rgba(253,141,60,1)","width":55},"line":{"color":"rgba(253,141,60,1)","width":55},"frame":null},{"x":[3335.3496980149826,3120.0829924593859,3544.0938574594675],"y":[277.89889132549848,384.55764905719616,121.46486888987725],"z":[-326.88454370142381,-48.673283141869163,-283.8825831504044],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iBTK","marker":{"color":"rgba(106,81,163,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(106,81,163,1)"}},"textfont":{"color":"rgba(106,81,163,1)","size":55},"error_y":{"color":"rgba(106,81,163,1)","width":55},"error_x":{"color":"rgba(106,81,163,1)","width":55},"line":{"color":"rgba(106,81,163,1)","width":55},"frame":null},{"x":[2438.6224997634336,2052.5509321819591,2417.2736245581823],"y":[-331.99849384695489,-35.09149574855649,-277.88126666280965],"z":[213.33509495597067,55.551209827920331,13.866187794541519],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iNFkB","marker":{"color":"rgba(217,72,1,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,72,1,1)"}},"textfont":{"color":"rgba(217,72,1,1)","size":55},"error_y":{"color":"rgba(217,72,1,1)","width":55},"error_x":{"color":"rgba(217,72,1,1)","width":55},"line":{"color":"rgba(217,72,1,1)","width":55},"frame":null},{"x":[1252.1329925362522,1346.6086550016857,1279.5507675265221],"y":[-1878.9701449641561,-2258.158036371995,-1895.0620671821275],"z":[-51.970873839002032,44.531334299086751,47.491413368716799],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iBTK","marker":{"color":"rgba(63,0,125,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(63,0,125,1)"}},"textfont":{"color":"rgba(63,0,125,1)","size":55},"error_y":{"color":"rgba(63,0,125,1)","width":55},"error_x":{"color":"rgba(63,0,125,1)","width":55},"line":{"color":"rgba(63,0,125,1)","width":55},"frame":null},{"x":[60.146593107046826,65.010855897317143,122.36691805839871],"y":[-1101.8364490353763,-1440.2995129463716,-1358.9699053177821],"z":[-1371.9340226893025,-1716.3450062409634,-1530.8926800196828],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iNFkB","marker":{"color":"rgba(127,39,4,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(127,39,4,1)"}},"textfont":{"color":"rgba(127,39,4,1)","size":55},"error_y":{"color":"rgba(127,39,4,1)","width":55},"error_x":{"color":"rgba(127,39,4,1)","width":55},"line":{"color":"rgba(127,39,4,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>cell &lt;- &quot;OCI-Ly8&quot;
# iSYK vs iBTK
fig &lt;- plot_ly(subset(arrange(pca_data_all, inhibitor), cell_line == cell &amp; inhibitor %in% c(&quot;iSYK&quot;, &quot;iBTK&quot;)), 
               x = ~PC1, y = ~PC2, z = ~PC3, 
               color = ~combi, colors = colors_combi) %&gt;%
  add_markers(size = 20) %&gt;%
  layout(title = paste(cell, &quot;- iSYK vs iBTK&quot;, &quot;- Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-9256b53d0232fcd2789e" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-9256b53d0232fcd2789e">{"x":{"visdat":{"a6054256d7":["function () ","plotlyVisDat"]},"cur_data":"a6054256d7","attrs":{"a6054256d7":{"x":{},"y":{},"z":{},"color":{},"colors":["#f0f0f0","#d9d9d9","#969696","#525252","#000000","#e5f5e0","#c7e9c0","#74c476","#238b45","#00441b","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#efedf5","#dadaeb","#9e9ac8","#6a51a3","#3f007d","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#fee6ce","#fdd0a2","#fd8d3c","#d94801","#7f2704"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":20,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"OCI-Ly8 - iSYK vs iBTK - Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-1783.7082840614391,-1489.545060620982,-1507.2019451139079],"y":[669.20679358870859,607.14169351247756,469.75695432523207],"z":[496.71835903586805,699.79550113086805,400.83681849546167],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iBTK (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-1499.8045140840065,-1565.8493297244552,-1746.5838554191123],"y":[416.7191890449779,458.93416326165465,790.42590971721677],"z":[183.34075576003013,182.6452285949097,664.81699005384064],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iSYK (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-1595.1501730791435,-1500.1401879218226,-1415.3243870397832],"y":[402.22223340908079,459.09856876053902,559.04031952156106],"z":[270.87854283376038,456.01231468382628,521.29086199956589],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iBTK","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-1461.1158296579774,-1599.379626492424,-1629.2190047367767],"y":[305.74570358034657,416.52651611609201,522.67159764881512],"z":[200.21891459449583,201.93267268945377,249.64860547072362],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iSYK","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-1584.5925293832936,-1458.05259323365,-1674.0715302640422],"y":[449.0806328257969,457.44397245715737,537.80752648156704],"z":[170.94693922665948,401.8965896950989,401.13125161145535],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iBTK","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-1748.8192230804216,-1728.7303898675268,-1661.5152456255646],"y":[364.77894929845604,455.24276867262341,413.32056164012903],"z":[-450.25625111121741,-334.21465100676232,-310.08704955900998],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iSYK","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-1680.1013114934083,-1638.562870422975,-1447.8801156941242],"y":[382.78472709784234,446.92722821068827,226.331741586059],"z":[-268.44884133575232,-302.03062297704332,-79.512915838424519],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iBTK","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-1650.4085008243976,-1652.7307778944064,-1627.8930316963897],"y":[230.29938934282848,318.32148860700437,305.16104314466952],"z":[-467.08160540962785,-373.48320177318647,-314.41464114158816],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iSYK","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-1696.4815776954683,-1777.7046671094483,-1751.3981790047865],"y":[277.06159548504246,506.48271754617423,388.71108259686434],"z":[-298.28578877793609,-271.64060425249562,-331.14458741750127],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iBTK","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-1994.9546824636782,-1928.6585693169675,-1993.2219917993286],"y":[534.93807984502314,477.80570999598228,379.37567915150623],"z":[-840.32777840581446,-742.15369633253181,-936.74160036206683],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iSYK","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-808.25908616588879,-563.40855940524841,-513.52641389066969],"y":[1389.9708189807977,1486.9819686346286,1372.9210975768406],"z":[148.27016396906492,272.35880048650569,287.44658578643532],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iBTK (DMSO)","marker":{"color":"rgba(239,237,245,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(239,237,245,1)"}},"textfont":{"color":"rgba(239,237,245,1)","size":55},"error_y":{"color":"rgba(239,237,245,1)","width":55},"error_x":{"color":"rgba(239,237,245,1)","width":55},"line":{"color":"rgba(239,237,245,1)","width":55},"frame":null},{"x":[-581.98396418201708,-640.92136152967896,-857.54959625467939],"y":[1216.241336888053,1266.8728396866682,1498.9330981645492],"z":[85.52324936301585,156.30974184229783,399.58314810822941],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iSYK (DMSO)","marker":{"color":"rgba(229,245,224,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(229,245,224,1)"}},"textfont":{"color":"rgba(229,245,224,1)","size":55},"error_y":{"color":"rgba(229,245,224,1)","width":55},"error_x":{"color":"rgba(229,245,224,1)","width":55},"line":{"color":"rgba(229,245,224,1)","width":55},"frame":null},{"x":[-716.82379654232739,-724.95764174632575,-879.36017935845166],"y":[1310.5500433700377,1380.7342491048116,1270.2319695520594],"z":[493.37758768839245,503.6207405610977,614.03376961482581],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iBTK","marker":{"color":"rgba(218,218,235,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(218,218,235,1)"}},"textfont":{"color":"rgba(218,218,235,1)","size":55},"error_y":{"color":"rgba(218,218,235,1)","width":55},"error_x":{"color":"rgba(218,218,235,1)","width":55},"line":{"color":"rgba(218,218,235,1)","width":55},"frame":null},{"x":[-1111.9771424546886,-1163.4047822044945,-1037.6019843044439],"y":[900.40638216936952,884.84054054106196,1023.0043757215162],"z":[221.0350207600454,105.61862919435329,362.15103549843218],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iSYK","marker":{"color":"rgba(199,233,192,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(199,233,192,1)"}},"textfont":{"color":"rgba(199,233,192,1)","size":55},"error_y":{"color":"rgba(199,233,192,1)","width":55},"error_x":{"color":"rgba(199,233,192,1)","width":55},"line":{"color":"rgba(199,233,192,1)","width":55},"frame":null},{"x":[-994.39322351232829,-995.78730879183206,-928.06753933087998],"y":[1135.4418091592572,1087.9747629687033,1586.4508942224536],"z":[590.44353240296687,419.87902733510435,1074.6325798160201],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iBTK","marker":{"color":"rgba(158,154,200,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(158,154,200,1)"}},"textfont":{"color":"rgba(158,154,200,1)","size":55},"error_y":{"color":"rgba(158,154,200,1)","width":55},"error_x":{"color":"rgba(158,154,200,1)","width":55},"line":{"color":"rgba(158,154,200,1)","width":55},"frame":null},{"x":[-1495.2934230838823,-1569.8388933349092,-1497.357683159433],"y":[578.12316224738913,757.20691277379342,787.92875098817001],"z":[-71.405534557097539,194.45798191252544,190.66521941816373],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iSYK","marker":{"color":"rgba(116,196,118,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(116,196,118,1)"}},"textfont":{"color":"rgba(116,196,118,1)","size":55},"error_y":{"color":"rgba(116,196,118,1)","width":55},"error_x":{"color":"rgba(116,196,118,1)","width":55},"line":{"color":"rgba(116,196,118,1)","width":55},"frame":null},{"x":[-1277.394503784149,-1414.0731601689299,-1064.6338565355659],"y":[873.74655568870196,1016.3102887125827,876.79997251896452],"z":[114.91220293555192,14.463009024693473,268.01087043083936],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iBTK","marker":{"color":"rgba(106,81,163,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(106,81,163,1)"}},"textfont":{"color":"rgba(106,81,163,1)","size":55},"error_y":{"color":"rgba(106,81,163,1)","width":55},"error_x":{"color":"rgba(106,81,163,1)","width":55},"line":{"color":"rgba(106,81,163,1)","width":55},"frame":null},{"x":[-1539.5777957381038,-1528.5158928658864,-1457.1444893454866],"y":[455.03696049764466,573.11297406719996,685.6852880313229],"z":[-595.61031234269342,-178.57153776757599,-128.75933364105711],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iSYK","marker":{"color":"rgba(35,139,69,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(35,139,69,1)"}},"textfont":{"color":"rgba(35,139,69,1)","size":55},"error_y":{"color":"rgba(35,139,69,1)","width":55},"error_x":{"color":"rgba(35,139,69,1)","width":55},"line":{"color":"rgba(35,139,69,1)","width":55},"frame":null},{"x":[-1792.7746914212778,-1561.9587054789911,-1773.3404866695396],"y":[619.14064416773726,543.02326848701296,782.60503943065692],"z":[-234.79410662048494,-248.53163280826109,-270.84049868809831],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iBTK","marker":{"color":"rgba(63,0,125,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(63,0,125,1)"}},"textfont":{"color":"rgba(63,0,125,1)","size":55},"error_y":{"color":"rgba(63,0,125,1)","width":55},"error_x":{"color":"rgba(63,0,125,1)","width":55},"line":{"color":"rgba(63,0,125,1)","width":55},"frame":null},{"x":[-1802.9001967576983,-1695.9458511335527,-1829.3025764796041],"y":[489.26112841960696,606.71014139766555,607.33362881409903],"z":[-725.01670352082692,-582.55450118849353,-559.01511554778176],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iSYK","marker":{"color":"rgba(0,68,27,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,68,27,1)"}},"textfont":{"color":"rgba(0,68,27,1)","size":55},"error_y":{"color":"rgba(0,68,27,1)","width":55},"error_x":{"color":"rgba(0,68,27,1)","width":55},"line":{"color":"rgba(0,68,27,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># iSYK vs iNFkB
fig &lt;- plot_ly(subset(arrange(pca_data_all, inhibitor), cell_line == cell &amp; inhibitor %in% c(&quot;iSYK&quot;, &quot;iNFkB&quot;)), 
               x = ~PC1, y = ~PC2, z = ~PC3, 
               color = ~combi, colors = colors_combi) %&gt;%
  add_markers(size = 20) %&gt;%
  layout(title = paste(cell, &quot;- iSYK vs iNFkB&quot;, &quot;- Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-7bdae8da60962a61ed26" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-7bdae8da60962a61ed26">{"x":{"visdat":{"a60fce2177":["function () ","plotlyVisDat"]},"cur_data":"a60fce2177","attrs":{"a60fce2177":{"x":{},"y":{},"z":{},"color":{},"colors":["#f0f0f0","#d9d9d9","#969696","#525252","#000000","#e5f5e0","#c7e9c0","#74c476","#238b45","#00441b","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#efedf5","#dadaeb","#9e9ac8","#6a51a3","#3f007d","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#fee6ce","#fdd0a2","#fd8d3c","#d94801","#7f2704"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":20,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"OCI-Ly8 - iSYK vs iNFkB - Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-1582.7569750198641,-1586.8287383842694,-1466.9628095203047],"y":[779.86809627861192,475.83856857833598,545.23845903210758],"z":[741.21814724948615,332.91691874211398,545.60972800726256],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iNFkB (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-1499.8045140840065,-1565.8493297244552,-1746.5838554191123],"y":[416.7191890449779,458.93416326165465,790.42590971721677],"z":[183.34075576003013,182.6452285949097,664.81699005384064],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iSYK (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-1649.9332733786571,-1534.4295212826794,-1494.7169814202214],"y":[558.707182907581,569.73170147319581,656.88150799089931],"z":[151.28805975220939,554.36034964947737,632.653811110677],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iNFkB","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-1461.1158296579774,-1599.379626492424,-1629.2190047367767],"y":[305.74570358034657,416.52651611609201,522.67159764881512],"z":[200.21891459449583,201.93267268945377,249.64860547072362],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iSYK","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-1484.8350894699936,-1547.0341009743329,-1416.4480715372379],"y":[596.13153755288067,695.11483581239895,570.56739798049966],"z":[524.40511174759683,757.87699994554896,762.45413710407934],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iNFkB","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-1748.8192230804216,-1728.7303898675268,-1661.5152456255646],"y":[364.77894929845604,455.24276867262341,413.32056164012903],"z":[-450.25625111121741,-334.21465100676232,-310.08704955900998],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iSYK","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-1624.6156578638315,-1611.4919618008771,-1555.9151417114233],"y":[764.69418508482238,874.04854173635681,645.33679057747838],"z":[665.85274252940746,716.51240764046395,750.6776319010304],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iNFkB","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-1650.4085008243976,-1652.7307778944064,-1627.8930316963897],"y":[230.29938934282848,318.32148860700437,305.16104314466952],"z":[-467.08160540962785,-373.48320177318647,-314.41464114158816],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iSYK","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-2306.3446701498174,-2288.5816682148443,-2315.0284528086859],"y":[299.01454556862359,443.90914426288805,601.170555318742],"z":[-1801.5131602878644,-2101.3940403613988,-1648.8342101177204],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iNFkB","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-1994.9546824636782,-1928.6585693169675,-1993.2219917993286],"y":[534.93807984502314,477.80570999598228,379.37567915150623],"z":[-840.32777840581446,-742.15369633253181,-936.74160036206683],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iSYK","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-662.14947671035532,-516.22389550062064,-391.84013959419934],"y":[1630.2316476927692,1591.4067836845334,1703.0213510048131],"z":[281.79593671519194,295.60010794914456,331.65652179326412],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iNFkB (DMSO)","marker":{"color":"rgba(254,230,206,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(254,230,206,1)"}},"textfont":{"color":"rgba(254,230,206,1)","size":55},"error_y":{"color":"rgba(254,230,206,1)","width":55},"error_x":{"color":"rgba(254,230,206,1)","width":55},"line":{"color":"rgba(254,230,206,1)","width":55},"frame":null},{"x":[-581.98396418201708,-640.92136152967896,-857.54959625467939],"y":[1216.241336888053,1266.8728396866682,1498.9330981645492],"z":[85.52324936301585,156.30974184229783,399.58314810822941],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iSYK (DMSO)","marker":{"color":"rgba(229,245,224,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(229,245,224,1)"}},"textfont":{"color":"rgba(229,245,224,1)","size":55},"error_y":{"color":"rgba(229,245,224,1)","width":55},"error_x":{"color":"rgba(229,245,224,1)","width":55},"line":{"color":"rgba(229,245,224,1)","width":55},"frame":null},{"x":[-1030.6361658090207,-1048.1550789146545,-1225.8528911142796],"y":[1165.1181718189455,1145.3662071461324,1039.0687639895543],"z":[604.42755186888576,416.44451686015555,226.82652205978465],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iNFkB","marker":{"color":"rgba(253,208,162,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(253,208,162,1)"}},"textfont":{"color":"rgba(253,208,162,1)","size":55},"error_y":{"color":"rgba(253,208,162,1)","width":55},"error_x":{"color":"rgba(253,208,162,1)","width":55},"line":{"color":"rgba(253,208,162,1)","width":55},"frame":null},{"x":[-1111.9771424546886,-1163.4047822044945,-1037.6019843044439],"y":[900.40638216936952,884.84054054106196,1023.0043757215162],"z":[221.0350207600454,105.61862919435329,362.15103549843218],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iSYK","marker":{"color":"rgba(199,233,192,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(199,233,192,1)"}},"textfont":{"color":"rgba(199,233,192,1)","size":55},"error_y":{"color":"rgba(199,233,192,1)","width":55},"error_x":{"color":"rgba(199,233,192,1)","width":55},"line":{"color":"rgba(199,233,192,1)","width":55},"frame":null},{"x":[-1169.2298249063263,-1134.221309663096,-1098.6615803941354],"y":[1124.3224630607331,1229.584561531123,900.15633668523446],"z":[587.61958726818386,608.56315210128878,318.01272476855655],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iNFkB","marker":{"color":"rgba(253,141,60,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(253,141,60,1)"}},"textfont":{"color":"rgba(253,141,60,1)","size":55},"error_y":{"color":"rgba(253,141,60,1)","width":55},"error_x":{"color":"rgba(253,141,60,1)","width":55},"line":{"color":"rgba(253,141,60,1)","width":55},"frame":null},{"x":[-1495.2934230838823,-1569.8388933349092,-1497.357683159433],"y":[578.12316224738913,757.20691277379342,787.92875098817001],"z":[-71.405534557097539,194.45798191252544,190.66521941816373],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iSYK","marker":{"color":"rgba(116,196,118,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(116,196,118,1)"}},"textfont":{"color":"rgba(116,196,118,1)","size":55},"error_y":{"color":"rgba(116,196,118,1)","width":55},"error_x":{"color":"rgba(116,196,118,1)","width":55},"line":{"color":"rgba(116,196,118,1)","width":55},"frame":null},{"x":[-1308.8636100825138,-1324.2227977524401,-1343.8705437195731],"y":[1099.5356987339403,1101.1066190902727,1148.4802986380953],"z":[343.20960290043661,411.35484984579836,290.06092930199736],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iNFkB","marker":{"color":"rgba(217,72,1,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,72,1,1)"}},"textfont":{"color":"rgba(217,72,1,1)","size":55},"error_y":{"color":"rgba(217,72,1,1)","width":55},"error_x":{"color":"rgba(217,72,1,1)","width":55},"line":{"color":"rgba(217,72,1,1)","width":55},"frame":null},{"x":[-1539.5777957381038,-1528.5158928658864,-1457.1444893454866],"y":[455.03696049764466,573.11297406719996,685.6852880313229],"z":[-595.61031234269342,-178.57153776757599,-128.75933364105711],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iSYK","marker":{"color":"rgba(35,139,69,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(35,139,69,1)"}},"textfont":{"color":"rgba(35,139,69,1)","size":55},"error_y":{"color":"rgba(35,139,69,1)","width":55},"error_x":{"color":"rgba(35,139,69,1)","width":55},"line":{"color":"rgba(35,139,69,1)","width":55},"frame":null},{"x":[-2016.255997187511,-2306.5504084477629,-2153.5966586574073],"y":[801.35334799227144,853.27751719784339,732.63658483220524],"z":[-1599.5497799277032,-1988.045612394717,-1862.9197842315455],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iNFkB","marker":{"color":"rgba(127,39,4,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(127,39,4,1)"}},"textfont":{"color":"rgba(127,39,4,1)","size":55},"error_y":{"color":"rgba(127,39,4,1)","width":55},"error_x":{"color":"rgba(127,39,4,1)","width":55},"line":{"color":"rgba(127,39,4,1)","width":55},"frame":null},{"x":[-1802.9001967576983,-1695.9458511335527,-1829.3025764796041],"y":[489.26112841960696,606.71014139766555,607.33362881409903],"z":[-725.01670352082692,-582.55450118849353,-559.01511554778176],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iSYK","marker":{"color":"rgba(0,68,27,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,68,27,1)"}},"textfont":{"color":"rgba(0,68,27,1)","size":55},"error_y":{"color":"rgba(0,68,27,1)","width":55},"error_x":{"color":"rgba(0,68,27,1)","width":55},"line":{"color":"rgba(0,68,27,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># iBTK vs iNFkB
fig &lt;- plot_ly(subset(arrange(pca_data_all, inhibitor), cell_line == cell &amp; inhibitor %in% c(&quot;iBTK&quot;, &quot;iNFkB&quot;)), 
               x = ~PC1, y = ~PC2, z = ~PC3, 
               color = ~combi, colors = colors_combi) %&gt;%
  add_markers(size = 20) %&gt;%
  layout(title = paste(cell, &quot;- iBTK vs iNFkB&quot;, &quot;- Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-16b3270f620c9244822d" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-16b3270f620c9244822d">{"x":{"visdat":{"a6025c0604a":["function () ","plotlyVisDat"]},"cur_data":"a6025c0604a","attrs":{"a6025c0604a":{"x":{},"y":{},"z":{},"color":{},"colors":["#f0f0f0","#d9d9d9","#969696","#525252","#000000","#e5f5e0","#c7e9c0","#74c476","#238b45","#00441b","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#efedf5","#dadaeb","#9e9ac8","#6a51a3","#3f007d","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#fee6ce","#fdd0a2","#fd8d3c","#d94801","#7f2704"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":20,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"OCI-Ly8 - iBTK vs iNFkB - Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-1783.7082840614391,-1489.545060620982,-1507.2019451139079],"y":[669.20679358870859,607.14169351247756,469.75695432523207],"z":[496.71835903586805,699.79550113086805,400.83681849546167],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iBTK (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-1582.7569750198641,-1586.8287383842694,-1466.9628095203047],"y":[779.86809627861192,475.83856857833598,545.23845903210758],"z":[741.21814724948615,332.91691874211398,545.60972800726256],"type":"scatter3d","mode":"markers","name":"PBS - 0 uM iNFkB (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-1595.1501730791435,-1500.1401879218226,-1415.3243870397832],"y":[402.22223340908079,459.09856876053902,559.04031952156106],"z":[270.87854283376038,456.01231468382628,521.29086199956589],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iBTK","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-1649.9332733786571,-1534.4295212826794,-1494.7169814202214],"y":[558.707182907581,569.73170147319581,656.88150799089931],"z":[151.28805975220939,554.36034964947737,632.653811110677],"type":"scatter3d","mode":"markers","name":"PBS - 0.1 uM iNFkB","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-1584.5925293832936,-1458.05259323365,-1674.0715302640422],"y":[449.0806328257969,457.44397245715737,537.80752648156704],"z":[170.94693922665948,401.8965896950989,401.13125161145535],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iBTK","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-1484.8350894699936,-1547.0341009743329,-1416.4480715372379],"y":[596.13153755288067,695.11483581239895,570.56739798049966],"z":[524.40511174759683,757.87699994554896,762.45413710407934],"type":"scatter3d","mode":"markers","name":"PBS - 1 uM iNFkB","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-1680.1013114934083,-1638.562870422975,-1447.8801156941242],"y":[382.78472709784234,446.92722821068827,226.331741586059],"z":[-268.44884133575232,-302.03062297704332,-79.512915838424519],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iBTK","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-1624.6156578638315,-1611.4919618008771,-1555.9151417114233],"y":[764.69418508482238,874.04854173635681,645.33679057747838],"z":[665.85274252940746,716.51240764046395,750.6776319010304],"type":"scatter3d","mode":"markers","name":"PBS - 10 uM iNFkB","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-1696.4815776954683,-1777.7046671094483,-1751.3981790047865],"y":[277.06159548504246,506.48271754617423,388.71108259686434],"z":[-298.28578877793609,-271.64060425249562,-331.14458741750127],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iBTK","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-2306.3446701498174,-2288.5816682148443,-2315.0284528086859],"y":[299.01454556862359,443.90914426288805,601.170555318742],"z":[-1801.5131602878644,-2101.3940403613988,-1648.8342101177204],"type":"scatter3d","mode":"markers","name":"PBS - 100 uM iNFkB","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-808.25908616588879,-563.40855940524841,-513.52641389066969],"y":[1389.9708189807977,1486.9819686346286,1372.9210975768406],"z":[148.27016396906492,272.35880048650569,287.44658578643532],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iBTK (DMSO)","marker":{"color":"rgba(239,237,245,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(239,237,245,1)"}},"textfont":{"color":"rgba(239,237,245,1)","size":55},"error_y":{"color":"rgba(239,237,245,1)","width":55},"error_x":{"color":"rgba(239,237,245,1)","width":55},"line":{"color":"rgba(239,237,245,1)","width":55},"frame":null},{"x":[-662.14947671035532,-516.22389550062064,-391.84013959419934],"y":[1630.2316476927692,1591.4067836845334,1703.0213510048131],"z":[281.79593671519194,295.60010794914456,331.65652179326412],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0 uM iNFkB (DMSO)","marker":{"color":"rgba(254,230,206,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(254,230,206,1)"}},"textfont":{"color":"rgba(254,230,206,1)","size":55},"error_y":{"color":"rgba(254,230,206,1)","width":55},"error_x":{"color":"rgba(254,230,206,1)","width":55},"line":{"color":"rgba(254,230,206,1)","width":55},"frame":null},{"x":[-716.82379654232739,-724.95764174632575,-879.36017935845166],"y":[1310.5500433700377,1380.7342491048116,1270.2319695520594],"z":[493.37758768839245,503.6207405610977,614.03376961482581],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iBTK","marker":{"color":"rgba(218,218,235,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(218,218,235,1)"}},"textfont":{"color":"rgba(218,218,235,1)","size":55},"error_y":{"color":"rgba(218,218,235,1)","width":55},"error_x":{"color":"rgba(218,218,235,1)","width":55},"line":{"color":"rgba(218,218,235,1)","width":55},"frame":null},{"x":[-1030.6361658090207,-1048.1550789146545,-1225.8528911142796],"y":[1165.1181718189455,1145.3662071461324,1039.0687639895543],"z":[604.42755186888576,416.44451686015555,226.82652205978465],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 0.1 uM iNFkB","marker":{"color":"rgba(253,208,162,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(253,208,162,1)"}},"textfont":{"color":"rgba(253,208,162,1)","size":55},"error_y":{"color":"rgba(253,208,162,1)","width":55},"error_x":{"color":"rgba(253,208,162,1)","width":55},"line":{"color":"rgba(253,208,162,1)","width":55},"frame":null},{"x":[-994.39322351232829,-995.78730879183206,-928.06753933087998],"y":[1135.4418091592572,1087.9747629687033,1586.4508942224536],"z":[590.44353240296687,419.87902733510435,1074.6325798160201],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iBTK","marker":{"color":"rgba(158,154,200,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(158,154,200,1)"}},"textfont":{"color":"rgba(158,154,200,1)","size":55},"error_y":{"color":"rgba(158,154,200,1)","width":55},"error_x":{"color":"rgba(158,154,200,1)","width":55},"line":{"color":"rgba(158,154,200,1)","width":55},"frame":null},{"x":[-1169.2298249063263,-1134.221309663096,-1098.6615803941354],"y":[1124.3224630607331,1229.584561531123,900.15633668523446],"z":[587.61958726818386,608.56315210128878,318.01272476855655],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 1 uM iNFkB","marker":{"color":"rgba(253,141,60,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(253,141,60,1)"}},"textfont":{"color":"rgba(253,141,60,1)","size":55},"error_y":{"color":"rgba(253,141,60,1)","width":55},"error_x":{"color":"rgba(253,141,60,1)","width":55},"line":{"color":"rgba(253,141,60,1)","width":55},"frame":null},{"x":[-1277.394503784149,-1414.0731601689299,-1064.6338565355659],"y":[873.74655568870196,1016.3102887125827,876.79997251896452],"z":[114.91220293555192,14.463009024693473,268.01087043083936],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iBTK","marker":{"color":"rgba(106,81,163,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(106,81,163,1)"}},"textfont":{"color":"rgba(106,81,163,1)","size":55},"error_y":{"color":"rgba(106,81,163,1)","width":55},"error_x":{"color":"rgba(106,81,163,1)","width":55},"line":{"color":"rgba(106,81,163,1)","width":55},"frame":null},{"x":[-1308.8636100825138,-1324.2227977524401,-1343.8705437195731],"y":[1099.5356987339403,1101.1066190902727,1148.4802986380953],"z":[343.20960290043661,411.35484984579836,290.06092930199736],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 10 uM iNFkB","marker":{"color":"rgba(217,72,1,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,72,1,1)"}},"textfont":{"color":"rgba(217,72,1,1)","size":55},"error_y":{"color":"rgba(217,72,1,1)","width":55},"error_x":{"color":"rgba(217,72,1,1)","width":55},"line":{"color":"rgba(217,72,1,1)","width":55},"frame":null},{"x":[-1792.7746914212778,-1561.9587054789911,-1773.3404866695396],"y":[619.14064416773726,543.02326848701296,782.60503943065692],"z":[-234.79410662048494,-248.53163280826109,-270.84049868809831],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iBTK","marker":{"color":"rgba(63,0,125,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(63,0,125,1)"}},"textfont":{"color":"rgba(63,0,125,1)","size":55},"error_y":{"color":"rgba(63,0,125,1)","width":55},"error_x":{"color":"rgba(63,0,125,1)","width":55},"line":{"color":"rgba(63,0,125,1)","width":55},"frame":null},{"x":[-2016.255997187511,-2306.5504084477629,-2153.5966586574073],"y":[801.35334799227144,853.27751719784339,732.63658483220524],"z":[-1599.5497799277032,-1988.045612394717,-1862.9197842315455],"type":"scatter3d","mode":"markers","name":"aIg+H2O2 - 100 uM iNFkB","marker":{"color":"rgba(127,39,4,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(127,39,4,1)"}},"textfont":{"color":"rgba(127,39,4,1)","size":55},"error_y":{"color":"rgba(127,39,4,1)","width":55},"error_x":{"color":"rgba(127,39,4,1)","width":55},"line":{"color":"rgba(127,39,4,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="cell-line-comp-per-inhib" class="section level4">
<h4>Cell line comp per inhib</h4>
<pre class="r"><code># 3D scatter plot of PC1-3
pca_data_all$combi &lt;- paste(pca_data_all$cell_line, pca_data_all$stimulus, pca_data_all$inhib_conc, sep = &quot; - &quot;)
colors_combi &lt;- c(colors_grey9[c(2, 3, 5, 7, 9)], colors_pr9[c(2, 3, 5, 7, 9)], colors_grey9[c(2, 3, 5, 7, 9)], colors_yb9[c(2, 3, 5, 7, 9)])
names(colors_combi) &lt;- unique(pca_data_all$combi)

# iSYK
fig &lt;- plot_ly(subset(pca_data_all, inhibitor == &quot;iSYK&quot;), x = ~PC1, y = ~PC2, z = ~PC3, color = ~combi, colors = colors_combi) %&gt;%
    add_markers(size = 20) %&gt;%
    layout(title = paste(&quot;iSYK - Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-b3bfa1b367e311b3e0ed" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-b3bfa1b367e311b3e0ed">{"x":{"visdat":{"a6052912c54":["function () ","plotlyVisDat"]},"cur_data":"a6052912c54","attrs":{"a6052912c54":{"x":{},"y":{},"z":{},"color":{},"colors":["#f0f0f0","#d9d9d9","#969696","#525252","#000000","#e7e1ef","#d4b9da","#df65b0","#ce1256","#67001f","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#edf8b1","#c7e9b4","#41b6c4","#225ea8","#081d58"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":20,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"iSYK - Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-673.90949363469122,-557.08260305166141,-223.90100292554956],"y":[-1300.0801923119143,-1266.3130137389262,-1341.604238550864],"z":[-721.94976862158899,-529.65328055895054,629.88595527179245],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 0 uM (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-204.07148340617118,-173.11657670760275,-122.61556007153493],"y":[-1576.7442332270195,-1438.9174289874722,-1546.2989124621963],"z":[51.848863491704257,222.97940714834243,238.89190004239597],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 0.1 uM","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[124.00431231315571,135.86758419342854,167.5375443213953],"y":[-1804.0807272558743,-2053.3729715105178,-1888.1939552109379],"z":[658.20961006975392,254.09265164748689,479.50574122910456],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 1 uM","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-4.9359431838147563,-155.71066136205039,-75.358415568623329],"y":[-1960.1164443250109,-1796.9700818208419,-1751.0243422913059],"z":[-228.28845973957166,-154.79006271097685,-207.12134323169977],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 10 uM","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-178.29631391235785,-95.460529735750939,-84.121699088777589],"y":[-1701.9196351221321,-1796.9316964160168,-1734.9791438806772],"z":[106.03111061820886,128.68441963200237,141.87567255472717],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 100 uM","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[4414.9924374935554,4100.8990130043821,3594.5571379429089],"y":[1299.953229680799,1345.7546003124057,1570.6522547186423],"z":[-169.57456511417274,-172.90877236988061,-0.0062075790503665134],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 0 uM (DMSO)","marker":{"color":"rgba(231,225,239,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(231,225,239,1)"}},"textfont":{"color":"rgba(231,225,239,1)","size":55},"error_y":{"color":"rgba(231,225,239,1)","width":55},"error_x":{"color":"rgba(231,225,239,1)","width":55},"line":{"color":"rgba(231,225,239,1)","width":55},"frame":null},{"x":[3181.170633843039,3388.182264750521,3460.3379347348168],"y":[931.75184341564227,1079.2903635155508,1011.3720128786387],"z":[-460.57799458147701,-203.58723475288625,-137.34027494527902],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 0.1 uM","marker":{"color":"rgba(212,185,218,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(212,185,218,1)"}},"textfont":{"color":"rgba(212,185,218,1)","size":55},"error_y":{"color":"rgba(212,185,218,1)","width":55},"error_x":{"color":"rgba(212,185,218,1)","width":55},"line":{"color":"rgba(212,185,218,1)","width":55},"frame":null},{"x":[2261.1744610103201,2308.7000202646186,2371.7279429837458],"y":[39.944226315998833,36.678249992775903,52.868540913268511],"z":[-480.70568433043962,-290.69363440015724,-542.56823239929122],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 1 uM","marker":{"color":"rgba(223,101,176,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(223,101,176,1)"}},"textfont":{"color":"rgba(223,101,176,1)","size":55},"error_y":{"color":"rgba(223,101,176,1)","width":55},"error_x":{"color":"rgba(223,101,176,1)","width":55},"line":{"color":"rgba(223,101,176,1)","width":55},"frame":null},{"x":[1714.9441019039475,1872.6062492047304,2268.5102080310317],"y":[-701.52600992511555,-626.03195952803844,-748.24281219333034],"z":[-359.2304205241586,-147.25312371859127,-178.16583349818853],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 10 uM","marker":{"color":"rgba(206,18,86,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(206,18,86,1)"}},"textfont":{"color":"rgba(206,18,86,1)","size":55},"error_y":{"color":"rgba(206,18,86,1)","width":55},"error_x":{"color":"rgba(206,18,86,1)","width":55},"line":{"color":"rgba(206,18,86,1)","width":55},"frame":null},{"x":[2019.5812702058772,2004.4121395448383,1886.9176757816108],"y":[-816.87739889362831,-808.8440333688726,-791.92460277121961],"z":[-126.11708010706744,-103.22494406726599,-94.014095622252626],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 100 uM","marker":{"color":"rgba(103,0,31,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(103,0,31,1)"}},"textfont":{"color":"rgba(103,0,31,1)","size":55},"error_y":{"color":"rgba(103,0,31,1)","width":55},"error_x":{"color":"rgba(103,0,31,1)","width":55},"line":{"color":"rgba(103,0,31,1)","width":55},"frame":null},{"x":[-1499.8045140840065,-1565.8493297244552,-1746.5838554191123],"y":[416.7191890449779,458.93416326165465,790.42590971721677],"z":[183.34075576003013,182.6452285949097,664.81699005384064],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 0 uM (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-1461.1158296579774,-1599.379626492424,-1629.2190047367767],"y":[305.74570358034657,416.52651611609201,522.67159764881512],"z":[200.21891459449583,201.93267268945377,249.64860547072362],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 0.1 uM","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-1748.8192230804216,-1728.7303898675268,-1661.5152456255646],"y":[364.77894929845604,455.24276867262341,413.32056164012903],"z":[-450.25625111121741,-334.21465100676232,-310.08704955900998],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 1 uM","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-1650.4085008243976,-1652.7307778944064,-1627.8930316963897],"y":[230.29938934282848,318.32148860700437,305.16104314466952],"z":[-467.08160540962785,-373.48320177318647,-314.41464114158816],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 10 uM","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-1994.9546824636782,-1928.6585693169675,-1993.2219917993286],"y":[534.93807984502314,477.80570999598228,379.37567915150623],"z":[-840.32777840581446,-742.15369633253181,-936.74160036206683],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 100 uM","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-581.98396418201708,-640.92136152967896,-857.54959625467939],"y":[1216.241336888053,1266.8728396866682,1498.9330981645492],"z":[85.52324936301585,156.30974184229783,399.58314810822941],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 0 uM (DMSO)","marker":{"color":"rgba(237,248,177,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(237,248,177,1)"}},"textfont":{"color":"rgba(237,248,177,1)","size":55},"error_y":{"color":"rgba(237,248,177,1)","width":55},"error_x":{"color":"rgba(237,248,177,1)","width":55},"line":{"color":"rgba(237,248,177,1)","width":55},"frame":null},{"x":[-1111.9771424546886,-1163.4047822044945,-1037.6019843044439],"y":[900.40638216936952,884.84054054106196,1023.0043757215162],"z":[221.0350207600454,105.61862919435329,362.15103549843218],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 0.1 uM","marker":{"color":"rgba(199,233,180,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(199,233,180,1)"}},"textfont":{"color":"rgba(199,233,180,1)","size":55},"error_y":{"color":"rgba(199,233,180,1)","width":55},"error_x":{"color":"rgba(199,233,180,1)","width":55},"line":{"color":"rgba(199,233,180,1)","width":55},"frame":null},{"x":[-1495.2934230838823,-1569.8388933349092,-1497.357683159433],"y":[578.12316224738913,757.20691277379342,787.92875098817001],"z":[-71.405534557097539,194.45798191252544,190.66521941816373],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 1 uM","marker":{"color":"rgba(65,182,196,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(65,182,196,1)"}},"textfont":{"color":"rgba(65,182,196,1)","size":55},"error_y":{"color":"rgba(65,182,196,1)","width":55},"error_x":{"color":"rgba(65,182,196,1)","width":55},"line":{"color":"rgba(65,182,196,1)","width":55},"frame":null},{"x":[-1539.5777957381038,-1528.5158928658864,-1457.1444893454866],"y":[455.03696049764466,573.11297406719996,685.6852880313229],"z":[-595.61031234269342,-178.57153776757599,-128.75933364105711],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 10 uM","marker":{"color":"rgba(34,94,168,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(34,94,168,1)"}},"textfont":{"color":"rgba(34,94,168,1)","size":55},"error_y":{"color":"rgba(34,94,168,1)","width":55},"error_x":{"color":"rgba(34,94,168,1)","width":55},"line":{"color":"rgba(34,94,168,1)","width":55},"frame":null},{"x":[-1802.9001967576983,-1695.9458511335527,-1829.3025764796041],"y":[489.26112841960696,606.71014139766555,607.33362881409903],"z":[-725.01670352082692,-582.55450118849353,-559.01511554778176],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 100 uM","marker":{"color":"rgba(8,29,88,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(8,29,88,1)"}},"textfont":{"color":"rgba(8,29,88,1)","size":55},"error_y":{"color":"rgba(8,29,88,1)","width":55},"error_x":{"color":"rgba(8,29,88,1)","width":55},"line":{"color":"rgba(8,29,88,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># iBTK
fig &lt;- plot_ly(subset(pca_data_all, inhibitor == &quot;iBTK&quot;), x = ~PC1, y = ~PC2, z = ~PC3, color = ~combi, colors = colors_combi) %&gt;%
    add_markers(size = 20) %&gt;%
    layout(title = paste(&quot;iBTK - Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-2efe57890e91f2bde8f6" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-2efe57890e91f2bde8f6">{"x":{"visdat":{"a6067995fd1":["function () ","plotlyVisDat"]},"cur_data":"a6067995fd1","attrs":{"a6067995fd1":{"x":{},"y":{},"z":{},"color":{},"colors":["#f0f0f0","#d9d9d9","#969696","#525252","#000000","#e7e1ef","#d4b9da","#df65b0","#ce1256","#67001f","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#edf8b1","#c7e9b4","#41b6c4","#225ea8","#081d58"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":20,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"iBTK - Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-281.34024880674264,172.96450279533511,232.11926359048053],"y":[-1351.7540994152216,-1792.7476149114866,-1837.0429236997797],"z":[419.1535922829699,669.16468924436947,693.92020727310216],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 0 uM (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-67.960766317522172,-65.974463522210087,-55.409082066732751],"y":[-1603.3593830804332,-1660.7449184844299,-1679.9907123223652],"z":[296.29616175807348,435.49622411509125,415.57246847339763],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 0.1 uM","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[223.64870528052174,524.12776288089447,236.23807134207004],"y":[-1886.4616211841633,-1984.0407646058377,-2045.7598022230195],"z":[614.10125213388039,733.80369777721137,692.94064055949366],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 1 uM","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-142.74557208123869,-220.97341180202329,-75.334404999847294],"y":[-1753.3243103121615,-1524.3456949767956,-1846.9098595577757],"z":[43.172286293698228,-101.89545908018782,-43.567067888537352],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 10 uM","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[344.28911358434004,432.8180684505229,194.29366891798554],"y":[-2281.2168066466538,-2325.9121141230676,-2092.9801467378925],"z":[-153.08572905274059,16.68164464744072,70.010097277508436],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 100 uM","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[3706.046249196208,5498.3100404712859,5588.125934548083],"y":[1633.9115438434674,1886.4245576498838,1938.54793162891],"z":[-294.85485393023424,143.91595597139536,59.054512725008493],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 0 uM (DMSO)","marker":{"color":"rgba(231,225,239,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(231,225,239,1)"}},"textfont":{"color":"rgba(231,225,239,1)","size":55},"error_y":{"color":"rgba(231,225,239,1)","width":55},"error_x":{"color":"rgba(231,225,239,1)","width":55},"line":{"color":"rgba(231,225,239,1)","width":55},"frame":null},{"x":[3776.3028386628821,3769.2518453780772,3736.2029343658573],"y":[850.31323866534046,897.74586319572677,628.51446410457447],"z":[29.933562077148061,-6.1152103298461702,-55.520274526589375],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 0.1 uM","marker":{"color":"rgba(212,185,218,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(212,185,218,1)"}},"textfont":{"color":"rgba(212,185,218,1)","size":55},"error_y":{"color":"rgba(212,185,218,1)","width":55},"error_x":{"color":"rgba(212,185,218,1)","width":55},"line":{"color":"rgba(212,185,218,1)","width":55},"frame":null},{"x":[3130.2881458945208,4597.4295676875827,3668.4793996943326],"y":[473.49914866142888,903.17125150775223,547.74120364377313],"z":[-416.77820178968852,-416.93032639805108,-455.04169146468712],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 1 uM","marker":{"color":"rgba(223,101,176,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(223,101,176,1)"}},"textfont":{"color":"rgba(223,101,176,1)","size":55},"error_y":{"color":"rgba(223,101,176,1)","width":55},"error_x":{"color":"rgba(223,101,176,1)","width":55},"line":{"color":"rgba(223,101,176,1)","width":55},"frame":null},{"x":[3335.3496980149826,3120.0829924593859,3544.0938574594675],"y":[277.89889132549848,384.55764905719616,121.46486888987725],"z":[-326.88454370142381,-48.673283141869163,-283.8825831504044],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 10 uM","marker":{"color":"rgba(206,18,86,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(206,18,86,1)"}},"textfont":{"color":"rgba(206,18,86,1)","size":55},"error_y":{"color":"rgba(206,18,86,1)","width":55},"error_x":{"color":"rgba(206,18,86,1)","width":55},"line":{"color":"rgba(206,18,86,1)","width":55},"frame":null},{"x":[1252.1329925362522,1346.6086550016857,1279.5507675265221],"y":[-1878.9701449641561,-2258.158036371995,-1895.0620671821275],"z":[-51.970873839002032,44.531334299086751,47.491413368716799],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 100 uM","marker":{"color":"rgba(103,0,31,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(103,0,31,1)"}},"textfont":{"color":"rgba(103,0,31,1)","size":55},"error_y":{"color":"rgba(103,0,31,1)","width":55},"error_x":{"color":"rgba(103,0,31,1)","width":55},"line":{"color":"rgba(103,0,31,1)","width":55},"frame":null},{"x":[-1783.7082840614391,-1489.545060620982,-1507.2019451139079],"y":[669.20679358870859,607.14169351247756,469.75695432523207],"z":[496.71835903586805,699.79550113086805,400.83681849546167],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 0 uM (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-1595.1501730791435,-1500.1401879218226,-1415.3243870397832],"y":[402.22223340908079,459.09856876053902,559.04031952156106],"z":[270.87854283376038,456.01231468382628,521.29086199956589],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 0.1 uM","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-1584.5925293832936,-1458.05259323365,-1674.0715302640422],"y":[449.0806328257969,457.44397245715737,537.80752648156704],"z":[170.94693922665948,401.8965896950989,401.13125161145535],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 1 uM","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-1680.1013114934083,-1638.562870422975,-1447.8801156941242],"y":[382.78472709784234,446.92722821068827,226.331741586059],"z":[-268.44884133575232,-302.03062297704332,-79.512915838424519],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 10 uM","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-1696.4815776954683,-1777.7046671094483,-1751.3981790047865],"y":[277.06159548504246,506.48271754617423,388.71108259686434],"z":[-298.28578877793609,-271.64060425249562,-331.14458741750127],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 100 uM","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-808.25908616588879,-563.40855940524841,-513.52641389066969],"y":[1389.9708189807977,1486.9819686346286,1372.9210975768406],"z":[148.27016396906492,272.35880048650569,287.44658578643532],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 0 uM (DMSO)","marker":{"color":"rgba(237,248,177,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(237,248,177,1)"}},"textfont":{"color":"rgba(237,248,177,1)","size":55},"error_y":{"color":"rgba(237,248,177,1)","width":55},"error_x":{"color":"rgba(237,248,177,1)","width":55},"line":{"color":"rgba(237,248,177,1)","width":55},"frame":null},{"x":[-716.82379654232739,-724.95764174632575,-879.36017935845166],"y":[1310.5500433700377,1380.7342491048116,1270.2319695520594],"z":[493.37758768839245,503.6207405610977,614.03376961482581],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 0.1 uM","marker":{"color":"rgba(199,233,180,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(199,233,180,1)"}},"textfont":{"color":"rgba(199,233,180,1)","size":55},"error_y":{"color":"rgba(199,233,180,1)","width":55},"error_x":{"color":"rgba(199,233,180,1)","width":55},"line":{"color":"rgba(199,233,180,1)","width":55},"frame":null},{"x":[-994.39322351232829,-995.78730879183206,-928.06753933087998],"y":[1135.4418091592572,1087.9747629687033,1586.4508942224536],"z":[590.44353240296687,419.87902733510435,1074.6325798160201],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 1 uM","marker":{"color":"rgba(65,182,196,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(65,182,196,1)"}},"textfont":{"color":"rgba(65,182,196,1)","size":55},"error_y":{"color":"rgba(65,182,196,1)","width":55},"error_x":{"color":"rgba(65,182,196,1)","width":55},"line":{"color":"rgba(65,182,196,1)","width":55},"frame":null},{"x":[-1277.394503784149,-1414.0731601689299,-1064.6338565355659],"y":[873.74655568870196,1016.3102887125827,876.79997251896452],"z":[114.91220293555192,14.463009024693473,268.01087043083936],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 10 uM","marker":{"color":"rgba(34,94,168,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(34,94,168,1)"}},"textfont":{"color":"rgba(34,94,168,1)","size":55},"error_y":{"color":"rgba(34,94,168,1)","width":55},"error_x":{"color":"rgba(34,94,168,1)","width":55},"line":{"color":"rgba(34,94,168,1)","width":55},"frame":null},{"x":[-1792.7746914212778,-1561.9587054789911,-1773.3404866695396],"y":[619.14064416773726,543.02326848701296,782.60503943065692],"z":[-234.79410662048494,-248.53163280826109,-270.84049868809831],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 100 uM","marker":{"color":"rgba(8,29,88,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(8,29,88,1)"}},"textfont":{"color":"rgba(8,29,88,1)","size":55},"error_y":{"color":"rgba(8,29,88,1)","width":55},"error_x":{"color":"rgba(8,29,88,1)","width":55},"line":{"color":"rgba(8,29,88,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># iNFkB
fig &lt;- plot_ly(subset(pca_data_all, inhibitor == &quot;iNFkB&quot;), x = ~PC1, y = ~PC2, z = ~PC3, color = ~combi, colors = colors_combi) %&gt;%
    add_markers(size = 20) %&gt;%
    layout(title = paste(&quot;iNFkB - Variance explained:&quot;, sum(expl_var_all[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-8f4ce84fb03a9ade857d" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-8f4ce84fb03a9ade857d">{"x":{"visdat":{"a602e00401f":["function () ","plotlyVisDat"]},"cur_data":"a602e00401f","attrs":{"a602e00401f":{"x":{},"y":{},"z":{},"color":{},"colors":["#f0f0f0","#d9d9d9","#969696","#525252","#000000","#e7e1ef","#d4b9da","#df65b0","#ce1256","#67001f","#f0f0f0","#d9d9d9","#969696","#525252","#000000","#edf8b1","#c7e9b4","#41b6c4","#225ea8","#081d58"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":20,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"iNFkB - Variance explained: 86.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-59.280109635970298,298.79566019763263,206.46806408778528],"y":[-1598.0932108666877,-1851.105819781096,-1837.1340139835277],"z":[814.04565597634542,658.73939310230151,611.76572911636504],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 0 uM (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[111.16792567829702,219.0095239548105,-106.65087587111805],"y":[-1672.498994874597,-1761.2861227582328,-1465.5597310446158],"z":[691.98499259419611,513.09333434385769,471.0794755833827],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 0.1 uM","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[192.07749685337572,319.89521727812769,482.09615482421111],"y":[-1703.8803060716471,-1808.4667779807662,-1971.87575048651],"z":[784.92759634818071,955.56370606440635,947.32034630293003],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 1 uM","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-331.4889123863361,-258.12307197762635,-14.885724683435994],"y":[-1422.6981442489141,-1329.6379432494659,-1481.4134880467379],"z":[-43.932634515343011,207.67137320913125,741.05018518797681],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 10 uM","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-832.89220573075852,-769.67628693410029,-489.23408225055357],"y":[-1605.8842606339144,-1620.5236157756626,-1872.8342642594951],"z":[-2060.7186144360016,-1882.7752249241628,-1885.8471614888667],"type":"scatter3d","mode":"markers","name":"HBL1 - PBS - 100 uM","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[4680.4927616607947,5452.0773107539626,5368.2011400680003],"y":[1990.605082753681,2126.9304711567947,1929.9479951153446],"z":[-40.069492711451119,-154.0651826339319,-215.64457379328235],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 0 uM (DMSO)","marker":{"color":"rgba(231,225,239,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(231,225,239,1)"}},"textfont":{"color":"rgba(231,225,239,1)","size":55},"error_y":{"color":"rgba(231,225,239,1)","width":55},"error_x":{"color":"rgba(231,225,239,1)","width":55},"line":{"color":"rgba(231,225,239,1)","width":55},"frame":null},{"x":[2851.0384408242999,2855.2002543044377,2859.1736328732236],"y":[-8.498898330296111,-132.03353729581139,301.47828651411896],"z":[194.37720154253316,159.41371210012565,-200.16005739600217],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 0.1 uM","marker":{"color":"rgba(212,185,218,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(212,185,218,1)"}},"textfont":{"color":"rgba(212,185,218,1)","size":55},"error_y":{"color":"rgba(212,185,218,1)","width":55},"error_x":{"color":"rgba(212,185,218,1)","width":55},"line":{"color":"rgba(212,185,218,1)","width":55},"frame":null},{"x":[2602.3113849868887,2272.9805650261887,2911.8427999528126],"y":[-187.76413705091949,-84.888986631923046,217.04736935353012],"z":[51.733702880876571,-48.93058591575975,-261.59921211554121],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 1 uM","marker":{"color":"rgba(223,101,176,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(223,101,176,1)"}},"textfont":{"color":"rgba(223,101,176,1)","size":55},"error_y":{"color":"rgba(223,101,176,1)","width":55},"error_x":{"color":"rgba(223,101,176,1)","width":55},"line":{"color":"rgba(223,101,176,1)","width":55},"frame":null},{"x":[2438.6224997634336,2052.5509321819591,2417.2736245581823],"y":[-331.99849384695489,-35.09149574855649,-277.88126666280965],"z":[213.33509495597067,55.551209827920331,13.866187794541519],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 10 uM","marker":{"color":"rgba(206,18,86,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(206,18,86,1)"}},"textfont":{"color":"rgba(206,18,86,1)","size":55},"error_y":{"color":"rgba(206,18,86,1)","width":55},"error_x":{"color":"rgba(206,18,86,1)","width":55},"line":{"color":"rgba(206,18,86,1)","width":55},"frame":null},{"x":[60.146593107046826,65.010855897317143,122.36691805839871],"y":[-1101.8364490353763,-1440.2995129463716,-1358.9699053177821],"z":[-1371.9340226893025,-1716.3450062409634,-1530.8926800196828],"type":"scatter3d","mode":"markers","name":"HBL1 - aIg+H2O2 - 100 uM","marker":{"color":"rgba(103,0,31,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(103,0,31,1)"}},"textfont":{"color":"rgba(103,0,31,1)","size":55},"error_y":{"color":"rgba(103,0,31,1)","width":55},"error_x":{"color":"rgba(103,0,31,1)","width":55},"line":{"color":"rgba(103,0,31,1)","width":55},"frame":null},{"x":[-1582.7569750198641,-1586.8287383842694,-1466.9628095203047],"y":[779.86809627861192,475.83856857833598,545.23845903210758],"z":[741.21814724948615,332.91691874211398,545.60972800726256],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 0 uM (DMSO)","marker":{"color":"rgba(240,240,240,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(240,240,240,1)"}},"textfont":{"color":"rgba(240,240,240,1)","size":55},"error_y":{"color":"rgba(240,240,240,1)","width":55},"error_x":{"color":"rgba(240,240,240,1)","width":55},"line":{"color":"rgba(240,240,240,1)","width":55},"frame":null},{"x":[-1649.9332733786571,-1534.4295212826794,-1494.7169814202214],"y":[558.707182907581,569.73170147319581,656.88150799089931],"z":[151.28805975220939,554.36034964947737,632.653811110677],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 0.1 uM","marker":{"color":"rgba(217,217,217,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(217,217,217,1)"}},"textfont":{"color":"rgba(217,217,217,1)","size":55},"error_y":{"color":"rgba(217,217,217,1)","width":55},"error_x":{"color":"rgba(217,217,217,1)","width":55},"line":{"color":"rgba(217,217,217,1)","width":55},"frame":null},{"x":[-1484.8350894699936,-1547.0341009743329,-1416.4480715372379],"y":[596.13153755288067,695.11483581239895,570.56739798049966],"z":[524.40511174759683,757.87699994554896,762.45413710407934],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 1 uM","marker":{"color":"rgba(150,150,150,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(150,150,150,1)"}},"textfont":{"color":"rgba(150,150,150,1)","size":55},"error_y":{"color":"rgba(150,150,150,1)","width":55},"error_x":{"color":"rgba(150,150,150,1)","width":55},"line":{"color":"rgba(150,150,150,1)","width":55},"frame":null},{"x":[-1624.6156578638315,-1611.4919618008771,-1555.9151417114233],"y":[764.69418508482238,874.04854173635681,645.33679057747838],"z":[665.85274252940746,716.51240764046395,750.6776319010304],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 10 uM","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[-2306.3446701498174,-2288.5816682148443,-2315.0284528086859],"y":[299.01454556862359,443.90914426288805,601.170555318742],"z":[-1801.5131602878644,-2101.3940403613988,-1648.8342101177204],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - PBS - 100 uM","marker":{"color":"rgba(0,0,0,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)","size":55},"error_y":{"color":"rgba(0,0,0,1)","width":55},"error_x":{"color":"rgba(0,0,0,1)","width":55},"line":{"color":"rgba(0,0,0,1)","width":55},"frame":null},{"x":[-662.14947671035532,-516.22389550062064,-391.84013959419934],"y":[1630.2316476927692,1591.4067836845334,1703.0213510048131],"z":[281.79593671519194,295.60010794914456,331.65652179326412],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 0 uM (DMSO)","marker":{"color":"rgba(237,248,177,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(237,248,177,1)"}},"textfont":{"color":"rgba(237,248,177,1)","size":55},"error_y":{"color":"rgba(237,248,177,1)","width":55},"error_x":{"color":"rgba(237,248,177,1)","width":55},"line":{"color":"rgba(237,248,177,1)","width":55},"frame":null},{"x":[-1030.6361658090207,-1048.1550789146545,-1225.8528911142796],"y":[1165.1181718189455,1145.3662071461324,1039.0687639895543],"z":[604.42755186888576,416.44451686015555,226.82652205978465],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 0.1 uM","marker":{"color":"rgba(199,233,180,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(199,233,180,1)"}},"textfont":{"color":"rgba(199,233,180,1)","size":55},"error_y":{"color":"rgba(199,233,180,1)","width":55},"error_x":{"color":"rgba(199,233,180,1)","width":55},"line":{"color":"rgba(199,233,180,1)","width":55},"frame":null},{"x":[-1169.2298249063263,-1134.221309663096,-1098.6615803941354],"y":[1124.3224630607331,1229.584561531123,900.15633668523446],"z":[587.61958726818386,608.56315210128878,318.01272476855655],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 1 uM","marker":{"color":"rgba(65,182,196,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(65,182,196,1)"}},"textfont":{"color":"rgba(65,182,196,1)","size":55},"error_y":{"color":"rgba(65,182,196,1)","width":55},"error_x":{"color":"rgba(65,182,196,1)","width":55},"line":{"color":"rgba(65,182,196,1)","width":55},"frame":null},{"x":[-1308.8636100825138,-1324.2227977524401,-1343.8705437195731],"y":[1099.5356987339403,1101.1066190902727,1148.4802986380953],"z":[343.20960290043661,411.35484984579836,290.06092930199736],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 10 uM","marker":{"color":"rgba(34,94,168,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(34,94,168,1)"}},"textfont":{"color":"rgba(34,94,168,1)","size":55},"error_y":{"color":"rgba(34,94,168,1)","width":55},"error_x":{"color":"rgba(34,94,168,1)","width":55},"line":{"color":"rgba(34,94,168,1)","width":55},"frame":null},{"x":[-2016.255997187511,-2306.5504084477629,-2153.5966586574073],"y":[801.35334799227144,853.27751719784339,732.63658483220524],"z":[-1599.5497799277032,-1988.045612394717,-1862.9197842315455],"type":"scatter3d","mode":"markers","name":"OCI-Ly8 - aIg+H2O2 - 100 uM","marker":{"color":"rgba(8,29,88,1)","size":[55,55,55],"sizemode":"area","line":{"color":"rgba(8,29,88,1)"}},"textfont":{"color":"rgba(8,29,88,1)","size":55},"error_y":{"color":"rgba(8,29,88,1)","width":55},"error_x":{"color":"rgba(8,29,88,1)","width":55},"line":{"color":"rgba(8,29,88,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="hbl1-samples-all" class="section level3">
<h3>HBL1 samples all</h3>
<p>PCA with only the HBL1 samples</p>
<pre class="r"><code># Prepare data for FactoMineR package
# cts: dataframe with wells as row names, proteins as column names, and count data as cell values
# coldata: dataframe with wells as row names and all metadata as columns
cts &lt;- data_well_all  %&gt;%
  filter(counts &gt;= 1 &amp; cell_line == &quot;HBL1&quot;) %&gt;%
  dplyr::select(target_nospace, plate_well, counts_norm) %&gt;%
  filter(!is.na(counts_norm)) %&gt;%
  spread(target_nospace, counts_norm) %&gt;%
  replace(is.na(.), 0)

cts &lt;- column_to_rownames(cts, &quot;plate_well&quot;)
# cts2 &lt;- as.matrix(as.data.frame(cts), row_names = TRUE)

coldata &lt;- data.frame(plate_well = rownames(cts)) %&gt;%
  left_join(distinct(dplyr::select(data_well_all, all_of(meta_cols)))) %&gt;%
  mutate(stimulus = factor(stimulus, levels = stim_DS108), 
         cell_line = factor(cell_line, levels = cells_DS108), 
         inhibitor = factor(inhibitor, levels = inhib_DS108), 
         inhib_conc = factor(inhib_conc, levels = inhib_conc_DS108)) #If necessary, make factors of some metadata columns

rownames(coldata) &lt;- coldata$plate_well</code></pre>
<pre class="r"><code># Results
results_HBL1 &lt;- PCA(cts, scale.unit = FALSE, ncp = 5, graph = FALSE)

# Percentage variance explained by each PC
expl_var_HBL1 &lt;- as.data.frame(get_eigenvalue(results_HBL1)) %&gt;%
  rownames_to_column(&quot;PC&quot;) %&gt;%
  pull(var = variance.percent, name = PC) %&gt;%
  round(digits = 1)

# Results focused on variables (proteins)
variab_HBL1 &lt;- get_pca_var(results_HBL1) 
# head(variab$contrib)

# Results focused on individuals (wells)
indiv_HBL1 &lt;- get_pca_ind(results_HBL1) 
# head(indiv$contrib)
pca_data_HBL1 &lt;- as.data.frame(indiv_HBL1$coord[, 1:3]) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3) %&gt;% 
  left_join(coldata)</code></pre>
<pre class="r"><code># Variance explained by each PC (eigenvalues)
fviz_eig(results_HBL1, addlabels = TRUE)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_HBL1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_HBL1-1">
Past versions of Facto_vis_HBL1-1.png
</button>
</p>
<div id="fig-Facto_vis_HBL1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_var(results_HBL1, col.var = &quot;black&quot;)

# Quality of representation for variables
# corrplot(variab_HBL1$cos2, is.corr = FALSE)
# corrplot(variab_HBL1$contrib, is.corr = FALSE)

contrib_2.5p &lt;- as.data.frame(variab_HBL1$contrib) %&gt;%
  # rownames_to_column(&quot;target_nospace&quot;) %&gt;%
  filter(Dim.1 &gt;= 2.5 | Dim.2 &gt;= 2.5 | Dim.3 &gt;= 2.5) %&gt;% # | Dim.4 &gt;= 1 | Dim.5 &gt;= 1
  dplyr::rename(PC1 = Dim.1, PC2 =  Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC5 = Dim.5) %&gt;%
  dplyr::select(c(PC1, PC2, PC3)) %&gt;%
  as.matrix()
  # filter_all(any_vars(.&gt;1))
corrplot(contrib_2.5p, is.corr = FALSE, method = &quot;circle&quot;, outline = TRUE, 
         tl.col = &quot;black&quot;, cl.ratio = 0.75, cl.offset = 1, 
         title = &quot;Protein contributions to PC (&gt;2.5% in any PC)(HBL1 only)&quot;)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_HBL1-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_HBL1-2">
Past versions of Facto_vis_HBL1-2.png
</button>
</p>
<div id="fig-Facto_vis_HBL1-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Top10 contributing proteins to PC1-3 
fig_PC1 &lt;- fviz_contrib(results_HBL1, choice = &quot;var&quot;, axes = 1, top = 10)
fig_PC2 &lt;- fviz_contrib(results_HBL1, choice = &quot;var&quot;, axes = 2, top = 10)
fig_PC3 &lt;- fviz_contrib(results_HBL1, choice = &quot;var&quot;, axes = 3, top = 10)
plot_grid(fig_PC1, fig_PC2, fig_PC3, ncol = 3)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_HBL1-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_HBL1-3">
Past versions of Facto_vis_HBL1-3.png
</button>
</p>
<div id="fig-Facto_vis_HBL1-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_ind(results_HBL1,
#              axes = c(1, 2),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$inhib_text_new),
#              addEllipses = TRUE)
# fviz_pca_ind(results_HBL1,
#              axes = c(1, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$inhib_text_new),
#              addEllipses = TRUE)
# fviz_pca_ind(results_HBL1,
#              axes = c(2, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              # col.ind = paste(coldata$cell_line, coldata$stimulus),
#              col.ind = paste(coldata$inhib_text_new),
#              addEllipses = TRUE)</code></pre>
<pre class="r"><code># pca_data_HBL1
fig_PC12 &lt;- ggplot(pca_data_HBL1) + 
  geom_point(aes(x = PC1, y = PC2, shape = stimulus, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) +
  # geom_point(aes(x = PC1, y = PC2, shape = stimulus, color = inhib_text_new), size = 3, alpha = 0.8) + 
  facet_wrap(~inhibitor, ncol = 1) +
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_HBL1[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, expl_var_HBL1[2], &quot;% variance&quot;)) + 
  ggtitle(&quot;Normalised counts\nPC1 vs PC2 (HBL1 only)&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC12
fig_PC13 &lt;- ggplot(pca_data_HBL1) + 
  geom_point(aes(x = PC1, y = PC3, shape = stimulus, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) +
  facet_wrap(~inhibitor, ncol = 1) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_HBL1[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_HBL1[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC3&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC13
fig_PC23 &lt;- ggplot(pca_data_HBL1) + 
  geom_point(aes(x = PC2, y = PC3, shape = stimulus, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) +
  facet_wrap(~inhibitor, ncol = 1) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC2: &quot;, expl_var_HBL1[2], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_HBL1[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC2 vs PC3&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC23

fig &lt;- plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3, align = &quot;h&quot;, rel_widths = c(1, 1, 1.75))
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_HBL1-1.png" width="1536" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_HBL1-1">
Past versions of Facto_2D_HBL1-1.png
</button>
</p>
<div id="fig-Facto_2D_HBL1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Selected samples only
conditions &lt;- c(&quot;0 uM (DMSO)&quot;, &quot;100 uM&quot;)
select_colors &lt;- c(&quot;DMSO ctrl&quot; = &quot;grey&quot;, &quot;100 uM iSYK&quot; = &quot;green&quot;, &quot;100 uM iBTK&quot; = &quot;blue&quot;, &quot;100 uM iNFkB&quot; = &quot;red&quot;)
fig_PC12 &lt;- ggplot(subset(pca_data_HBL1, inhib_conc %in% conditions)) + 
  geom_point(aes(x = PC1, y = PC2, shape = stimulus, color = inhib_text_new), size = 3) +
  # scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  scale_color_manual(values = select_colors) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_HBL1[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, expl_var_HBL1[2], &quot;% variance&quot;)) + 
  ggtitle(&quot;Normalised counts\nPC1 vs PC2 (selected HBL1 only)&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC12
fig_PC13 &lt;- ggplot(subset(pca_data_HBL1, inhib_conc %in% conditions)) + 
  geom_point(aes(x = PC1, y = PC3, shape = stimulus, color = inhib_text_new), size = 3) +
  # scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  scale_color_manual(values = select_colors) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_HBL1[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_HBL1[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;Normalised counts\nPC1 vs PC3 (selected HBL1 only)&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC13
fig_PC23 &lt;- ggplot(subset(pca_data_HBL1, inhib_conc %in% conditions)) + 
  geom_point(aes(x = PC2, y = PC3, shape = stimulus, color = inhib_text_new), size = 3) +
  # scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  scale_color_manual(values = select_colors) +
  xlab(paste0(&quot;PC2: &quot;, expl_var_HBL1[2], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_HBL1[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;Normalised counts\nPC2 vs PC3 (selected HBL1 only)&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC23
fig &lt;- plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3, align = &quot;h&quot;, rel_widths = c(1, 1, 1.5))
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_HBL1-2.png" width="1536" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_HBL1-2">
Past versions of Facto_2D_HBL1-2.png
</button>
</p>
<div id="fig-Facto_2D_HBL1-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># 3D scatter plot of PC1-3
# stimulus
fig &lt;- plot_ly(pca_data_HBL1, x = ~PC1, y = ~PC2, z = ~PC3, color = ~stimulus, colors = colors_stim) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_HBL1[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-9c310d5698926ea98eff" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-9c310d5698926ea98eff">{"x":{"visdat":{"a605cf73ed1":["function () ","plotlyVisDat"]},"cur_data":"a605cf73ed1","attrs":{"a605cf73ed1":{"x":{},"y":{},"z":{},"color":{},"colors":["#525252","#fdae6b"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 89.5","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-2034.9292835644032,-1921.1836350501055,-1733.4601944543172,-1777.4545139670333,-1657.5326462751934,-1628.6286168131087,-1744.6163702260378,-1581.9253912715862,-1653.2205445775307,-1821.4189838562547,-1722.6849674823932,-1743.4512110013977,-1732.1801730389986,-1768.5072373992832,-1771.4580924518782,-1636.0222073534962,-1597.5147303013737,-1695.8737471695986,-1690.1104693649752,-1806.1783575964309,-1697.5975570618375,-1656.159782920696,-1464.5750460905517,-1740.6409571186825,-1595.2134078693853,-1557.2563804928907,-1509.1870530793517,-1841.3585884970412,-1880.4862290964891,-1785.1843640973191,-1861.9005235137442,-1796.9761909797908,-1850.6729308911033,-1842.684704649994,-1736.2558501081567,-1635.1392165698567,-1854.57571361224,-1843.6158969899088,-1799.7399149324926,-1742.6997846639531,-1692.3371947057842,-1765.8529732957732,-2301.5217877203577,-2252.8131399572749,-2163.6774143722728],"y":[-1487.2885040057022,-1178.3428015329762,-66.260999309674588,-374.5799091081285,331.83446941047293,554.75713250517651,246.81827683924379,511.44718108157991,337.87218753953363,-421.67156097232333,-313.94907338709822,-174.21336070160979,-92.766391419303886,22.779385821339545,-2.2491595726969829,300.57755855976723,263.89513972694709,-114.95753918304067,500.85025381466772,362.63404270422166,432.86070272372649,443.45854553200354,872.89558517688329,682.58221866761903,443.8695472659229,579.36985496423654,810.66183777681215,92.861848992249492,-22.150435397625024,-20.822062034475735,-68.596896987630132,-374.72808606456158,-26.456736751868331,-596.59167740527391,-469.08277868751128,358.98555317768813,362.78548736480326,152.75211239701395,144.50080755958604,668.1799466579356,888.88793141751307,594.07546306204972,-2120.4175712777751,-1791.9505608093225,-1537.3010788765523],"z":[381.58077921160856,367.38268822785398,812.35688286534707,866.02214932917525,618.03405837049752,483.84390902347724,822.40304201818492,474.23989269877717,561.09912663310593,489.38942745437873,594.74088002939618,487.586596492561,472.71001664440536,585.19323470480106,580.58264899652647,685.28920521229281,470.19984327133642,757.57391237585114,447.64410385905609,109.17020425993199,278.85638576401846,489.43691576502931,265.74552694300598,343.18105428683731,679.37624477288,780.58200526985308,600.42949401874398,-313.95713500588619,-180.29542277114984,-239.92675795322316,141.17456873292306,167.25208818473098,54.66411773013548,465.64665826377387,685.88660051229192,570.18525393158916,-259.16340976222864,-0.015860822331008738,0.045271495997064239,-833.5127390493044,-730.2591268319452,-497.04011852596449,-934.77450734680019,-978.30043746104059,-1122.1513399013495],"type":"scatter3d","mode":"markers","name":"PBS","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[3640.3409239140819,3400.4883039412202,3098.9064020047472,3235.8874330392091,4851.2331572363064,4957.101436253387,4229.2002094581258,4955.7457106797328,4784.0693563598343,2413.9272644252383,2661.2625031120856,2678.8075594930874,2832.6466546592824,2852.5078037992043,2667.5931064426973,1578.7324738028017,1511.2738328465844,1770.1701680752662,1143.8566709343725,1177.7606477291893,1241.3865437046402,2090.2566117659467,3543.712552266958,2580.4894347234263,1273.4664843044468,1060.4423049079248,1775.2404313612587,280.61770857915513,449.80865533545222,707.63749101823521,2161.7701510760894,2024.4765981556952,2243.0830801086531,1051.2894928850387,904.6789444740491,1074.687246643457,463.24172800105566,444.59730360794816,360.53565743509307,-767.82169429818532,-904.55908213871248,-756.45618149699635,-1302.4802607916351,-1472.8219619964473,-1382.3168813366469],"y":[-71.554700434542752,-345.17492006253462,-500.16654942531977,-888.62317941801075,209.54105033235732,197.73066393834702,-494.32395230147068,-101.72376403198211,-111.01662897071212,-705.95506359928277,-396.31052808749786,-351.00677180973946,110.3950951822959,-7.6024575936324919,109.73117235708942,380.5588691038335,358.27690839189603,-214.062076594497,-553.89571810945915,-172.38499233151842,-486.38258946803228,-300.89983622638709,191.58768485799339,-16.460459169108287,128.82085971958045,-108.88518876996073,-123.28494626764716,47.908369050286161,549.36334519816717,627.40424356144069,224.84135824724092,190.47240820045025,400.32502441930848,407.93736793652602,-170.48523582968255,320.1886040189234,743.81898886166471,576.17538733083791,607.32952913481301,1078.3407628611344,1378.7845216129485,1225.7121983594886,-1207.5231430066196,-1306.2531187971992,-1139.0844796256688],"z":[242.45448207061852,445.09673368811201,660.16787697851635,722.85466783689867,484.22972349717196,358.09408344026735,737.4613152206955,281.73742885203211,317.71199637863219,275.50509582918875,306.31882942921175,382.8312780320046,77.685624589156816,114.03082689861631,-67.026853549203551,-60.734781601363636,-70.890605876385735,-0.38174304071403931,-37.886506787484407,-170.46058360551785,-206.0673422520081,-280.51913995942488,-699.78885301455762,-559.12193556030786,-14.104387403390195,5.5066526626220504,-123.35044165970659,-486.05955562859248,-779.41006402501034,-787.01175057859894,-629.52184765033769,-305.2180707087316,-699.71598107219324,-132.48964536998506,157.91005220557153,-310.21998327080712,-935.36930720601413,-821.27360422059292,-876.60700401654015,-1122.7309712736965,-1229.8446445440491,-1166.3533584500872,-1015.5209982736459,-1296.9149923192492,-1185.1096466103008],"type":"scatter3d","mode":"markers","name":"aIg+H2O2","marker":{"color":"rgba(253,174,107,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(253,174,107,1)"}},"textfont":{"color":"rgba(253,174,107,1)","size":55},"error_y":{"color":"rgba(253,174,107,1)","width":55},"error_x":{"color":"rgba(253,174,107,1)","width":55},"line":{"color":"rgba(253,174,107,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># inhibitor
fig &lt;- plot_ly(pca_data_HBL1, x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_text_new, colors = c(&quot;DMSO ctrl&quot; = &quot;grey&quot;, &quot;100 uM iSYK&quot; = &quot;green&quot;, &quot;100 uM iBTK&quot; = &quot;blue&quot;, &quot;100 uM iNFkB&quot; = &quot;red&quot;)) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_HBL1[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-51139c8aa929108e2171" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-51139c8aa929108e2171">{"x":{"visdat":{"a602c0f6ba1":["function () ","plotlyVisDat"]},"cur_data":"a602c0f6ba1","attrs":{"a602c0f6ba1":{"x":{},"y":{},"z":{},"color":{},"colors":["grey","green","blue","red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 89.5","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-1732.1801730389986,-1768.5072373992832,-1771.4580924518782,2832.6466546592824,2852.5078037992043,2667.5931064426973],"y":[-92.766391419303886,22.779385821339545,-2.2491595726969829,110.3950951822959,-7.6024575936324919,109.73117235708942],"z":[472.71001664440536,585.19323470480106,580.58264899652647,77.685624589156816,114.03082689861631,-67.026853549203551],"type":"scatter3d","mode":"markers","name":"0.1 uM iBTK","marker":{"color":"transparent","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"transparent"}},"textfont":{"color":"transparent","size":55},"error_y":{"color":"transparent","width":55},"error_x":{"color":"transparent","width":55},"line":{"color":"transparent","width":55},"frame":null},{"x":[-1636.0222073534962,-1597.5147303013737,-1695.8737471695986,1578.7324738028017,1511.2738328465844,1770.1701680752662],"y":[300.57755855976723,263.89513972694709,-114.95753918304067,380.5588691038335,358.27690839189603,-214.062076594497],"z":[685.28920521229281,470.19984327133642,757.57391237585114,-60.734781601363636,-70.890605876385735,-0.38174304071403931],"type":"scatter3d","mode":"markers","name":"0.1 uM iNFkB","marker":{"color":"transparent","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"transparent"}},"textfont":{"color":"transparent","size":55},"error_y":{"color":"transparent","width":55},"error_x":{"color":"transparent","width":55},"line":{"color":"transparent","width":55},"frame":null},{"x":[-1821.4189838562547,-1722.6849674823932,-1743.4512110013977,2413.9272644252383,2661.2625031120856,2678.8075594930874],"y":[-421.67156097232333,-313.94907338709822,-174.21336070160979,-705.95506359928277,-396.31052808749786,-351.00677180973946],"z":[489.38942745437873,594.74088002939618,487.586596492561,275.50509582918875,306.31882942921175,382.8312780320046],"type":"scatter3d","mode":"markers","name":"0.1 uM iSYK","marker":{"color":"transparent","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"transparent"}},"textfont":{"color":"transparent","size":55},"error_y":{"color":"transparent","width":55},"error_x":{"color":"transparent","width":55},"line":{"color":"transparent","width":55},"frame":null},{"x":[-1656.159782920696,-1464.5750460905517,-1740.6409571186825,2090.2566117659467,3543.712552266958,2580.4894347234263],"y":[443.45854553200354,872.89558517688329,682.58221866761903,-300.89983622638709,191.58768485799339,-16.460459169108287],"z":[489.43691576502931,265.74552694300598,343.18105428683731,-280.51913995942488,-699.78885301455762,-559.12193556030786],"type":"scatter3d","mode":"markers","name":"1 uM iBTK","marker":{"color":"transparent","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"transparent"}},"textfont":{"color":"transparent","size":55},"error_y":{"color":"transparent","width":55},"error_x":{"color":"transparent","width":55},"line":{"color":"transparent","width":55},"frame":null},{"x":[-1595.2134078693853,-1557.2563804928907,-1509.1870530793517,1273.4664843044468,1060.4423049079248,1775.2404313612587],"y":[443.8695472659229,579.36985496423654,810.66183777681215,128.82085971958045,-108.88518876996073,-123.28494626764716],"z":[679.37624477288,780.58200526985308,600.42949401874398,-14.104387403390195,5.5066526626220504,-123.35044165970659],"type":"scatter3d","mode":"markers","name":"1 uM iNFkB","marker":{"color":"transparent","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"transparent"}},"textfont":{"color":"transparent","size":55},"error_y":{"color":"transparent","width":55},"error_x":{"color":"transparent","width":55},"line":{"color":"transparent","width":55},"frame":null},{"x":[-1690.1104693649752,-1806.1783575964309,-1697.5975570618375,1143.8566709343725,1177.7606477291893,1241.3865437046402],"y":[500.85025381466772,362.63404270422166,432.86070272372649,-553.89571810945915,-172.38499233151842,-486.38258946803228],"z":[447.64410385905609,109.17020425993199,278.85638576401846,-37.886506787484407,-170.46058360551785,-206.0673422520081],"type":"scatter3d","mode":"markers","name":"1 uM iSYK","marker":{"color":"transparent","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"transparent"}},"textfont":{"color":"transparent","size":55},"error_y":{"color":"transparent","width":55},"error_x":{"color":"transparent","width":55},"line":{"color":"transparent","width":55},"frame":null},{"x":[-1861.9005235137442,-1796.9761909797908,-1850.6729308911033,2161.7701510760894,2024.4765981556952,2243.0830801086531],"y":[-68.596896987630132,-374.72808606456158,-26.456736751868331,224.84135824724092,190.47240820045025,400.32502441930848],"z":[141.17456873292306,167.25208818473098,54.66411773013548,-629.52184765033769,-305.2180707087316,-699.71598107219324],"type":"scatter3d","mode":"markers","name":"10 uM iBTK","marker":{"color":"transparent","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"transparent"}},"textfont":{"color":"transparent","size":55},"error_y":{"color":"transparent","width":55},"error_x":{"color":"transparent","width":55},"line":{"color":"transparent","width":55},"frame":null},{"x":[-1842.684704649994,-1736.2558501081567,-1635.1392165698567,1051.2894928850387,904.6789444740491,1074.687246643457],"y":[-596.59167740527391,-469.08277868751128,358.98555317768813,407.93736793652602,-170.48523582968255,320.1886040189234],"z":[465.64665826377387,685.88660051229192,570.18525393158916,-132.48964536998506,157.91005220557153,-310.21998327080712],"type":"scatter3d","mode":"markers","name":"10 uM iNFkB","marker":{"color":"transparent","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"transparent"}},"textfont":{"color":"transparent","size":55},"error_y":{"color":"transparent","width":55},"error_x":{"color":"transparent","width":55},"line":{"color":"transparent","width":55},"frame":null},{"x":[-1841.3585884970412,-1880.4862290964891,-1785.1843640973191,280.61770857915513,449.80865533545222,707.63749101823521],"y":[92.861848992249492,-22.150435397625024,-20.822062034475735,47.908369050286161,549.36334519816717,627.40424356144069],"z":[-313.95713500588619,-180.29542277114984,-239.92675795322316,-486.05955562859248,-779.41006402501034,-787.01175057859894],"type":"scatter3d","mode":"markers","name":"10 uM iSYK","marker":{"color":"transparent","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"transparent"}},"textfont":{"color":"transparent","size":55},"error_y":{"color":"transparent","width":55},"error_x":{"color":"transparent","width":55},"line":{"color":"transparent","width":55},"frame":null},{"x":[-1742.6997846639531,-1692.3371947057842,-1765.8529732957732,-767.82169429818532,-904.55908213871248,-756.45618149699635],"y":[668.1799466579356,888.88793141751307,594.07546306204972,1078.3407628611344,1378.7845216129485,1225.7121983594886],"z":[-833.5127390493044,-730.2591268319452,-497.04011852596449,-1122.7309712736965,-1229.8446445440491,-1166.3533584500872],"type":"scatter3d","mode":"markers","name":"100 uM iBTK","marker":{"color":"rgba(0,0,255,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,255,1)"}},"textfont":{"color":"rgba(0,0,255,1)","size":55},"error_y":{"color":"rgba(0,0,255,1)","width":55},"error_x":{"color":"rgba(0,0,255,1)","width":55},"line":{"color":"rgba(0,0,255,1)","width":55},"frame":null},{"x":[-2301.5217877203577,-2252.8131399572749,-2163.6774143722728,-1302.4802607916351,-1472.8219619964473,-1382.3168813366469],"y":[-2120.4175712777751,-1791.9505608093225,-1537.3010788765523,-1207.5231430066196,-1306.2531187971992,-1139.0844796256688],"z":[-934.77450734680019,-978.30043746104059,-1122.1513399013495,-1015.5209982736459,-1296.9149923192492,-1185.1096466103008],"type":"scatter3d","mode":"markers","name":"100 uM iNFkB","marker":{"color":"rgba(255,0,0,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)","size":55},"error_y":{"color":"rgba(255,0,0,1)","width":55},"error_x":{"color":"rgba(255,0,0,1)","width":55},"line":{"color":"rgba(255,0,0,1)","width":55},"frame":null},{"x":[-1854.57571361224,-1843.6158969899088,-1799.7399149324926,463.24172800105566,444.59730360794816,360.53565743509307],"y":[362.78548736480326,152.75211239701395,144.50080755958604,743.81898886166471,576.17538733083791,607.32952913481301],"z":[-259.16340976222864,-0.015860822331008738,0.045271495997064239,-935.36930720601413,-821.27360422059292,-876.60700401654015],"type":"scatter3d","mode":"markers","name":"100 uM iSYK","marker":{"color":"rgba(0,255,0,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,255,0,1)"}},"textfont":{"color":"rgba(0,255,0,1)","size":55},"error_y":{"color":"rgba(0,255,0,1)","width":55},"error_x":{"color":"rgba(0,255,0,1)","width":55},"line":{"color":"rgba(0,255,0,1)","width":55},"frame":null},{"x":[-2034.9292835644032,-1921.1836350501055,-1733.4601944543172,-1777.4545139670333,-1657.5326462751934,-1628.6286168131087,-1744.6163702260378,-1581.9253912715862,-1653.2205445775307,3640.3409239140819,3400.4883039412202,3098.9064020047472,3235.8874330392091,4851.2331572363064,4957.101436253387,4229.2002094581258,4955.7457106797328,4784.0693563598343],"y":[-1487.2885040057022,-1178.3428015329762,-66.260999309674588,-374.5799091081285,331.83446941047293,554.75713250517651,246.81827683924379,511.44718108157991,337.87218753953363,-71.554700434542752,-345.17492006253462,-500.16654942531977,-888.62317941801075,209.54105033235732,197.73066393834702,-494.32395230147068,-101.72376403198211,-111.01662897071212],"z":[381.58077921160856,367.38268822785398,812.35688286534707,866.02214932917525,618.03405837049752,483.84390902347724,822.40304201818492,474.23989269877717,561.09912663310593,242.45448207061852,445.09673368811201,660.16787697851635,722.85466783689867,484.22972349717196,358.09408344026735,737.4613152206955,281.73742885203211,317.71199637863219],"type":"scatter3d","mode":"markers","name":"DMSO ctrl","marker":{"color":"rgba(190,190,190,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(190,190,190,1)"}},"textfont":{"color":"rgba(190,190,190,1)","size":55},"error_y":{"color":"rgba(190,190,190,1)","width":55},"error_x":{"color":"rgba(190,190,190,1)","width":55},"line":{"color":"rgba(190,190,190,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># inhib_conc
fig &lt;- plot_ly(arrange(pca_data_HBL1, inhibitor), x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_conc, colors = colors_blue9[c(2, 3, 5, 7, 9)]) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_HBL1[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-a8fe37a145cff0f555cc" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a8fe37a145cff0f555cc">{"x":{"visdat":{"a6017faef6":["function () ","plotlyVisDat"]},"cur_data":"a6017faef6","attrs":{"a6017faef6":{"x":{},"y":{},"z":{},"color":{},"colors":["#deebf7","#c6dbef","#6baed6","#2171b5","#08306b"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 89.5","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-2034.9292835644032,-1921.1836350501055,-1733.4601944543172,3640.3409239140819,3400.4883039412202,3098.9064020047472,-1777.4545139670333,-1657.5326462751934,-1628.6286168131087,3235.8874330392091,4851.2331572363064,4957.101436253387,-1744.6163702260378,-1581.9253912715862,-1653.2205445775307,4229.2002094581258,4955.7457106797328,4784.0693563598343],"y":[-1487.2885040057022,-1178.3428015329762,-66.260999309674588,-71.554700434542752,-345.17492006253462,-500.16654942531977,-374.5799091081285,331.83446941047293,554.75713250517651,-888.62317941801075,209.54105033235732,197.73066393834702,246.81827683924379,511.44718108157991,337.87218753953363,-494.32395230147068,-101.72376403198211,-111.01662897071212],"z":[381.58077921160856,367.38268822785398,812.35688286534707,242.45448207061852,445.09673368811201,660.16787697851635,866.02214932917525,618.03405837049752,483.84390902347724,722.85466783689867,484.22972349717196,358.09408344026735,822.40304201818492,474.23989269877717,561.09912663310593,737.4613152206955,281.73742885203211,317.71199637863219],"type":"scatter3d","mode":"markers","name":"0 uM (DMSO)","marker":{"color":"rgba(170,204,231,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(170,204,231,1)"}},"textfont":{"color":"rgba(170,204,231,1)","size":55},"error_y":{"color":"rgba(170,204,231,1)","width":55},"error_x":{"color":"rgba(170,204,231,1)","width":55},"line":{"color":"rgba(170,204,231,1)","width":55},"frame":null},{"x":[-1821.4189838562547,-1722.6849674823932,-1743.4512110013977,2413.9272644252383,2661.2625031120856,2678.8075594930874,-1732.1801730389986,-1768.5072373992832,-1771.4580924518782,2832.6466546592824,2852.5078037992043,2667.5931064426973,-1636.0222073534962,-1597.5147303013737,-1695.8737471695986,1578.7324738028017,1511.2738328465844,1770.1701680752662],"y":[-421.67156097232333,-313.94907338709822,-174.21336070160979,-705.95506359928277,-396.31052808749786,-351.00677180973946,-92.766391419303886,22.779385821339545,-2.2491595726969829,110.3950951822959,-7.6024575936324919,109.73117235708942,300.57755855976723,263.89513972694709,-114.95753918304067,380.5588691038335,358.27690839189603,-214.062076594497],"z":[489.38942745437873,594.74088002939618,487.586596492561,275.50509582918875,306.31882942921175,382.8312780320046,472.71001664440536,585.19323470480106,580.58264899652647,77.685624589156816,114.03082689861631,-67.026853549203551,685.28920521229281,470.19984327133642,757.57391237585114,-60.734781601363636,-70.890605876385735,-0.38174304071403931],"type":"scatter3d","mode":"markers","name":"0.1 uM","marker":{"color":"rgba(107,174,214,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(107,174,214,1)"}},"textfont":{"color":"rgba(107,174,214,1)","size":55},"error_y":{"color":"rgba(107,174,214,1)","width":55},"error_x":{"color":"rgba(107,174,214,1)","width":55},"line":{"color":"rgba(107,174,214,1)","width":55},"frame":null},{"x":[-1690.1104693649752,-1806.1783575964309,-1697.5975570618375,1143.8566709343725,1177.7606477291893,1241.3865437046402,-1656.159782920696,-1464.5750460905517,-1740.6409571186825,2090.2566117659467,3543.712552266958,2580.4894347234263,-1595.2134078693853,-1557.2563804928907,-1509.1870530793517,1273.4664843044468,1060.4423049079248,1775.2404313612587],"y":[500.85025381466772,362.63404270422166,432.86070272372649,-553.89571810945915,-172.38499233151842,-486.38258946803228,443.45854553200354,872.89558517688329,682.58221866761903,-300.89983622638709,191.58768485799339,-16.460459169108287,443.8695472659229,579.36985496423654,810.66183777681215,128.82085971958045,-108.88518876996073,-123.28494626764716],"z":[447.64410385905609,109.17020425993199,278.85638576401846,-37.886506787484407,-170.46058360551785,-206.0673422520081,489.43691576502931,265.74552694300598,343.18105428683731,-280.51913995942488,-699.78885301455762,-559.12193556030786,679.37624477288,780.58200526985308,600.42949401874398,-14.104387403390195,5.5066526626220504,-123.35044165970659],"type":"scatter3d","mode":"markers","name":"1 uM","marker":{"color":"rgba(64,133,192,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(64,133,192,1)"}},"textfont":{"color":"rgba(64,133,192,1)","size":55},"error_y":{"color":"rgba(64,133,192,1)","width":55},"error_x":{"color":"rgba(64,133,192,1)","width":55},"line":{"color":"rgba(64,133,192,1)","width":55},"frame":null},{"x":[-1841.3585884970412,-1880.4862290964891,-1785.1843640973191,280.61770857915513,449.80865533545222,707.63749101823521,-1861.9005235137442,-1796.9761909797908,-1850.6729308911033,2161.7701510760894,2024.4765981556952,2243.0830801086531,-1842.684704649994,-1736.2558501081567,-1635.1392165698567,1051.2894928850387,904.6789444740491,1074.687246643457],"y":[92.861848992249492,-22.150435397625024,-20.822062034475735,47.908369050286161,549.36334519816717,627.40424356144069,-68.596896987630132,-374.72808606456158,-26.456736751868331,224.84135824724092,190.47240820045025,400.32502441930848,-596.59167740527391,-469.08277868751128,358.98555317768813,407.93736793652602,-170.48523582968255,320.1886040189234],"z":[-313.95713500588619,-180.29542277114984,-239.92675795322316,-486.05955562859248,-779.41006402501034,-787.01175057859894,141.17456873292306,167.25208818473098,54.66411773013548,-629.52184765033769,-305.2180707087316,-699.71598107219324,465.64665826377387,685.88660051229192,570.18525393158916,-132.48964536998506,157.91005220557153,-310.21998327080712],"type":"scatter3d","mode":"markers","name":"10 uM","marker":{"color":"rgba(26,90,156,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(26,90,156,1)"}},"textfont":{"color":"rgba(26,90,156,1)","size":55},"error_y":{"color":"rgba(26,90,156,1)","width":55},"error_x":{"color":"rgba(26,90,156,1)","width":55},"line":{"color":"rgba(26,90,156,1)","width":55},"frame":null},{"x":[-1854.57571361224,-1843.6158969899088,-1799.7399149324926,463.24172800105566,444.59730360794816,360.53565743509307,-1742.6997846639531,-1692.3371947057842,-1765.8529732957732,-767.82169429818532,-904.55908213871248,-756.45618149699635,-2301.5217877203577,-2252.8131399572749,-2163.6774143722728,-1302.4802607916351,-1472.8219619964473,-1382.3168813366469],"y":[362.78548736480326,152.75211239701395,144.50080755958604,743.81898886166471,576.17538733083791,607.32952913481301,668.1799466579356,888.88793141751307,594.07546306204972,1078.3407628611344,1378.7845216129485,1225.7121983594886,-2120.4175712777751,-1791.9505608093225,-1537.3010788765523,-1207.5231430066196,-1306.2531187971992,-1139.0844796256688],"z":[-259.16340976222864,-0.015860822331008738,0.045271495997064239,-935.36930720601413,-821.27360422059292,-876.60700401654015,-833.5127390493044,-730.2591268319452,-497.04011852596449,-1122.7309712736965,-1229.8446445440491,-1166.3533584500872,-934.77450734680019,-978.30043746104059,-1122.1513399013495,-1015.5209982736459,-1296.9149923192492,-1185.1096466103008],"type":"scatter3d","mode":"markers","name":"100 uM","marker":{"color":"rgba(8,48,107,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(8,48,107,1)"}},"textfont":{"color":"rgba(8,48,107,1)","size":55},"error_y":{"color":"rgba(8,48,107,1)","width":55},"error_x":{"color":"rgba(8,48,107,1)","width":55},"line":{"color":"rgba(8,48,107,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># inhib_conc_text
fig &lt;- plot_ly(arrange(pca_data_HBL1, inhibitor), x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_conc_text, colors = colors_inhib_conc) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_HBL1[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-faa9c4812a851cc3040e" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-faa9c4812a851cc3040e">{"x":{"visdat":{"a603e5d19c9":["function () ","plotlyVisDat"]},"cur_data":"a603e5d19c9","attrs":{"a603e5d19c9":{"x":{},"y":{},"z":{},"color":{},"colors":["#e5f5e0","#c7e9c0","#74c476","#238b45","#00441b","#efedf5","#dadaeb","#9e9ac8","#6a51a3","#3f007d","#fee6ce","#fdd0a2","#fd8d3c","#d94801","#7f2704"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 89.5","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-1777.4545139670333,-1657.5326462751934,-1628.6286168131087,3235.8874330392091,4851.2331572363064,4957.101436253387],"y":[-374.5799091081285,331.83446941047293,554.75713250517651,-888.62317941801075,209.54105033235732,197.73066393834702],"z":[866.02214932917525,618.03405837049752,483.84390902347724,722.85466783689867,484.22972349717196,358.09408344026735],"type":"scatter3d","mode":"markers","name":"0 uM iBTK (DMSO)","marker":{"color":"rgba(239,237,245,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(239,237,245,1)"}},"textfont":{"color":"rgba(239,237,245,1)","size":55},"error_y":{"color":"rgba(239,237,245,1)","width":55},"error_x":{"color":"rgba(239,237,245,1)","width":55},"line":{"color":"rgba(239,237,245,1)","width":55},"frame":null},{"x":[-1744.6163702260378,-1581.9253912715862,-1653.2205445775307,4229.2002094581258,4955.7457106797328,4784.0693563598343],"y":[246.81827683924379,511.44718108157991,337.87218753953363,-494.32395230147068,-101.72376403198211,-111.01662897071212],"z":[822.40304201818492,474.23989269877717,561.09912663310593,737.4613152206955,281.73742885203211,317.71199637863219],"type":"scatter3d","mode":"markers","name":"0 uM iNFkB (DMSO)","marker":{"color":"rgba(254,230,206,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(254,230,206,1)"}},"textfont":{"color":"rgba(254,230,206,1)","size":55},"error_y":{"color":"rgba(254,230,206,1)","width":55},"error_x":{"color":"rgba(254,230,206,1)","width":55},"line":{"color":"rgba(254,230,206,1)","width":55},"frame":null},{"x":[-2034.9292835644032,-1921.1836350501055,-1733.4601944543172,3640.3409239140819,3400.4883039412202,3098.9064020047472],"y":[-1487.2885040057022,-1178.3428015329762,-66.260999309674588,-71.554700434542752,-345.17492006253462,-500.16654942531977],"z":[381.58077921160856,367.38268822785398,812.35688286534707,242.45448207061852,445.09673368811201,660.16787697851635],"type":"scatter3d","mode":"markers","name":"0 uM iSYK (DMSO)","marker":{"color":"rgba(229,245,224,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(229,245,224,1)"}},"textfont":{"color":"rgba(229,245,224,1)","size":55},"error_y":{"color":"rgba(229,245,224,1)","width":55},"error_x":{"color":"rgba(229,245,224,1)","width":55},"line":{"color":"rgba(229,245,224,1)","width":55},"frame":null},{"x":[-1732.1801730389986,-1768.5072373992832,-1771.4580924518782,2832.6466546592824,2852.5078037992043,2667.5931064426973],"y":[-92.766391419303886,22.779385821339545,-2.2491595726969829,110.3950951822959,-7.6024575936324919,109.73117235708942],"z":[472.71001664440536,585.19323470480106,580.58264899652647,77.685624589156816,114.03082689861631,-67.026853549203551],"type":"scatter3d","mode":"markers","name":"0.1 uM iBTK","marker":{"color":"rgba(218,218,235,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(218,218,235,1)"}},"textfont":{"color":"rgba(218,218,235,1)","size":55},"error_y":{"color":"rgba(218,218,235,1)","width":55},"error_x":{"color":"rgba(218,218,235,1)","width":55},"line":{"color":"rgba(218,218,235,1)","width":55},"frame":null},{"x":[-1636.0222073534962,-1597.5147303013737,-1695.8737471695986,1578.7324738028017,1511.2738328465844,1770.1701680752662],"y":[300.57755855976723,263.89513972694709,-114.95753918304067,380.5588691038335,358.27690839189603,-214.062076594497],"z":[685.28920521229281,470.19984327133642,757.57391237585114,-60.734781601363636,-70.890605876385735,-0.38174304071403931],"type":"scatter3d","mode":"markers","name":"0.1 uM iNFkB","marker":{"color":"rgba(253,208,162,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(253,208,162,1)"}},"textfont":{"color":"rgba(253,208,162,1)","size":55},"error_y":{"color":"rgba(253,208,162,1)","width":55},"error_x":{"color":"rgba(253,208,162,1)","width":55},"line":{"color":"rgba(253,208,162,1)","width":55},"frame":null},{"x":[-1821.4189838562547,-1722.6849674823932,-1743.4512110013977,2413.9272644252383,2661.2625031120856,2678.8075594930874],"y":[-421.67156097232333,-313.94907338709822,-174.21336070160979,-705.95506359928277,-396.31052808749786,-351.00677180973946],"z":[489.38942745437873,594.74088002939618,487.586596492561,275.50509582918875,306.31882942921175,382.8312780320046],"type":"scatter3d","mode":"markers","name":"0.1 uM iSYK","marker":{"color":"rgba(199,233,192,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(199,233,192,1)"}},"textfont":{"color":"rgba(199,233,192,1)","size":55},"error_y":{"color":"rgba(199,233,192,1)","width":55},"error_x":{"color":"rgba(199,233,192,1)","width":55},"line":{"color":"rgba(199,233,192,1)","width":55},"frame":null},{"x":[-1656.159782920696,-1464.5750460905517,-1740.6409571186825,2090.2566117659467,3543.712552266958,2580.4894347234263],"y":[443.45854553200354,872.89558517688329,682.58221866761903,-300.89983622638709,191.58768485799339,-16.460459169108287],"z":[489.43691576502931,265.74552694300598,343.18105428683731,-280.51913995942488,-699.78885301455762,-559.12193556030786],"type":"scatter3d","mode":"markers","name":"1 uM iBTK","marker":{"color":"rgba(158,154,200,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(158,154,200,1)"}},"textfont":{"color":"rgba(158,154,200,1)","size":55},"error_y":{"color":"rgba(158,154,200,1)","width":55},"error_x":{"color":"rgba(158,154,200,1)","width":55},"line":{"color":"rgba(158,154,200,1)","width":55},"frame":null},{"x":[-1595.2134078693853,-1557.2563804928907,-1509.1870530793517,1273.4664843044468,1060.4423049079248,1775.2404313612587],"y":[443.8695472659229,579.36985496423654,810.66183777681215,128.82085971958045,-108.88518876996073,-123.28494626764716],"z":[679.37624477288,780.58200526985308,600.42949401874398,-14.104387403390195,5.5066526626220504,-123.35044165970659],"type":"scatter3d","mode":"markers","name":"1 uM iNFkB","marker":{"color":"rgba(253,141,60,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(253,141,60,1)"}},"textfont":{"color":"rgba(253,141,60,1)","size":55},"error_y":{"color":"rgba(253,141,60,1)","width":55},"error_x":{"color":"rgba(253,141,60,1)","width":55},"line":{"color":"rgba(253,141,60,1)","width":55},"frame":null},{"x":[-1690.1104693649752,-1806.1783575964309,-1697.5975570618375,1143.8566709343725,1177.7606477291893,1241.3865437046402],"y":[500.85025381466772,362.63404270422166,432.86070272372649,-553.89571810945915,-172.38499233151842,-486.38258946803228],"z":[447.64410385905609,109.17020425993199,278.85638576401846,-37.886506787484407,-170.46058360551785,-206.0673422520081],"type":"scatter3d","mode":"markers","name":"1 uM iSYK","marker":{"color":"rgba(116,196,118,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(116,196,118,1)"}},"textfont":{"color":"rgba(116,196,118,1)","size":55},"error_y":{"color":"rgba(116,196,118,1)","width":55},"error_x":{"color":"rgba(116,196,118,1)","width":55},"line":{"color":"rgba(116,196,118,1)","width":55},"frame":null},{"x":[-1861.9005235137442,-1796.9761909797908,-1850.6729308911033,2161.7701510760894,2024.4765981556952,2243.0830801086531],"y":[-68.596896987630132,-374.72808606456158,-26.456736751868331,224.84135824724092,190.47240820045025,400.32502441930848],"z":[141.17456873292306,167.25208818473098,54.66411773013548,-629.52184765033769,-305.2180707087316,-699.71598107219324],"type":"scatter3d","mode":"markers","name":"10 uM iBTK","marker":{"color":"rgba(106,81,163,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(106,81,163,1)"}},"textfont":{"color":"rgba(106,81,163,1)","size":55},"error_y":{"color":"rgba(106,81,163,1)","width":55},"error_x":{"color":"rgba(106,81,163,1)","width":55},"line":{"color":"rgba(106,81,163,1)","width":55},"frame":null},{"x":[-1842.684704649994,-1736.2558501081567,-1635.1392165698567,1051.2894928850387,904.6789444740491,1074.687246643457],"y":[-596.59167740527391,-469.08277868751128,358.98555317768813,407.93736793652602,-170.48523582968255,320.1886040189234],"z":[465.64665826377387,685.88660051229192,570.18525393158916,-132.48964536998506,157.91005220557153,-310.21998327080712],"type":"scatter3d","mode":"markers","name":"10 uM iNFkB","marker":{"color":"rgba(217,72,1,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(217,72,1,1)"}},"textfont":{"color":"rgba(217,72,1,1)","size":55},"error_y":{"color":"rgba(217,72,1,1)","width":55},"error_x":{"color":"rgba(217,72,1,1)","width":55},"line":{"color":"rgba(217,72,1,1)","width":55},"frame":null},{"x":[-1841.3585884970412,-1880.4862290964891,-1785.1843640973191,280.61770857915513,449.80865533545222,707.63749101823521],"y":[92.861848992249492,-22.150435397625024,-20.822062034475735,47.908369050286161,549.36334519816717,627.40424356144069],"z":[-313.95713500588619,-180.29542277114984,-239.92675795322316,-486.05955562859248,-779.41006402501034,-787.01175057859894],"type":"scatter3d","mode":"markers","name":"10 uM iSYK","marker":{"color":"rgba(35,139,69,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(35,139,69,1)"}},"textfont":{"color":"rgba(35,139,69,1)","size":55},"error_y":{"color":"rgba(35,139,69,1)","width":55},"error_x":{"color":"rgba(35,139,69,1)","width":55},"line":{"color":"rgba(35,139,69,1)","width":55},"frame":null},{"x":[-1742.6997846639531,-1692.3371947057842,-1765.8529732957732,-767.82169429818532,-904.55908213871248,-756.45618149699635],"y":[668.1799466579356,888.88793141751307,594.07546306204972,1078.3407628611344,1378.7845216129485,1225.7121983594886],"z":[-833.5127390493044,-730.2591268319452,-497.04011852596449,-1122.7309712736965,-1229.8446445440491,-1166.3533584500872],"type":"scatter3d","mode":"markers","name":"100 uM iBTK","marker":{"color":"rgba(63,0,125,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(63,0,125,1)"}},"textfont":{"color":"rgba(63,0,125,1)","size":55},"error_y":{"color":"rgba(63,0,125,1)","width":55},"error_x":{"color":"rgba(63,0,125,1)","width":55},"line":{"color":"rgba(63,0,125,1)","width":55},"frame":null},{"x":[-2301.5217877203577,-2252.8131399572749,-2163.6774143722728,-1302.4802607916351,-1472.8219619964473,-1382.3168813366469],"y":[-2120.4175712777751,-1791.9505608093225,-1537.3010788765523,-1207.5231430066196,-1306.2531187971992,-1139.0844796256688],"z":[-934.77450734680019,-978.30043746104059,-1122.1513399013495,-1015.5209982736459,-1296.9149923192492,-1185.1096466103008],"type":"scatter3d","mode":"markers","name":"100 uM iNFkB","marker":{"color":"rgba(127,39,4,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(127,39,4,1)"}},"textfont":{"color":"rgba(127,39,4,1)","size":55},"error_y":{"color":"rgba(127,39,4,1)","width":55},"error_x":{"color":"rgba(127,39,4,1)","width":55},"line":{"color":"rgba(127,39,4,1)","width":55},"frame":null},{"x":[-1854.57571361224,-1843.6158969899088,-1799.7399149324926,463.24172800105566,444.59730360794816,360.53565743509307],"y":[362.78548736480326,152.75211239701395,144.50080755958604,743.81898886166471,576.17538733083791,607.32952913481301],"z":[-259.16340976222864,-0.015860822331008738,0.045271495997064239,-935.36930720601413,-821.27360422059292,-876.60700401654015],"type":"scatter3d","mode":"markers","name":"100 uM iSYK","marker":{"color":"rgba(0,68,27,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,68,27,1)"}},"textfont":{"color":"rgba(0,68,27,1)","size":55},"error_y":{"color":"rgba(0,68,27,1)","width":55},"error_x":{"color":"rgba(0,68,27,1)","width":55},"line":{"color":"rgba(0,68,27,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div id="umap-visualisation-1" class="section level4">
<h4>UMAP visualisation</h4>
<pre class="r"><code># Data
pca_data_5PC &lt;- as.data.frame(indiv_HBL1$coord[, 1:5]) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC53 = Dim.5) %&gt;% 
  left_join(coldata)

# UMAP data reduction
umap_pca &lt;- umap::umap(as.data.frame(indiv_HBL1$coord[, 1:5]))
# umap.defaults
# head(umap_pca$layout)
umap_pca_ann &lt;- as.data.frame(umap_pca$layout) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(UMAP1 = V1, UMAP2 = V2) %&gt;% 
  left_join(coldata)

# Basic fig of everything
fig &lt;- ggplot(umap_pca_ann, aes(x = UMAP1, y = UMAP2)) + 
  geom_point(aes(shape = stimulus, color = inhib_text_new), size = 2) + 
  scale_color_manual(values = c(&quot;DMSO ctrl&quot; = &quot;grey&quot;, &quot;100 uM iSYK&quot; = &quot;green&quot;, &quot;100 uM iBTK&quot; = &quot;blue&quot;, &quot;100 uM iNFkB&quot; = &quot;red&quot;)) +
  ggtitle(&quot;UMAP with PC1-5&quot;) +
  theme_bw() +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_UMAP_PCA2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_UMAP_PCA2-1">
Past versions of Facto_UMAP_PCA2-1.png
</button>
</p>
<div id="fig-Facto_UMAP_PCA2-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="hbl1-samples-select" class="section level3">
<h3>HBL1 samples select</h3>
<p>PCA with only the HBL1 samples</p>
<ul>
<li>basal + basal-inhibited + activated + activated-inhibited</li>
</ul>
<pre class="r"><code># Prepare data for FactoMineR package
# cts: dataframe with wells as row names, proteins as column names, and count data as cell values
# coldata: dataframe with wells as row names and all metadatconditions &lt;- c(&quot;0 uM (DMSO)&quot;, &quot;100 uM&quot;)
cts &lt;- data_well_all  %&gt;%
  filter(counts &gt;= 1 &amp; cell_line == &quot;HBL1&quot; &amp; inhib_conc %in% conditions) %&gt;%
  dplyr::select(target_nospace, plate_well, counts_norm) %&gt;%
  filter(!is.na(counts_norm)) %&gt;%
  spread(target_nospace, counts_norm) %&gt;%
  replace(is.na(.), 0)

cts &lt;- column_to_rownames(cts, &quot;plate_well&quot;)
# cts2 &lt;- as.matrix(as.data.frame(cts), row_names = TRUE)

coldata &lt;- data.frame(plate_well = rownames(cts)) %&gt;%
  left_join(distinct(dplyr::select(data_well_all, all_of(meta_cols)))) %&gt;%
  mutate(stimulus = factor(stimulus, levels = stim_DS108), 
         cell_line = factor(cell_line, levels = cells_DS108), 
         inhibitor = factor(inhibitor, levels = inhib_DS108), 
         inhib_conc = factor(inhib_conc, levels = inhib_conc_DS108)) #If necessary, make factors of some metadata columns

rownames(coldata) &lt;- coldata$plate_well</code></pre>
<pre class="r"><code># Results
results_HBL1 &lt;- PCA(cts, scale.unit = FALSE, ncp = 5, graph = FALSE)

# Percentage variance explained by each PC
expl_var_HBL1 &lt;- as.data.frame(get_eigenvalue(results_HBL1)) %&gt;%
  rownames_to_column(&quot;PC&quot;) %&gt;%
  pull(var = variance.percent, name = PC) %&gt;%
  round(digits = 1)

# Results focused on variables (proteins)
variab_HBL1 &lt;- get_pca_var(results_HBL1) 
# head(variab$contrib)

# Results focused on individuals (wells)
indiv_HBL1 &lt;- get_pca_ind(results_HBL1) 
# head(indiv$contrib)
pca_data_HBL1 &lt;- as.data.frame(indiv_HBL1$coord[, 1:3]) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3) %&gt;% 
  left_join(coldata)</code></pre>
<pre class="r"><code># Variance explained by each PC (eigenvalues)
fviz_eig(results_HBL1, addlabels = TRUE)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_HBL1s-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_HBL1s-1">
Past versions of Facto_vis_HBL1s-1.png
</button>
</p>
<div id="fig-Facto_vis_HBL1s-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_var(results_HBL1, col.var = &quot;black&quot;)

# Quality of representation for variables
# corrplot(variab_HBL1$cos2, is.corr = FALSE)
# corrplot(variab_HBL1$contrib, is.corr = FALSE)

contrib_2.5p &lt;- as.data.frame(variab_HBL1$contrib) %&gt;%
  # rownames_to_column(&quot;target_nospace&quot;) %&gt;%
  filter(Dim.1 &gt;= 2.5 | Dim.2 &gt;= 2.5 | Dim.3 &gt;= 2.5) %&gt;% # | Dim.4 &gt;= 1 | Dim.5 &gt;= 1
  dplyr::rename(PC1 = Dim.1, PC2 =  Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC5 = Dim.5) %&gt;%
  dplyr::select(c(PC1, PC2, PC3)) %&gt;%
  as.matrix()
  # filter_all(any_vars(.&gt;1))
corrplot(contrib_2.5p, is.corr = FALSE, method = &quot;circle&quot;, outline = TRUE, 
         tl.col = &quot;black&quot;, cl.ratio = 0.75, cl.offset = 1, 
         title = &quot;Protein contributions to PC (&gt;2.5% in any PC)(HBL1 only)&quot;)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_HBL1s-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_HBL1s-2">
Past versions of Facto_vis_HBL1s-2.png
</button>
</p>
<div id="fig-Facto_vis_HBL1s-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Top10 contributing proteins to PC1-3 
fig_PC1 &lt;- fviz_contrib(results_HBL1, choice = &quot;var&quot;, axes = 1, top = 10)
fig_PC2 &lt;- fviz_contrib(results_HBL1, choice = &quot;var&quot;, axes = 2, top = 10)
fig_PC3 &lt;- fviz_contrib(results_HBL1, choice = &quot;var&quot;, axes = 3, top = 10)
plot_grid(fig_PC1, fig_PC2, fig_PC3, ncol = 3)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_HBL1s-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_HBL1s-3">
Past versions of Facto_vis_HBL1s-3.png
</button>
</p>
<div id="fig-Facto_vis_HBL1s-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_ind(results_HBL1,
#              axes = c(1, 2),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$inhib_text_new),
#              addEllipses = TRUE)
# fviz_pca_ind(results_HBL1,
#              axes = c(1, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$inhib_text_new),
#              addEllipses = TRUE)
# fviz_pca_ind(results_HBL1,
#              axes = c(2, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              # col.ind = paste(coldata$cell_line, coldata$stimulus),
#              col.ind = paste(coldata$inhib_text_new),
#              addEllipses = TRUE)</code></pre>
<pre class="r"><code># pca_data_HBL1
fig_PC12 &lt;- ggplot(pca_data_HBL1) + 
  # geom_point(aes(x = PC1, y = PC2, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  geom_point(aes(x = PC1, y = PC2, shape = stimulus, color = inhib_text_new), size = 3, alpha = 0.8) + 
  # facet_wrap(~stimulus, ncol = 1) +
  # facet_grid(cell_line~inhibitor) +
  # scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  scale_color_manual(values = c(&quot;DMSO ctrl&quot; = &quot;grey&quot;, &quot;100 uM iSYK&quot; = &quot;green&quot;, &quot;100 uM iBTK&quot; = &quot;blue&quot;, &quot;100 uM iNFkB&quot; = &quot;red&quot;)) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_HBL1[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, expl_var_HBL1[2], &quot;% variance&quot;)) + 
  ggtitle(&quot;Normalised counts\nPC1 vs PC2 (HBL1 only)&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC12
fig_PC13 &lt;- ggplot(pca_data_HBL1) + 
  geom_point(aes(x = PC1, y = PC3, shape = stimulus, color = inhib_text_new), size = 3, alpha = 0.8) + 
  # facet_grid(cell_line~inhibitor) +
  # scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  scale_color_manual(values = c(&quot;DMSO ctrl&quot; = &quot;grey&quot;, &quot;100 uM iSYK&quot; = &quot;green&quot;, &quot;100 uM iBTK&quot; = &quot;blue&quot;, &quot;100 uM iNFkB&quot; = &quot;red&quot;)) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_HBL1[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_HBL1[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC3&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC13
fig_PC23 &lt;- ggplot(pca_data_HBL1) + 
  geom_point(aes(x = PC2, y = PC3, shape = stimulus, color = inhib_text_new), size = 3, alpha = 0.8) + 
  # facet_grid(cell_line~inhibitor) +
  # scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  scale_color_manual(values = c(&quot;DMSO ctrl&quot; = &quot;grey&quot;, &quot;100 uM iSYK&quot; = &quot;green&quot;, &quot;100 uM iBTK&quot; = &quot;blue&quot;, &quot;100 uM iNFkB&quot; = &quot;red&quot;)) +
  xlab(paste0(&quot;PC2: &quot;, expl_var_HBL1[2], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_HBL1[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC2 vs PC3&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC23

fig &lt;- plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3, align = &quot;h&quot;, rel_widths = c(1, 1, 1.5))
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_HBL1s-1.png" width="1536" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_HBL1s-1">
Past versions of Facto_2D_HBL1s-1.png
</button>
</p>
<div id="fig-Facto_2D_HBL1s-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># 3D scatter plot of PC1-3
# stimulus
fig &lt;- plot_ly(pca_data_HBL1, x = ~PC1, y = ~PC2, z = ~PC3, color = ~stimulus, colors = colors_stim) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_HBL1[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-cadd02f08840b0ac0262" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-cadd02f08840b0ac0262">{"x":{"visdat":{"a60578a2fd9":["function () ","plotlyVisDat"]},"cur_data":"a60578a2fd9","attrs":{"a60578a2fd9":{"x":{},"y":{},"z":{},"color":{},"colors":["#525252","#fdae6b"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 93.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-2000.5148336547136,-1864.1513387901844,-1617.2954246126346,-1647.1341684502183,-1534.0926464625838,-1507.694636740415,-1604.3150809386987,-1455.7705580649731,-1535.1475913964509,-1792.4336338054793,-1754.3643943503553,-1705.9907185948489,-1739.650728694452,-1662.4638119600629,-1731.1361736765562,-2396.7258996852206,-2333.151838456849,-2258.7027480185784],"y":[-1380.6494884834581,-1079.1260147297239,-4.3699239595254165,-332.47280713317497,374.18178502089796,607.75053159719243,283.91270311383352,565.49532062849153,383.64676326427025,538.04299919766413,308.64867686876829,310.80904779373094,882.33339965398045,1076.3020291288551,782.0566305722482,-1905.1274114741229,-1562.8726438565043,-1308.1122832287742],"z":[-773.4713889839411,-692.78755103810875,-1248.8228290963755,-1196.6791788468702,-947.84811864733956,-830.00038381842535,-1200.9441447285008,-816.47619604944828,-902.64991173231556,-166.64997942846267,-405.19901859094966,-410.01921091681908,394.90348810791778,337.63855528069956,50.540633005546283,746.18059017909115,776.56469222573458,895.91869057933411],"type":"scatter3d","mode":"markers","name":"PBS","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[3729.442393749132,3498.0042063525757,3186.587512503309,3332.9932028255844,4955.6196508137782,5043.3947010806241,4327.161043224196,5027.9647198199254,4879.8258597261711,426.62805851686591,405.3163530218136,312.66246179234582,-791.20757841334785,-931.62212659385375,-772.22890764245051,-1410.0842033405581,-1586.5699516799407,-1493.1511694028559],"y":[-55.907297209782499,-340.31992135024223,-491.25607245692169,-908.4328533287395,155.90851423042838,139.95063889178226,-555.29686652716452,-134.12094997730961,-132.72524008081143,925.50438667536093,741.41481126551321,788.36107791123698,1292.7734026266437,1592.217067322787,1437.8487617625287,-1012.5125050850744,-1072.0368449161344,-911.81942372867422],"z":[72.226473207391564,-129.59788461104796,-496.40734804109024,-460.93344954718441,-40.981842644606935,102.48975909758602,-366.33511240594163,184.90989831207602,156.33056178342702,691.94795944002385,563.63921966037162,568.68716501600545,812.64422300639228,896.29065250327687,891.35145323017093,767.6025883342918,1160.0386543529278,1015.8982918051444],"type":"scatter3d","mode":"markers","name":"aIg+H2O2","marker":{"color":"rgba(253,174,107,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(253,174,107,1)"}},"textfont":{"color":"rgba(253,174,107,1)","size":55},"error_y":{"color":"rgba(253,174,107,1)","width":55},"error_x":{"color":"rgba(253,174,107,1)","width":55},"line":{"color":"rgba(253,174,107,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># inhibitor
fig &lt;- plot_ly(pca_data_HBL1, x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_text_new, colors = c(&quot;DMSO ctrl&quot; = &quot;grey&quot;, &quot;100 uM iSYK&quot; = &quot;green&quot;, &quot;100 uM iBTK&quot; = &quot;blue&quot;, &quot;100 uM iNFkB&quot; = &quot;red&quot;)) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_HBL1[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-9fe6c25dfb1532926562" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-9fe6c25dfb1532926562">{"x":{"visdat":{"a605df65133":["function () ","plotlyVisDat"]},"cur_data":"a605df65133","attrs":{"a605df65133":{"x":{},"y":{},"z":{},"color":{},"colors":["grey","green","blue","red"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 93.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-1739.650728694452,-1662.4638119600629,-1731.1361736765562,-791.20757841334785,-931.62212659385375,-772.22890764245051],"y":[882.33339965398045,1076.3020291288551,782.0566305722482,1292.7734026266437,1592.217067322787,1437.8487617625287],"z":[394.90348810791778,337.63855528069956,50.540633005546283,812.64422300639228,896.29065250327687,891.35145323017093],"type":"scatter3d","mode":"markers","name":"100 uM iBTK","marker":{"color":"rgba(0,0,255,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,0,255,1)"}},"textfont":{"color":"rgba(0,0,255,1)","size":55},"error_y":{"color":"rgba(0,0,255,1)","width":55},"error_x":{"color":"rgba(0,0,255,1)","width":55},"line":{"color":"rgba(0,0,255,1)","width":55},"frame":null},{"x":[-2396.7258996852206,-2333.151838456849,-2258.7027480185784,-1410.0842033405581,-1586.5699516799407,-1493.1511694028559],"y":[-1905.1274114741229,-1562.8726438565043,-1308.1122832287742,-1012.5125050850744,-1072.0368449161344,-911.81942372867422],"z":[746.18059017909115,776.56469222573458,895.91869057933411,767.6025883342918,1160.0386543529278,1015.8982918051444],"type":"scatter3d","mode":"markers","name":"100 uM iNFkB","marker":{"color":"rgba(255,0,0,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)","size":55},"error_y":{"color":"rgba(255,0,0,1)","width":55},"error_x":{"color":"rgba(255,0,0,1)","width":55},"line":{"color":"rgba(255,0,0,1)","width":55},"frame":null},{"x":[-1792.4336338054793,-1754.3643943503553,-1705.9907185948489,426.62805851686591,405.3163530218136,312.66246179234582],"y":[538.04299919766413,308.64867686876829,310.80904779373094,925.50438667536093,741.41481126551321,788.36107791123698],"z":[-166.64997942846267,-405.19901859094966,-410.01921091681908,691.94795944002385,563.63921966037162,568.68716501600545],"type":"scatter3d","mode":"markers","name":"100 uM iSYK","marker":{"color":"rgba(0,255,0,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,255,0,1)"}},"textfont":{"color":"rgba(0,255,0,1)","size":55},"error_y":{"color":"rgba(0,255,0,1)","width":55},"error_x":{"color":"rgba(0,255,0,1)","width":55},"line":{"color":"rgba(0,255,0,1)","width":55},"frame":null},{"x":[-2000.5148336547136,-1864.1513387901844,-1617.2954246126346,-1647.1341684502183,-1534.0926464625838,-1507.694636740415,-1604.3150809386987,-1455.7705580649731,-1535.1475913964509,3729.442393749132,3498.0042063525757,3186.587512503309,3332.9932028255844,4955.6196508137782,5043.3947010806241,4327.161043224196,5027.9647198199254,4879.8258597261711],"y":[-1380.6494884834581,-1079.1260147297239,-4.3699239595254165,-332.47280713317497,374.18178502089796,607.75053159719243,283.91270311383352,565.49532062849153,383.64676326427025,-55.907297209782499,-340.31992135024223,-491.25607245692169,-908.4328533287395,155.90851423042838,139.95063889178226,-555.29686652716452,-134.12094997730961,-132.72524008081143],"z":[-773.4713889839411,-692.78755103810875,-1248.8228290963755,-1196.6791788468702,-947.84811864733956,-830.00038381842535,-1200.9441447285008,-816.47619604944828,-902.64991173231556,72.226473207391564,-129.59788461104796,-496.40734804109024,-460.93344954718441,-40.981842644606935,102.48975909758602,-366.33511240594163,184.90989831207602,156.33056178342702],"type":"scatter3d","mode":"markers","name":"DMSO ctrl","marker":{"color":"rgba(190,190,190,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(190,190,190,1)"}},"textfont":{"color":"rgba(190,190,190,1)","size":55},"error_y":{"color":"rgba(190,190,190,1)","width":55},"error_x":{"color":"rgba(190,190,190,1)","width":55},"line":{"color":"rgba(190,190,190,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># inhib_conc
fig &lt;- plot_ly(arrange(pca_data_HBL1, inhibitor), x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_conc, colors = colors_blue9[c(2, 3, 5, 7, 9)]) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_HBL1[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-3c0186160668e87e0529" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-3c0186160668e87e0529">{"x":{"visdat":{"a6056ad60dd":["function () ","plotlyVisDat"]},"cur_data":"a6056ad60dd","attrs":{"a6056ad60dd":{"x":{},"y":{},"z":{},"color":{},"colors":["#deebf7","#c6dbef","#6baed6","#2171b5","#08306b"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 93.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-2000.5148336547136,-1864.1513387901844,-1617.2954246126346,3729.442393749132,3498.0042063525757,3186.587512503309,-1647.1341684502183,-1534.0926464625838,-1507.694636740415,3332.9932028255844,4955.6196508137782,5043.3947010806241,-1604.3150809386987,-1455.7705580649731,-1535.1475913964509,4327.161043224196,5027.9647198199254,4879.8258597261711],"y":[-1380.6494884834581,-1079.1260147297239,-4.3699239595254165,-55.907297209782499,-340.31992135024223,-491.25607245692169,-332.47280713317497,374.18178502089796,607.75053159719243,-908.4328533287395,155.90851423042838,139.95063889178226,283.91270311383352,565.49532062849153,383.64676326427025,-555.29686652716452,-134.12094997730961,-132.72524008081143],"z":[-773.4713889839411,-692.78755103810875,-1248.8228290963755,72.226473207391564,-129.59788461104796,-496.40734804109024,-1196.6791788468702,-947.84811864733956,-830.00038381842535,-460.93344954718441,-40.981842644606935,102.48975909758602,-1200.9441447285008,-816.47619604944828,-902.64991173231556,-366.33511240594163,184.90989831207602,156.33056178342702],"type":"scatter3d","mode":"markers","name":"0 uM (DMSO)","marker":{"color":"rgba(170,204,231,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(170,204,231,1)"}},"textfont":{"color":"rgba(170,204,231,1)","size":55},"error_y":{"color":"rgba(170,204,231,1)","width":55},"error_x":{"color":"rgba(170,204,231,1)","width":55},"line":{"color":"rgba(170,204,231,1)","width":55},"frame":null},{"x":[-1792.4336338054793,-1754.3643943503553,-1705.9907185948489,426.62805851686591,405.3163530218136,312.66246179234582,-1739.650728694452,-1662.4638119600629,-1731.1361736765562,-791.20757841334785,-931.62212659385375,-772.22890764245051,-2396.7258996852206,-2333.151838456849,-2258.7027480185784,-1410.0842033405581,-1586.5699516799407,-1493.1511694028559],"y":[538.04299919766413,308.64867686876829,310.80904779373094,925.50438667536093,741.41481126551321,788.36107791123698,882.33339965398045,1076.3020291288551,782.0566305722482,1292.7734026266437,1592.217067322787,1437.8487617625287,-1905.1274114741229,-1562.8726438565043,-1308.1122832287742,-1012.5125050850744,-1072.0368449161344,-911.81942372867422],"z":[-166.64997942846267,-405.19901859094966,-410.01921091681908,691.94795944002385,563.63921966037162,568.68716501600545,394.90348810791778,337.63855528069956,50.540633005546283,812.64422300639228,896.29065250327687,891.35145323017093,746.18059017909115,776.56469222573458,895.91869057933411,767.6025883342918,1160.0386543529278,1015.8982918051444],"type":"scatter3d","mode":"markers","name":"100 uM","marker":{"color":"rgba(8,48,107,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(8,48,107,1)"}},"textfont":{"color":"rgba(8,48,107,1)","size":55},"error_y":{"color":"rgba(8,48,107,1)","width":55},"error_x":{"color":"rgba(8,48,107,1)","width":55},"line":{"color":"rgba(8,48,107,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># inhib_conc_text
fig &lt;- plot_ly(arrange(pca_data_HBL1, inhibitor), x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_conc_text, colors = colors_inhib_conc) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_HBL1[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-ef0d970a2618a4f9bd83" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-ef0d970a2618a4f9bd83">{"x":{"visdat":{"a609e131cd":["function () ","plotlyVisDat"]},"cur_data":"a609e131cd","attrs":{"a609e131cd":{"x":{},"y":{},"z":{},"color":{},"colors":["#e5f5e0","#c7e9c0","#74c476","#238b45","#00441b","#efedf5","#dadaeb","#9e9ac8","#6a51a3","#3f007d","#fee6ce","#fdd0a2","#fd8d3c","#d94801","#7f2704"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 93.4","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-1647.1341684502183,-1534.0926464625838,-1507.694636740415,3332.9932028255844,4955.6196508137782,5043.3947010806241],"y":[-332.47280713317497,374.18178502089796,607.75053159719243,-908.4328533287395,155.90851423042838,139.95063889178226],"z":[-1196.6791788468702,-947.84811864733956,-830.00038381842535,-460.93344954718441,-40.981842644606935,102.48975909758602],"type":"scatter3d","mode":"markers","name":"0 uM iBTK (DMSO)","marker":{"color":"rgba(239,237,245,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(239,237,245,1)"}},"textfont":{"color":"rgba(239,237,245,1)","size":55},"error_y":{"color":"rgba(239,237,245,1)","width":55},"error_x":{"color":"rgba(239,237,245,1)","width":55},"line":{"color":"rgba(239,237,245,1)","width":55},"frame":null},{"x":[-1604.3150809386987,-1455.7705580649731,-1535.1475913964509,4327.161043224196,5027.9647198199254,4879.8258597261711],"y":[283.91270311383352,565.49532062849153,383.64676326427025,-555.29686652716452,-134.12094997730961,-132.72524008081143],"z":[-1200.9441447285008,-816.47619604944828,-902.64991173231556,-366.33511240594163,184.90989831207602,156.33056178342702],"type":"scatter3d","mode":"markers","name":"0 uM iNFkB (DMSO)","marker":{"color":"rgba(254,230,206,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(254,230,206,1)"}},"textfont":{"color":"rgba(254,230,206,1)","size":55},"error_y":{"color":"rgba(254,230,206,1)","width":55},"error_x":{"color":"rgba(254,230,206,1)","width":55},"line":{"color":"rgba(254,230,206,1)","width":55},"frame":null},{"x":[-2000.5148336547136,-1864.1513387901844,-1617.2954246126346,3729.442393749132,3498.0042063525757,3186.587512503309],"y":[-1380.6494884834581,-1079.1260147297239,-4.3699239595254165,-55.907297209782499,-340.31992135024223,-491.25607245692169],"z":[-773.4713889839411,-692.78755103810875,-1248.8228290963755,72.226473207391564,-129.59788461104796,-496.40734804109024],"type":"scatter3d","mode":"markers","name":"0 uM iSYK (DMSO)","marker":{"color":"rgba(229,245,224,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(229,245,224,1)"}},"textfont":{"color":"rgba(229,245,224,1)","size":55},"error_y":{"color":"rgba(229,245,224,1)","width":55},"error_x":{"color":"rgba(229,245,224,1)","width":55},"line":{"color":"rgba(229,245,224,1)","width":55},"frame":null},{"x":[-1739.650728694452,-1662.4638119600629,-1731.1361736765562,-791.20757841334785,-931.62212659385375,-772.22890764245051],"y":[882.33339965398045,1076.3020291288551,782.0566305722482,1292.7734026266437,1592.217067322787,1437.8487617625287],"z":[394.90348810791778,337.63855528069956,50.540633005546283,812.64422300639228,896.29065250327687,891.35145323017093],"type":"scatter3d","mode":"markers","name":"100 uM iBTK","marker":{"color":"rgba(63,0,125,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(63,0,125,1)"}},"textfont":{"color":"rgba(63,0,125,1)","size":55},"error_y":{"color":"rgba(63,0,125,1)","width":55},"error_x":{"color":"rgba(63,0,125,1)","width":55},"line":{"color":"rgba(63,0,125,1)","width":55},"frame":null},{"x":[-2396.7258996852206,-2333.151838456849,-2258.7027480185784,-1410.0842033405581,-1586.5699516799407,-1493.1511694028559],"y":[-1905.1274114741229,-1562.8726438565043,-1308.1122832287742,-1012.5125050850744,-1072.0368449161344,-911.81942372867422],"z":[746.18059017909115,776.56469222573458,895.91869057933411,767.6025883342918,1160.0386543529278,1015.8982918051444],"type":"scatter3d","mode":"markers","name":"100 uM iNFkB","marker":{"color":"rgba(127,39,4,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(127,39,4,1)"}},"textfont":{"color":"rgba(127,39,4,1)","size":55},"error_y":{"color":"rgba(127,39,4,1)","width":55},"error_x":{"color":"rgba(127,39,4,1)","width":55},"line":{"color":"rgba(127,39,4,1)","width":55},"frame":null},{"x":[-1792.4336338054793,-1754.3643943503553,-1705.9907185948489,426.62805851686591,405.3163530218136,312.66246179234582],"y":[538.04299919766413,308.64867686876829,310.80904779373094,925.50438667536093,741.41481126551321,788.36107791123698],"z":[-166.64997942846267,-405.19901859094966,-410.01921091681908,691.94795944002385,563.63921966037162,568.68716501600545],"type":"scatter3d","mode":"markers","name":"100 uM iSYK","marker":{"color":"rgba(0,68,27,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,68,27,1)"}},"textfont":{"color":"rgba(0,68,27,1)","size":55},"error_y":{"color":"rgba(0,68,27,1)","width":55},"error_x":{"color":"rgba(0,68,27,1)","width":55},"line":{"color":"rgba(0,68,27,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div id="umap-visualisation-2" class="section level4">
<h4>UMAP visualisation</h4>
<pre class="r"><code># Data
pca_data_5PC &lt;- as.data.frame(indiv_HBL1$coord[, 1:5]) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC53 = Dim.5) %&gt;% 
  left_join(coldata)

# UMAP data reduction
umap_pca &lt;- umap::umap(as.data.frame(indiv_HBL1$coord[, 1:5]))
# umap.defaults
# head(umap_pca$layout)
umap_pca_ann &lt;- as.data.frame(umap_pca$layout) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(UMAP1 = V1, UMAP2 = V2) %&gt;% 
  left_join(coldata)

# Basic fig of everything
fig &lt;- ggplot(umap_pca_ann, aes(x = UMAP1, y = UMAP2)) + 
  geom_point(aes(shape = stimulus, color = inhib_text_new), size = 2) + 
  scale_color_manual(values = c(&quot;DMSO ctrl&quot; = &quot;grey&quot;, &quot;100 uM iSYK&quot; = &quot;green&quot;, &quot;100 uM iBTK&quot; = &quot;blue&quot;, &quot;100 uM iNFkB&quot; = &quot;red&quot;)) +
  ggtitle(&quot;Normalised counts\nUMAP with PC1-5&quot;) +
  theme_bw() +
  textsize_small
fig</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_UMAP_PCAs-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_UMAP_PCAs-1">
Past versions of Facto_UMAP_PCAs-1.png
</button>
</p>
<div id="fig-Facto_UMAP_PCAs-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="oci-ly8-samples" class="section level3">
<h3>OCI-Ly8 samples</h3>
<p>PCA with only the OCI-Ly8 samples</p>
<pre class="r"><code># Prepare data for FactoMineR package
# cts: dataframe with wells as row names, proteins as column names, and count data as cell values
# coldata: dataframe with wells as row names and all metadata as columns
cts &lt;- data_well_all  %&gt;%
  filter(counts &gt;= 1 &amp; cell_line == &quot;OCI-Ly8&quot;) %&gt;%
  dplyr::select(target_nospace, plate_well, counts) %&gt;%
  filter(!is.na(counts)) %&gt;%
  spread(target_nospace, counts) %&gt;%
  replace(is.na(.), 0)

cts &lt;- column_to_rownames(cts, &quot;plate_well&quot;)
# cts2 &lt;- as.matrix(as.data.frame(cts), row_names = TRUE)

coldata &lt;- data.frame(plate_well = rownames(cts)) %&gt;%
  left_join(distinct(dplyr::select(data_well_all, all_of(meta_cols)))) %&gt;%
  mutate(stimulus = factor(stimulus, levels = stim_DS108), 
         cell_line = factor(cell_line, levels = cells_DS108), 
         inhibitor = factor(inhibitor, levels = inhib_DS108), 
         inhib_conc = factor(inhib_conc, levels = inhib_conc_DS108)) #If necessary, make factors of some metadata columns

rownames(coldata) &lt;- coldata$plate_well</code></pre>
<pre class="r"><code># Results
results_Ly8 &lt;- PCA(cts, scale.unit = FALSE, ncp = 5, graph = FALSE)

# Percentage variance explained by each PC
expl_var_Ly8 &lt;- as.data.frame(get_eigenvalue(results_Ly8)) %&gt;%
  rownames_to_column(&quot;PC&quot;) %&gt;%
  pull(var = variance.percent, name = PC) %&gt;%
  round(digits = 1)

# Results focused on variables (proteins)
variab_Ly8 &lt;- get_pca_var(results_Ly8) 
# head(variab$contrib)

# Results focused on individuals (wells)
indiv_Ly8 &lt;- get_pca_ind(results_Ly8) 
# head(indiv$contrib)
pca_data_Ly8 &lt;- as.data.frame(indiv_Ly8$coord[, 1:3]) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3) %&gt;% 
  left_join(coldata)</code></pre>
<pre class="r"><code># Variance explained by each PC (eigenvalues)
fviz_eig(results_Ly8, addlabels = TRUE)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_Ly8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_Ly8-1">
Past versions of Facto_vis_Ly8-1.png
</button>
</p>
<div id="fig-Facto_vis_Ly8-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_var(results_Ly8, col.var = &quot;black&quot;)

# Quality of representation for variables
# corrplot(variab_Ly8$cos2, is.corr = FALSE)
# corrplot(variab_Ly8$contrib, is.corr = FALSE)

contrib_2.5p &lt;- as.data.frame(variab_Ly8$contrib) %&gt;%
  # rownames_to_column(&quot;target_nospace&quot;) %&gt;%
  filter(Dim.1 &gt;= 2.5 | Dim.2 &gt;= 2.5 | Dim.3 &gt;= 2.5) %&gt;% # | Dim.4 &gt;= 1 | Dim.5 &gt;= 1
  dplyr::rename(PC1 = Dim.1, PC2 =  Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC5 = Dim.5) %&gt;%
  dplyr::select(c(PC1, PC2, PC3)) %&gt;%
  as.matrix()
  # filter_all(any_vars(.&gt;1))
corrplot(contrib_2.5p, is.corr = FALSE, method = &quot;circle&quot;, outline = TRUE, 
         tl.col = &quot;black&quot;, cl.ratio = 0.75, cl.offset = 1, 
         title = &quot;Protein contributions to PC (&gt;2.5% in any PC)(OCI-Ly8 only)&quot;)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_Ly8-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_Ly8-2">
Past versions of Facto_vis_Ly8-2.png
</button>
</p>
<div id="fig-Facto_vis_Ly8-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Top10 contributing proteins to PC1-3 
fig_PC1 &lt;- fviz_contrib(results_Ly8, choice = &quot;var&quot;, axes = 1, top = 10)
fig_PC2 &lt;- fviz_contrib(results_Ly8, choice = &quot;var&quot;, axes = 2, top = 10)
fig_PC3 &lt;- fviz_contrib(results_Ly8, choice = &quot;var&quot;, axes = 3, top = 10)
plot_grid(fig_PC1, fig_PC2, fig_PC3, ncol = 3)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_Ly8-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_Ly8-3">
Past versions of Facto_vis_Ly8-3.png
</button>
</p>
<div id="fig-Facto_vis_Ly8-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_ind(results_Ly8,
#              axes = c(1, 2),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus), 
#              addEllipses = TRUE)
# fviz_pca_ind(results_Ly8,
#              axes = c(1, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus), 
#              addEllipses = TRUE)
# fviz_pca_ind(results_Ly8,
#              axes = c(2, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus), 
#              addEllipses = TRUE)
# plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3)</code></pre>
<pre class="r"><code># pca_data_Ly8
fig_PC12 &lt;- ggplot(pca_data_Ly8) + 
  geom_point(aes(x = PC1, y = PC2, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, expl_var_all[2], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC2 (OCI-Ly8 only)&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC12
fig_PC13 &lt;- ggplot(pca_data_Ly8) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC3&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC13
fig_PC23 &lt;- ggplot(pca_data_Ly8) + 
  geom_point(aes(x = PC2, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC2: &quot;, expl_var_all[2], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC2 vs PC3&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC23

fig &lt;- plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3, align = &quot;h&quot;, rel_widths = c(1, 1, 1.5))
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_Ly8-1.png" width="1536" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_Ly8-1">
Past versions of Facto_2D_Ly8-1.png
</button>
</p>
<div id="fig-Facto_2D_Ly8-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># 3D scatter plot of PC1-3
# stimulus
fig &lt;- plot_ly(pca_data_Ly8, x = ~PC1, y = ~PC2, z = ~PC3, color = ~stimulus, colors = colors_stim) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_Ly8[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-551fe4e4dd61a1a9e4c6" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-551fe4e4dd61a1a9e4c6">{"x":{"visdat":{"a6060826d18":["function () ","plotlyVisDat"]},"cur_data":"a6060826d18","attrs":{"a6060826d18":{"x":{},"y":{},"z":{},"color":{},"colors":["#525252","#fdae6b"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 98.6","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[4757.5861001181256,8415.9956302832979,-8938.3277354561724,-5704.2626492743721,6394.1726764571322,6103.8345123667905,-1174.2764673565423,7231.3593900563355,8985.7044841720744,1055.7013783772952,8029.0273349113577,-12.338395162221968,974.70566635575847,12403.918459436056,6574.4970651219701,-1090.6759935611562,2612.2739523906321,5423.0251725931639,4489.7883840716904,-5252.8739720310186,-2139.773040194335,1863.6948828289198,3666.2040527118843,3326.329456161031,-2320.0801555995049,249.13267643774248,4852.2660462079075,-2119.3346150759871,-4112.2173566567817,-463.70659875401304,293.49129004119283,-3730.6713377074479,3667.8533252502762,-12617.353569657573,-5763.3636237091778,-3970.7099158034234,-3353.5890736480142,-623.0725465143031,3031.1155340212426,-1085.6866656742973,-702.62744398306768,-2845.2842912195915,-11252.923444191523,-8536.429900043031,-4762.2533157447024],"y":[-566.06819617855717,-720.62902745140866,313.65130265189293,11.483998273860342,-281.96864028654585,-554.38768449845747,65.669098642238126,-579.14755977719949,-457.0236086518442,-367.85022931077634,-877.22738590631434,-360.03863194199272,-404.53647269539891,-801.01580929473062,-300.0454646315784,-240.8904015137777,-159.13358847378379,-220.74481023835577,-1204.1717740374954,-371.31175856455195,-555.98585924556653,-497.84209484683026,-308.05366810372522,-454.47215506776149,19.887898154775492,-27.329394840538324,-10.383169788481739,-757.30277852788413,-490.65551326541407,-714.17102845359739,-738.41711898621679,-413.59251062889416,-788.0325778805485,460.43161461198605,277.95836081412182,235.95444950892539,-686.17854971831594,-918.40468947486886,-1335.5180979770093,-670.90268493353915,-628.11161869438581,-633.89819947779074,-312.46463342229293,-623.34324186749848,-837.6188660583922],"z":[-412.36971112412425,-485.95005349626911,-614.25485367156148,-660.82625892812882,-817.33761262703183,-694.10149169506769,-768.3056825368991,-544.52802911613765,-649.3241661982496,-359.32561657119618,-436.44625190151817,-395.88058152270895,-451.9301661443825,-644.01933502594704,-545.55775226703668,-455.58105000403293,-558.9931434206444,-767.35289732537956,283.680439033352,87.397835926377965,121.8927759683226,-294.68589365946212,-349.07057492885338,-418.47116064609349,-577.04732112908732,-841.34685932287709,-784.01945361910998,263.27164560212913,208.91627994812191,376.67448760672733,281.70547907554891,68.545527138321106,210.42750801428645,-640.78712301232213,-679.56721764309236,-577.84204811419988,479.26064207285293,402.26020926991185,734.1902640128344,217.63745845832472,384.56319027542162,213.74869238588732,-47.215337570982037,202.36520903593481,425.1050154244241],"type":"scatter3d","mode":"markers","name":"PBS","marker":{"color":"rgba(82,82,82,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(82,82,82,1)"}},"textfont":{"color":"rgba(82,82,82,1)","size":55},"error_y":{"color":"rgba(82,82,82,1)","width":55},"error_x":{"color":"rgba(82,82,82,1)","width":55},"line":{"color":"rgba(82,82,82,1)","width":55},"frame":null},{"x":[13660.518632329329,12074.283749898737,-5949.9109667359871,-3998.901781042834,7601.9961727588225,-1056.9883591547075,3477.0030646713853,6716.8275720185584,8399.5001910034916,2446.2128756663169,3400.431761562374,778.76914004492176,-842.10771679632307,7550.4978272597255,5940.6896859589351,157.15679563481712,2983.1145196132711,3110.1417072040431,10097.551606533849,-2122.1001584743599,596.08675033833379,540.27668600991478,4907.7534485514743,-1885.1279717945304,-1771.2161734530071,-828.29642820936783,5074.4266019653533,6452.0428972644731,-4375.407943892269,-48.326158453613942,-871.89590607029163,-6617.8546954099602,-722.87945548241362,-11409.314379102349,-5857.0903848159078,-5261.4357066866733,-2021.9415903539873,-4732.1995258525494,-7883.4966761364813,-8107.7420565964549,-3353.4873220577206,-9582.7254945180121,-13271.241848336947,-8579.3470578487741,-6644.09129236631],"y":[727.24958900634431,875.9944517427565,865.551916824709,817.83938111670795,1147.0624861287831,1039.4727233265535,1055.7006593017227,1347.2290799918844,1532.724216154427,315.92886325687863,242.89017839289528,587.86285462667865,977.53091625151001,1153.7223131268552,982.26856851245691,758.4761305736406,772.6475688689427,371.886987528254,-676.67379653698708,69.727938080278136,30.428783560737514,863.80395247634658,770.91335109639306,1235.796530941745,632.49709612116396,727.70442560497872,322.20788867285466,-1017.8441097924805,-66.413927567259606,-211.88317659682554,211.52772482771385,314.7363326143219,514.2656506313607,601.54450156263442,584.97453282314109,486.10712375883668,-540.73622483381234,-177.93187781240084,-102.31237222705026,32.94452263012338,-158.96443304692124,161.07639813339568,170.52062192245523,-411.79925738319963,-454.42431233895235],"z":[624.68064900577065,620.50460426996858,-183.72515959897123,-92.73136445098767,283.03983969981527,174.86336327570939,98.784452889445944,470.62978157695858,557.88381308513374,19.968319463757979,269.66875239618179,64.128987204032157,-27.577105001683101,266.18475246502487,96.576979734841956,-163.48610995302084,58.465025972159488,41.528853868438212,801.80959826031346,323.8448304805172,443.61304396840922,17.970212624426633,353.01750648428191,-20.490867231051407,-181.91189720344897,-290.78015120659154,103.97859995309366,967.95122282089665,385.46593652718144,481.41722514792701,469.89282830775073,158.99757116167885,597.98104357628608,-334.13350447548248,-294.06988356979826,-129.43574266550769,672.27709951134011,555.88749785865673,327.75911401410423,315.97443969588033,627.61038477165107,292.42965372124524,-38.315739094268956,240.37197865584221,481.99454597567495],"type":"scatter3d","mode":"markers","name":"aIg+H2O2","marker":{"color":"rgba(253,174,107,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(253,174,107,1)"}},"textfont":{"color":"rgba(253,174,107,1)","size":55},"error_y":{"color":"rgba(253,174,107,1)","width":55},"error_x":{"color":"rgba(253,174,107,1)","width":55},"line":{"color":"rgba(253,174,107,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># # inhibitor
# fig &lt;- plot_ly(pca_data_Ly8, x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhibitor, colors = colors_inhib) %&gt;%
#   add_markers(size = 12) %&gt;%
#   layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_Ly8[1:3])))
# fig

# inhib_conc
fig &lt;- plot_ly(arrange(pca_data_Ly8, inhibitor), x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_conc, colors = colors_blue9[c(2, 3, 5, 7, 9)]) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_Ly8[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-bbdbb69b813ce1e5b742" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-bbdbb69b813ce1e5b742">{"x":{"visdat":{"a60190955d0":["function () ","plotlyVisDat"]},"cur_data":"a60190955d0","attrs":{"a60190955d0":{"x":{},"y":{},"z":{},"color":{},"colors":["#deebf7","#c6dbef","#6baed6","#2171b5","#08306b"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 98.6","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[4757.5861001181256,8415.9956302832979,-8938.3277354561724,13660.518632329329,12074.283749898737,-5949.9109667359871,-5704.2626492743721,6394.1726764571322,6103.8345123667905,-3998.901781042834,7601.9961727588225,-1056.9883591547075,-1174.2764673565423,7231.3593900563355,8985.7044841720744,3477.0030646713853,6716.8275720185584,8399.5001910034916],"y":[-566.06819617855717,-720.62902745140866,313.65130265189293,727.24958900634431,875.9944517427565,865.551916824709,11.483998273860342,-281.96864028654585,-554.38768449845747,817.83938111670795,1147.0624861287831,1039.4727233265535,65.669098642238126,-579.14755977719949,-457.0236086518442,1055.7006593017227,1347.2290799918844,1532.724216154427],"z":[-412.36971112412425,-485.95005349626911,-614.25485367156148,624.68064900577065,620.50460426996858,-183.72515959897123,-660.82625892812882,-817.33761262703183,-694.10149169506769,-92.73136445098767,283.03983969981527,174.86336327570939,-768.3056825368991,-544.52802911613765,-649.3241661982496,98.784452889445944,470.62978157695858,557.88381308513374],"type":"scatter3d","mode":"markers","name":"0 uM (DMSO)","marker":{"color":"rgba(170,204,231,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(170,204,231,1)"}},"textfont":{"color":"rgba(170,204,231,1)","size":55},"error_y":{"color":"rgba(170,204,231,1)","width":55},"error_x":{"color":"rgba(170,204,231,1)","width":55},"line":{"color":"rgba(170,204,231,1)","width":55},"frame":null},{"x":[1055.7013783772952,8029.0273349113577,-12.338395162221968,2446.2128756663169,3400.431761562374,778.76914004492176,974.70566635575847,12403.918459436056,6574.4970651219701,-842.10771679632307,7550.4978272597255,5940.6896859589351,-1090.6759935611562,2612.2739523906321,5423.0251725931639,157.15679563481712,2983.1145196132711,3110.1417072040431],"y":[-367.85022931077634,-877.22738590631434,-360.03863194199272,315.92886325687863,242.89017839289528,587.86285462667865,-404.53647269539891,-801.01580929473062,-300.0454646315784,977.53091625151001,1153.7223131268552,982.26856851245691,-240.8904015137777,-159.13358847378379,-220.74481023835577,758.4761305736406,772.6475688689427,371.886987528254],"z":[-359.32561657119618,-436.44625190151817,-395.88058152270895,19.968319463757979,269.66875239618179,64.128987204032157,-451.9301661443825,-644.01933502594704,-545.55775226703668,-27.577105001683101,266.18475246502487,96.576979734841956,-455.58105000403293,-558.9931434206444,-767.35289732537956,-163.48610995302084,58.465025972159488,41.528853868438212],"type":"scatter3d","mode":"markers","name":"0.1 uM","marker":{"color":"rgba(107,174,214,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(107,174,214,1)"}},"textfont":{"color":"rgba(107,174,214,1)","size":55},"error_y":{"color":"rgba(107,174,214,1)","width":55},"error_x":{"color":"rgba(107,174,214,1)","width":55},"line":{"color":"rgba(107,174,214,1)","width":55},"frame":null},{"x":[4489.7883840716904,-5252.8739720310186,-2139.773040194335,10097.551606533849,-2122.1001584743599,596.08675033833379,1863.6948828289198,3666.2040527118843,3326.329456161031,540.27668600991478,4907.7534485514743,-1885.1279717945304,-2320.0801555995049,249.13267643774248,4852.2660462079075,-1771.2161734530071,-828.29642820936783,5074.4266019653533],"y":[-1204.1717740374954,-371.31175856455195,-555.98585924556653,-676.67379653698708,69.727938080278136,30.428783560737514,-497.84209484683026,-308.05366810372522,-454.47215506776149,863.80395247634658,770.91335109639306,1235.796530941745,19.887898154775492,-27.329394840538324,-10.383169788481739,632.49709612116396,727.70442560497872,322.20788867285466],"z":[283.680439033352,87.397835926377965,121.8927759683226,801.80959826031346,323.8448304805172,443.61304396840922,-294.68589365946212,-349.07057492885338,-418.47116064609349,17.970212624426633,353.01750648428191,-20.490867231051407,-577.04732112908732,-841.34685932287709,-784.01945361910998,-181.91189720344897,-290.78015120659154,103.97859995309366],"type":"scatter3d","mode":"markers","name":"1 uM","marker":{"color":"rgba(64,133,192,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(64,133,192,1)"}},"textfont":{"color":"rgba(64,133,192,1)","size":55},"error_y":{"color":"rgba(64,133,192,1)","width":55},"error_x":{"color":"rgba(64,133,192,1)","width":55},"line":{"color":"rgba(64,133,192,1)","width":55},"frame":null},{"x":[-2119.3346150759871,-4112.2173566567817,-463.70659875401304,6452.0428972644731,-4375.407943892269,-48.326158453613942,293.49129004119283,-3730.6713377074479,3667.8533252502762,-871.89590607029163,-6617.8546954099602,-722.87945548241362,-12617.353569657573,-5763.3636237091778,-3970.7099158034234,-11409.314379102349,-5857.0903848159078,-5261.4357066866733],"y":[-757.30277852788413,-490.65551326541407,-714.17102845359739,-1017.8441097924805,-66.413927567259606,-211.88317659682554,-738.41711898621679,-413.59251062889416,-788.0325778805485,211.52772482771385,314.7363326143219,514.2656506313607,460.43161461198605,277.95836081412182,235.95444950892539,601.54450156263442,584.97453282314109,486.10712375883668],"z":[263.27164560212913,208.91627994812191,376.67448760672733,967.95122282089665,385.46593652718144,481.41722514792701,281.70547907554891,68.545527138321106,210.42750801428645,469.89282830775073,158.99757116167885,597.98104357628608,-640.78712301232213,-679.56721764309236,-577.84204811419988,-334.13350447548248,-294.06988356979826,-129.43574266550769],"type":"scatter3d","mode":"markers","name":"10 uM","marker":{"color":"rgba(26,90,156,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(26,90,156,1)"}},"textfont":{"color":"rgba(26,90,156,1)","size":55},"error_y":{"color":"rgba(26,90,156,1)","width":55},"error_x":{"color":"rgba(26,90,156,1)","width":55},"line":{"color":"rgba(26,90,156,1)","width":55},"frame":null},{"x":[-3353.5890736480142,-623.0725465143031,3031.1155340212426,-2021.9415903539873,-4732.1995258525494,-7883.4966761364813,-1085.6866656742973,-702.62744398306768,-2845.2842912195915,-8107.7420565964549,-3353.4873220577206,-9582.7254945180121,-11252.923444191523,-8536.429900043031,-4762.2533157447024,-13271.241848336947,-8579.3470578487741,-6644.09129236631],"y":[-686.17854971831594,-918.40468947486886,-1335.5180979770093,-540.73622483381234,-177.93187781240084,-102.31237222705026,-670.90268493353915,-628.11161869438581,-633.89819947779074,32.94452263012338,-158.96443304692124,161.07639813339568,-312.46463342229293,-623.34324186749848,-837.6188660583922,170.52062192245523,-411.79925738319963,-454.42431233895235],"z":[479.26064207285293,402.26020926991185,734.1902640128344,672.27709951134011,555.88749785865673,327.75911401410423,217.63745845832472,384.56319027542162,213.74869238588732,315.97443969588033,627.61038477165107,292.42965372124524,-47.215337570982037,202.36520903593481,425.1050154244241,-38.315739094268956,240.37197865584221,481.99454597567495],"type":"scatter3d","mode":"markers","name":"100 uM","marker":{"color":"rgba(8,48,107,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(8,48,107,1)"}},"textfont":{"color":"rgba(8,48,107,1)","size":55},"error_y":{"color":"rgba(8,48,107,1)","width":55},"error_x":{"color":"rgba(8,48,107,1)","width":55},"line":{"color":"rgba(8,48,107,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># inhib_conc_text
fig &lt;- plot_ly(arrange(pca_data_Ly8, inhibitor), x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhib_conc_text, colors = colors_inhib_conc) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, sum(expl_var_Ly8[1:3])))
fig</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-b5ee14d33c767efbafb3" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-b5ee14d33c767efbafb3">{"x":{"visdat":{"a607c985414":["function () ","plotlyVisDat"]},"cur_data":"a607c985414","attrs":{"a607c985414":{"x":{},"y":{},"z":{},"color":{},"colors":["#e5f5e0","#c7e9c0","#74c476","#238b45","#00441b","#efedf5","#dadaeb","#9e9ac8","#6a51a3","#3f007d","#fee6ce","#fdd0a2","#fd8d3c","#d94801","#7f2704"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variance explained: 98.6","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-5704.2626492743721,6394.1726764571322,6103.8345123667905,-3998.901781042834,7601.9961727588225,-1056.9883591547075],"y":[11.483998273860342,-281.96864028654585,-554.38768449845747,817.83938111670795,1147.0624861287831,1039.4727233265535],"z":[-660.82625892812882,-817.33761262703183,-694.10149169506769,-92.73136445098767,283.03983969981527,174.86336327570939],"type":"scatter3d","mode":"markers","name":"0 uM iBTK (DMSO)","marker":{"color":"rgba(239,237,245,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(239,237,245,1)"}},"textfont":{"color":"rgba(239,237,245,1)","size":55},"error_y":{"color":"rgba(239,237,245,1)","width":55},"error_x":{"color":"rgba(239,237,245,1)","width":55},"line":{"color":"rgba(239,237,245,1)","width":55},"frame":null},{"x":[-1174.2764673565423,7231.3593900563355,8985.7044841720744,3477.0030646713853,6716.8275720185584,8399.5001910034916],"y":[65.669098642238126,-579.14755977719949,-457.0236086518442,1055.7006593017227,1347.2290799918844,1532.724216154427],"z":[-768.3056825368991,-544.52802911613765,-649.3241661982496,98.784452889445944,470.62978157695858,557.88381308513374],"type":"scatter3d","mode":"markers","name":"0 uM iNFkB (DMSO)","marker":{"color":"rgba(254,230,206,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(254,230,206,1)"}},"textfont":{"color":"rgba(254,230,206,1)","size":55},"error_y":{"color":"rgba(254,230,206,1)","width":55},"error_x":{"color":"rgba(254,230,206,1)","width":55},"line":{"color":"rgba(254,230,206,1)","width":55},"frame":null},{"x":[4757.5861001181256,8415.9956302832979,-8938.3277354561724,13660.518632329329,12074.283749898737,-5949.9109667359871],"y":[-566.06819617855717,-720.62902745140866,313.65130265189293,727.24958900634431,875.9944517427565,865.551916824709],"z":[-412.36971112412425,-485.95005349626911,-614.25485367156148,624.68064900577065,620.50460426996858,-183.72515959897123],"type":"scatter3d","mode":"markers","name":"0 uM iSYK (DMSO)","marker":{"color":"rgba(229,245,224,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(229,245,224,1)"}},"textfont":{"color":"rgba(229,245,224,1)","size":55},"error_y":{"color":"rgba(229,245,224,1)","width":55},"error_x":{"color":"rgba(229,245,224,1)","width":55},"line":{"color":"rgba(229,245,224,1)","width":55},"frame":null},{"x":[974.70566635575847,12403.918459436056,6574.4970651219701,-842.10771679632307,7550.4978272597255,5940.6896859589351],"y":[-404.53647269539891,-801.01580929473062,-300.0454646315784,977.53091625151001,1153.7223131268552,982.26856851245691],"z":[-451.9301661443825,-644.01933502594704,-545.55775226703668,-27.577105001683101,266.18475246502487,96.576979734841956],"type":"scatter3d","mode":"markers","name":"0.1 uM iBTK","marker":{"color":"rgba(218,218,235,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(218,218,235,1)"}},"textfont":{"color":"rgba(218,218,235,1)","size":55},"error_y":{"color":"rgba(218,218,235,1)","width":55},"error_x":{"color":"rgba(218,218,235,1)","width":55},"line":{"color":"rgba(218,218,235,1)","width":55},"frame":null},{"x":[-1090.6759935611562,2612.2739523906321,5423.0251725931639,157.15679563481712,2983.1145196132711,3110.1417072040431],"y":[-240.8904015137777,-159.13358847378379,-220.74481023835577,758.4761305736406,772.6475688689427,371.886987528254],"z":[-455.58105000403293,-558.9931434206444,-767.35289732537956,-163.48610995302084,58.465025972159488,41.528853868438212],"type":"scatter3d","mode":"markers","name":"0.1 uM iNFkB","marker":{"color":"rgba(253,208,162,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(253,208,162,1)"}},"textfont":{"color":"rgba(253,208,162,1)","size":55},"error_y":{"color":"rgba(253,208,162,1)","width":55},"error_x":{"color":"rgba(253,208,162,1)","width":55},"line":{"color":"rgba(253,208,162,1)","width":55},"frame":null},{"x":[1055.7013783772952,8029.0273349113577,-12.338395162221968,2446.2128756663169,3400.431761562374,778.76914004492176],"y":[-367.85022931077634,-877.22738590631434,-360.03863194199272,315.92886325687863,242.89017839289528,587.86285462667865],"z":[-359.32561657119618,-436.44625190151817,-395.88058152270895,19.968319463757979,269.66875239618179,64.128987204032157],"type":"scatter3d","mode":"markers","name":"0.1 uM iSYK","marker":{"color":"rgba(199,233,192,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(199,233,192,1)"}},"textfont":{"color":"rgba(199,233,192,1)","size":55},"error_y":{"color":"rgba(199,233,192,1)","width":55},"error_x":{"color":"rgba(199,233,192,1)","width":55},"line":{"color":"rgba(199,233,192,1)","width":55},"frame":null},{"x":[1863.6948828289198,3666.2040527118843,3326.329456161031,540.27668600991478,4907.7534485514743,-1885.1279717945304],"y":[-497.84209484683026,-308.05366810372522,-454.47215506776149,863.80395247634658,770.91335109639306,1235.796530941745],"z":[-294.68589365946212,-349.07057492885338,-418.47116064609349,17.970212624426633,353.01750648428191,-20.490867231051407],"type":"scatter3d","mode":"markers","name":"1 uM iBTK","marker":{"color":"rgba(158,154,200,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(158,154,200,1)"}},"textfont":{"color":"rgba(158,154,200,1)","size":55},"error_y":{"color":"rgba(158,154,200,1)","width":55},"error_x":{"color":"rgba(158,154,200,1)","width":55},"line":{"color":"rgba(158,154,200,1)","width":55},"frame":null},{"x":[-2320.0801555995049,249.13267643774248,4852.2660462079075,-1771.2161734530071,-828.29642820936783,5074.4266019653533],"y":[19.887898154775492,-27.329394840538324,-10.383169788481739,632.49709612116396,727.70442560497872,322.20788867285466],"z":[-577.04732112908732,-841.34685932287709,-784.01945361910998,-181.91189720344897,-290.78015120659154,103.97859995309366],"type":"scatter3d","mode":"markers","name":"1 uM iNFkB","marker":{"color":"rgba(253,141,60,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(253,141,60,1)"}},"textfont":{"color":"rgba(253,141,60,1)","size":55},"error_y":{"color":"rgba(253,141,60,1)","width":55},"error_x":{"color":"rgba(253,141,60,1)","width":55},"line":{"color":"rgba(253,141,60,1)","width":55},"frame":null},{"x":[4489.7883840716904,-5252.8739720310186,-2139.773040194335,10097.551606533849,-2122.1001584743599,596.08675033833379],"y":[-1204.1717740374954,-371.31175856455195,-555.98585924556653,-676.67379653698708,69.727938080278136,30.428783560737514],"z":[283.680439033352,87.397835926377965,121.8927759683226,801.80959826031346,323.8448304805172,443.61304396840922],"type":"scatter3d","mode":"markers","name":"1 uM iSYK","marker":{"color":"rgba(116,196,118,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(116,196,118,1)"}},"textfont":{"color":"rgba(116,196,118,1)","size":55},"error_y":{"color":"rgba(116,196,118,1)","width":55},"error_x":{"color":"rgba(116,196,118,1)","width":55},"line":{"color":"rgba(116,196,118,1)","width":55},"frame":null},{"x":[293.49129004119283,-3730.6713377074479,3667.8533252502762,-871.89590607029163,-6617.8546954099602,-722.87945548241362],"y":[-738.41711898621679,-413.59251062889416,-788.0325778805485,211.52772482771385,314.7363326143219,514.2656506313607],"z":[281.70547907554891,68.545527138321106,210.42750801428645,469.89282830775073,158.99757116167885,597.98104357628608],"type":"scatter3d","mode":"markers","name":"10 uM iBTK","marker":{"color":"rgba(106,81,163,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(106,81,163,1)"}},"textfont":{"color":"rgba(106,81,163,1)","size":55},"error_y":{"color":"rgba(106,81,163,1)","width":55},"error_x":{"color":"rgba(106,81,163,1)","width":55},"line":{"color":"rgba(106,81,163,1)","width":55},"frame":null},{"x":[-12617.353569657573,-5763.3636237091778,-3970.7099158034234,-11409.314379102349,-5857.0903848159078,-5261.4357066866733],"y":[460.43161461198605,277.95836081412182,235.95444950892539,601.54450156263442,584.97453282314109,486.10712375883668],"z":[-640.78712301232213,-679.56721764309236,-577.84204811419988,-334.13350447548248,-294.06988356979826,-129.43574266550769],"type":"scatter3d","mode":"markers","name":"10 uM iNFkB","marker":{"color":"rgba(217,72,1,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(217,72,1,1)"}},"textfont":{"color":"rgba(217,72,1,1)","size":55},"error_y":{"color":"rgba(217,72,1,1)","width":55},"error_x":{"color":"rgba(217,72,1,1)","width":55},"line":{"color":"rgba(217,72,1,1)","width":55},"frame":null},{"x":[-2119.3346150759871,-4112.2173566567817,-463.70659875401304,6452.0428972644731,-4375.407943892269,-48.326158453613942],"y":[-757.30277852788413,-490.65551326541407,-714.17102845359739,-1017.8441097924805,-66.413927567259606,-211.88317659682554],"z":[263.27164560212913,208.91627994812191,376.67448760672733,967.95122282089665,385.46593652718144,481.41722514792701],"type":"scatter3d","mode":"markers","name":"10 uM iSYK","marker":{"color":"rgba(35,139,69,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(35,139,69,1)"}},"textfont":{"color":"rgba(35,139,69,1)","size":55},"error_y":{"color":"rgba(35,139,69,1)","width":55},"error_x":{"color":"rgba(35,139,69,1)","width":55},"line":{"color":"rgba(35,139,69,1)","width":55},"frame":null},{"x":[-1085.6866656742973,-702.62744398306768,-2845.2842912195915,-8107.7420565964549,-3353.4873220577206,-9582.7254945180121],"y":[-670.90268493353915,-628.11161869438581,-633.89819947779074,32.94452263012338,-158.96443304692124,161.07639813339568],"z":[217.63745845832472,384.56319027542162,213.74869238588732,315.97443969588033,627.61038477165107,292.42965372124524],"type":"scatter3d","mode":"markers","name":"100 uM iBTK","marker":{"color":"rgba(63,0,125,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(63,0,125,1)"}},"textfont":{"color":"rgba(63,0,125,1)","size":55},"error_y":{"color":"rgba(63,0,125,1)","width":55},"error_x":{"color":"rgba(63,0,125,1)","width":55},"line":{"color":"rgba(63,0,125,1)","width":55},"frame":null},{"x":[-11252.923444191523,-8536.429900043031,-4762.2533157447024,-13271.241848336947,-8579.3470578487741,-6644.09129236631],"y":[-312.46463342229293,-623.34324186749848,-837.6188660583922,170.52062192245523,-411.79925738319963,-454.42431233895235],"z":[-47.215337570982037,202.36520903593481,425.1050154244241,-38.315739094268956,240.37197865584221,481.99454597567495],"type":"scatter3d","mode":"markers","name":"100 uM iNFkB","marker":{"color":"rgba(127,39,4,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(127,39,4,1)"}},"textfont":{"color":"rgba(127,39,4,1)","size":55},"error_y":{"color":"rgba(127,39,4,1)","width":55},"error_x":{"color":"rgba(127,39,4,1)","width":55},"line":{"color":"rgba(127,39,4,1)","width":55},"frame":null},{"x":[-3353.5890736480142,-623.0725465143031,3031.1155340212426,-2021.9415903539873,-4732.1995258525494,-7883.4966761364813],"y":[-686.17854971831594,-918.40468947486886,-1335.5180979770093,-540.73622483381234,-177.93187781240084,-102.31237222705026],"z":[479.26064207285293,402.26020926991185,734.1902640128344,672.27709951134011,555.88749785865673,327.75911401410423],"type":"scatter3d","mode":"markers","name":"100 uM iSYK","marker":{"color":"rgba(0,68,27,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,68,27,1)"}},"textfont":{"color":"rgba(0,68,27,1)","size":55},"error_y":{"color":"rgba(0,68,27,1)","width":55},"error_x":{"color":"rgba(0,68,27,1)","width":55},"line":{"color":"rgba(0,68,27,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="isyk-samples" class="section level3">
<h3>iSYK samples</h3>
<p>PCA with only the iSYK samples</p>
<pre class="r"><code># Prepare data for FactoMineR package
# cts: dataframe with wells as row names, proteins as column names, and count data as cell values
# coldata: dataframe with wells as row names and all metadata as columns
cts &lt;- data_well_all  %&gt;%
  filter(counts &gt;= 1 &amp; inhibitor == &quot;iSYK&quot;) %&gt;%
  dplyr::select(target_nospace, plate_well, counts) %&gt;%
  filter(!is.na(counts)) %&gt;%
  spread(target_nospace, counts) %&gt;%
  replace(is.na(.), 0)

cts &lt;- column_to_rownames(cts, &quot;plate_well&quot;)
# cts2 &lt;- as.matrix(as.data.frame(cts), row_names = TRUE)

coldata &lt;- data.frame(plate_well = rownames(cts)) %&gt;%
  left_join(distinct(dplyr::select(data_well_all, all_of(meta_cols)))) %&gt;%
  mutate(stimulus = factor(stimulus, levels = stim_DS108), 
         cell_line = factor(cell_line, levels = cells_DS108), 
         inhibitor = factor(inhibitor, levels = inhib_DS108), 
         inhib_conc = factor(inhib_conc, levels = inhib_conc_DS108)) #If necessary, make factors of some metadata columns

rownames(coldata) &lt;- coldata$plate_well</code></pre>
<pre class="r"><code># Results
results_iSYK &lt;- PCA(cts, scale.unit = FALSE, ncp = 5, graph = FALSE)

# Percentage variance explained by each PC
expl_var_iSYK &lt;- as.data.frame(get_eigenvalue(results_iSYK)) %&gt;%
  rownames_to_column(&quot;PC&quot;) %&gt;%
  pull(var = variance.percent, name = PC) %&gt;%
  round(digits = 1)

# Results focused on variables (proteins)
variab_iSYK &lt;- get_pca_var(results_iSYK) 
# head(variab$contrib)

# Results focused on individuals (wells)
indiv_iSYK &lt;- get_pca_ind(results_iSYK) 
# head(indiv$contrib)
pca_data_iSYK &lt;- as.data.frame(indiv_iSYK$coord[, 1:3]) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3) %&gt;% 
  left_join(coldata)</code></pre>
<pre class="r"><code># Variance explained by each PC (eigenvalues)
fviz_eig(results_iSYK, addlabels = TRUE)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_iSYK-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_iSYK-1">
Past versions of Facto_vis_iSYK-1.png
</button>
</p>
<div id="fig-Facto_vis_iSYK-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_var(results_iSYK, col.var = &quot;black&quot;)

# Quality of representation for variables
# corrplot(variab_iSYK$cos2, is.corr = FALSE)
# corrplot(variab_iSYK$contrib, is.corr = FALSE)

contrib_2.5p &lt;- as.data.frame(variab_iSYK$contrib) %&gt;%
  # rownames_to_column(&quot;target_nospace&quot;) %&gt;%
  filter(Dim.1 &gt;= 2.5 | Dim.2 &gt;= 2.5 | Dim.3 &gt;= 2.5) %&gt;% # | Dim.4 &gt;= 1 | Dim.5 &gt;= 1
  dplyr::rename(PC1 = Dim.1, PC2 =  Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC5 = Dim.5) %&gt;%
  dplyr::select(c(PC1, PC2, PC3)) %&gt;%
  as.matrix()
  # filter_all(any_vars(.&gt;1))
corrplot(contrib_2.5p, is.corr = FALSE, method = &quot;circle&quot;, outline = TRUE, 
         tl.col = &quot;black&quot;, cl.ratio = 0.75, cl.offset = 1, 
         title = &quot;Protein contributions to PC (&gt;2.5% in any PC)(iSYK only)&quot;)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_iSYK-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_iSYK-2">
Past versions of Facto_vis_iSYK-2.png
</button>
</p>
<div id="fig-Facto_vis_iSYK-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Top10 contributing proteins to PC1-3 
fig_PC1 &lt;- fviz_contrib(results_iSYK, choice = &quot;var&quot;, axes = 1, top = 10)
fig_PC2 &lt;- fviz_contrib(results_iSYK, choice = &quot;var&quot;, axes = 2, top = 10)
fig_PC3 &lt;- fviz_contrib(results_iSYK, choice = &quot;var&quot;, axes = 3, top = 10)
plot_grid(fig_PC1, fig_PC2, fig_PC3, ncol = 3)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_iSYK-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_iSYK-3">
Past versions of Facto_vis_iSYK-3.png
</button>
</p>
<div id="fig-Facto_vis_iSYK-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_ind(results_iSYK,
#              axes = c(1, 2),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus),
#              addEllipses = TRUE)
# fviz_pca_ind(results_iSYK,
#              axes = c(1, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus),
#              addEllipses = TRUE)
# fviz_pca_ind(results_iSYK,
#              axes = c(2, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus),
#              addEllipses = TRUE)
# plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3)</code></pre>
<pre class="r"><code># pca_data_iSYK
fig_PC12 &lt;- ggplot(pca_data_iSYK) + 
  geom_point(aes(x = PC1, y = PC2, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, expl_var_all[2], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC2 (iSYK only)&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC12
fig_PC13 &lt;- ggplot(pca_data_iSYK) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC3&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC13
fig_PC23 &lt;- ggplot(pca_data_iSYK) + 
  geom_point(aes(x = PC2, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC2: &quot;, expl_var_all[2], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC2 vs PC3&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC23

fig &lt;- plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3, align = &quot;h&quot;, rel_widths = c(1, 1, 1.5))
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_iSYK-1.png" width="1536" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_iSYK-1">
Past versions of Facto_2D_iSYK-1.png
</button>
</p>
<div id="fig-Facto_2D_iSYK-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="ibtk-samples" class="section level3">
<h3>iBTK samples</h3>
<p>PCA with only the iBTK samples</p>
<pre class="r"><code># Prepare data for FactoMineR package
# cts: dataframe with wells as row names, proteins as column names, and count data as cell values
# coldata: dataframe with wells as row names and all metadata as columns
cts &lt;- data_well_all  %&gt;%
  filter(counts &gt;= 1 &amp; inhibitor == &quot;iBTK&quot;) %&gt;%
  dplyr::select(target_nospace, plate_well, counts) %&gt;%
  filter(!is.na(counts)) %&gt;%
  spread(target_nospace, counts) %&gt;%
  replace(is.na(.), 0)

cts &lt;- column_to_rownames(cts, &quot;plate_well&quot;)
# cts2 &lt;- as.matrix(as.data.frame(cts), row_names = TRUE)

coldata &lt;- data.frame(plate_well = rownames(cts)) %&gt;%
  left_join(distinct(dplyr::select(data_well_all, all_of(meta_cols)))) %&gt;%
  mutate(stimulus = factor(stimulus, levels = stim_DS108), 
         cell_line = factor(cell_line, levels = cells_DS108), 
         inhibitor = factor(inhibitor, levels = inhib_DS108), 
         inhib_conc = factor(inhib_conc, levels = inhib_conc_DS108)) #If necessary, make factors of some metadata columns

rownames(coldata) &lt;- coldata$plate_well</code></pre>
<pre class="r"><code># Results
results_iBTK &lt;- PCA(cts, scale.unit = FALSE, ncp = 5, graph = FALSE)

# Percentage variance explained by each PC
expl_var_iBTK &lt;- as.data.frame(get_eigenvalue(results_iBTK)) %&gt;%
  rownames_to_column(&quot;PC&quot;) %&gt;%
  pull(var = variance.percent, name = PC) %&gt;%
  round(digits = 1)

# Results focused on variables (proteins)
variab_iBTK &lt;- get_pca_var(results_iBTK) 
# head(variab$contrib)

# Results focused on individuals (wells)
indiv_iBTK &lt;- get_pca_ind(results_iBTK) 
# head(indiv$contrib)
pca_data_iBTK &lt;- as.data.frame(indiv_iBTK$coord[, 1:3]) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3) %&gt;% 
  left_join(coldata)</code></pre>
<pre class="r"><code># Variance explained by each PC (eigenvalues)
fviz_eig(results_iBTK, addlabels = TRUE)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_iBTK-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_iBTK-1">
Past versions of Facto_vis_iBTK-1.png
</button>
</p>
<div id="fig-Facto_vis_iBTK-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_var(results_iBTK, col.var = &quot;black&quot;)

# Quality of representation for variables
# corrplot(variab_iBTK$cos2, is.corr = FALSE)
# corrplot(variab_iBTK$contrib, is.corr = FALSE)

contrib_2.5p &lt;- as.data.frame(variab_iBTK$contrib) %&gt;%
  # rownames_to_column(&quot;target_nospace&quot;) %&gt;%
  filter(Dim.1 &gt;= 2.5 | Dim.2 &gt;= 2.5 | Dim.3 &gt;= 2.5) %&gt;% # | Dim.4 &gt;= 1 | Dim.5 &gt;= 1
  dplyr::rename(PC1 = Dim.1, PC2 =  Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC5 = Dim.5) %&gt;%
  dplyr::select(c(PC1, PC2, PC3)) %&gt;%
  as.matrix()
  # filter_all(any_vars(.&gt;1))
corrplot(contrib_2.5p, is.corr = FALSE, method = &quot;circle&quot;, outline = TRUE, 
         tl.col = &quot;black&quot;, cl.ratio = 0.75, cl.offset = 1, 
         title = &quot;Protein contributions to PC (&gt;2.5% in any PC)(iBTK only)&quot;)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_iBTK-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_iBTK-2">
Past versions of Facto_vis_iBTK-2.png
</button>
</p>
<div id="fig-Facto_vis_iBTK-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Top10 contributing proteins to PC1-3 
fig_PC1 &lt;- fviz_contrib(results_iBTK, choice = &quot;var&quot;, axes = 1, top = 10)
fig_PC2 &lt;- fviz_contrib(results_iBTK, choice = &quot;var&quot;, axes = 2, top = 10)
fig_PC3 &lt;- fviz_contrib(results_iBTK, choice = &quot;var&quot;, axes = 3, top = 10)
plot_grid(fig_PC1, fig_PC2, fig_PC3, ncol = 3)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_iBTK-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_iBTK-3">
Past versions of Facto_vis_iBTK-3.png
</button>
</p>
<div id="fig-Facto_vis_iBTK-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_ind(results_iBTK,
#              axes = c(1, 2),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus),
#              addEllipses = TRUE)
# fviz_pca_ind(results_iBTK,
#              axes = c(1, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus),
#              addEllipses = TRUE)
# fviz_pca_ind(results_iBTK,
#              axes = c(2, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus),
#              addEllipses = TRUE)
# plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3)</code></pre>
<pre class="r"><code># pca_data_iBTK
fig_PC12 &lt;- ggplot(pca_data_iBTK) + 
  geom_point(aes(x = PC1, y = PC2, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, expl_var_all[2], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC2 (iBTK only)&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC12
fig_PC13 &lt;- ggplot(pca_data_iBTK) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC3&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC13
fig_PC23 &lt;- ggplot(pca_data_iBTK) + 
  geom_point(aes(x = PC2, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC2: &quot;, expl_var_all[2], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC2 vs PC3&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC23

fig &lt;- plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3, align = &quot;h&quot;, rel_widths = c(1, 1, 1.5))
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_iBTK-1.png" width="1536" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_iBTK-1">
Past versions of Facto_2D_iBTK-1.png
</button>
</p>
<div id="fig-Facto_2D_iBTK-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="infkb-samples" class="section level3">
<h3>iNFkB samples</h3>
<p>PCA with only the iNFkB samples</p>
<pre class="r"><code># Prepare data for FactoMineR package
# cts: dataframe with wells as row names, proteins as column names, and count data as cell values
# coldata: dataframe with wells as row names and all metadata as columns
cts &lt;- data_well_all  %&gt;%
  filter(counts &gt;= 1 &amp; inhibitor == &quot;iNFkB&quot;) %&gt;%
  dplyr::select(target_nospace, plate_well, counts) %&gt;%
  filter(!is.na(counts)) %&gt;%
  spread(target_nospace, counts) %&gt;%
  replace(is.na(.), 0)

cts &lt;- column_to_rownames(cts, &quot;plate_well&quot;)
# cts2 &lt;- as.matrix(as.data.frame(cts), row_names = TRUE)

coldata &lt;- data.frame(plate_well = rownames(cts)) %&gt;%
  left_join(distinct(dplyr::select(data_well_all, all_of(meta_cols)))) %&gt;%
  mutate(stimulus = factor(stimulus, levels = stim_DS108), 
         cell_line = factor(cell_line, levels = cells_DS108), 
         inhibitor = factor(inhibitor, levels = inhib_DS108), 
         inhib_conc = factor(inhib_conc, levels = inhib_conc_DS108)) #If necessary, make factors of some metadata columns

rownames(coldata) &lt;- coldata$plate_well</code></pre>
<pre class="r"><code># Results
results_iNFkB &lt;- PCA(cts, scale.unit = FALSE, ncp = 5, graph = FALSE)

# Percentage variance explained by each PC
expl_var_iNFkB &lt;- as.data.frame(get_eigenvalue(results_iNFkB)) %&gt;%
  rownames_to_column(&quot;PC&quot;) %&gt;%
  pull(var = variance.percent, name = PC) %&gt;%
  round(digits = 1)

# Results focused on variables (proteins)
variab_iNFkB &lt;- get_pca_var(results_iNFkB) 
# head(variab$contrib)

# Results focused on individuals (wells)
indiv_iNFkB &lt;- get_pca_ind(results_iNFkB) 
# head(indiv$contrib)
pca_data_iNFkB &lt;- as.data.frame(indiv_iNFkB$coord[, 1:3]) %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  dplyr::rename(PC1 = Dim.1, PC2 = Dim.2, PC3 = Dim.3) %&gt;% 
  left_join(coldata)</code></pre>
<pre class="r"><code># Variance explained by each PC (eigenvalues)
fviz_eig(results_iNFkB, addlabels = TRUE)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_iNFkB-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_iNFkB-1">
Past versions of Facto_vis_iNFkB-1.png
</button>
</p>
<div id="fig-Facto_vis_iNFkB-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_var(results_iNFkB, col.var = &quot;black&quot;)

# Quality of representation for variables
# corrplot(variab_iNFkB$cos2, is.corr = FALSE)
# corrplot(variab_iNFkB$contrib, is.corr = FALSE)

contrib_2.5p &lt;- as.data.frame(variab_iNFkB$contrib) %&gt;%
  # rownames_to_column(&quot;target_nospace&quot;) %&gt;%
  filter(Dim.1 &gt;= 2.5 | Dim.2 &gt;= 2.5 | Dim.3 &gt;= 2.5) %&gt;% # | Dim.4 &gt;= 1 | Dim.5 &gt;= 1
  dplyr::rename(PC1 = Dim.1, PC2 =  Dim.2, PC3 = Dim.3, PC4 = Dim.4, PC5 = Dim.5) %&gt;%
  dplyr::select(c(PC1, PC2, PC3)) %&gt;%
  as.matrix()
  # filter_all(any_vars(.&gt;1))
corrplot(contrib_2.5p, is.corr = FALSE, method = &quot;circle&quot;, outline = TRUE, 
         tl.col = &quot;black&quot;, cl.ratio = 0.75, cl.offset = 1, 
         title = &quot;Protein contributions to PC (&gt;2.5% in any PC)(iNFkB only)&quot;)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_iNFkB-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_iNFkB-2">
Past versions of Facto_vis_iNFkB-2.png
</button>
</p>
<div id="fig-Facto_vis_iNFkB-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Top10 contributing proteins to PC1-3 
fig_PC1 &lt;- fviz_contrib(results_iNFkB, choice = &quot;var&quot;, axes = 1, top = 10)
fig_PC2 &lt;- fviz_contrib(results_iNFkB, choice = &quot;var&quot;, axes = 2, top = 10)
fig_PC3 &lt;- fviz_contrib(results_iNFkB, choice = &quot;var&quot;, axes = 3, top = 10)
plot_grid(fig_PC1, fig_PC2, fig_PC3, ncol = 3)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_vis_iNFkB-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_vis_iNFkB-3">
Past versions of Facto_vis_iNFkB-3.png
</button>
</p>
<div id="fig-Facto_vis_iNFkB-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># fviz_pca_ind(results_iNFkB,
#              axes = c(1, 2),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus),
#              addEllipses = TRUE)
# fviz_pca_ind(results_iNFkB,
#              axes = c(1, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus),
#              addEllipses = TRUE)
# fviz_pca_ind(results_iNFkB,
#              axes = c(2, 3),
#              geom.ind = &quot;point&quot;,
#              mean.point = FALSE,
#              col.ind = paste(coldata$cell_line, coldata$stimulus),
#              addEllipses = TRUE)
# plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3)</code></pre>
<pre class="r"><code># pca_data_iNFkB
fig_PC12 &lt;- ggplot(pca_data_iNFkB) + 
  geom_point(aes(x = PC1, y = PC2, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, expl_var_all[2], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC2 (iNFkB only)&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC12
fig_PC13 &lt;- ggplot(pca_data_iNFkB) + 
  geom_point(aes(x = PC1, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC1: &quot;, expl_var_all[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC1 vs PC3&quot;) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC13
fig_PC23 &lt;- ggplot(pca_data_iNFkB) + 
  geom_point(aes(x = PC2, y = PC3, shape = cell_line, color = paste(stimulus, &quot;-&quot;, inhib_conc)), size = 3) + 
  # facet_grid(cell_line~inhibitor) +
  scale_color_manual(values = c(colors_orange9[3:7], colors_grey9[3:7]), name = &quot;Stim - Inhib conc&quot;) +
  xlab(paste0(&quot;PC2: &quot;, expl_var_all[2], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, expl_var_all[3], &quot;% variance&quot;)) + 
  ggtitle(&quot;PC2 vs PC3&quot;) +
  theme_bw() +
  # theme(legend.position = &quot;none&quot;) +
  textsize_small
# fig_PC23

fig &lt;- plot_grid(fig_PC12, fig_PC13, fig_PC23, ncol = 3, align = &quot;h&quot;, rel_widths = c(1, 1, 1.5))
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/Facto_2D_iNFkB-1.png" width="1536" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Facto_2D_iNFkB-1">
Past versions of Facto_2D_iNFkB-1.png
</button>
</p>
<div id="fig-Facto_2D_iNFkB-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="pca-via-prcomp" class="section level2">
<h2>PCA via prcomp</h2>
<div id="all-samples-2" class="section level3">
<h3>All samples</h3>
<pre class="r"><code># Prepare data for prcomp package
# cts: dataframe with wells as row names, proteins as column names, and count data as cell values
# coldata: dataframe with wells as row names and all metadata as columns
cts &lt;- data_well_all  %&gt;%
  filter(counts &gt;= 1) %&gt;%
  dplyr::select(target_nospace, plate_well, counts) %&gt;%
  filter(!is.na(counts)) %&gt;%
  spread(target_nospace, counts) %&gt;%
  replace(is.na(.), 0)

cts &lt;- column_to_rownames(cts, &quot;plate_well&quot;)
# cts2 &lt;- as.matrix(as.data.frame(cts), row_names = TRUE)

coldata &lt;- data.frame(plate_well = rownames(cts)) %&gt;%
  left_join(distinct(dplyr::select(data_well_all, all_of(meta_cols)))) %&gt;%
  mutate(stimulus = factor(stimulus, levels = stim_DS108), 
         cell_line = factor(cell_line, levels = cells_DS108), 
         inhibitor = factor(inhibitor, levels = inhib_DS108), 
         inhib_conc = factor(inhib_conc, levels = inhib_conc_DS108)) #If necessary, make factors of some metadata columns

rownames(coldata) &lt;- coldata$plate_well</code></pre>
<pre class="r"><code># Results
prcomp_results &lt;- prcomp(cts)
# summary(results_prcomp)
components &lt;- prcomp_results[[&quot;x&quot;]]
components &lt;- data.frame(components)
components$PC2 &lt;- components$PC2
components$PC3 &lt;- -components$PC3
prcomp_data &lt;- components[, 1:3] %&gt;%
  rownames_to_column(&quot;plate_well&quot;) %&gt;%
  left_join(coldata)

prcomp_expl_var &lt;- (summary(prcomp_results)[[&quot;importance&quot;]][&#39;Proportion of Variance&#39;,]) * 100
prcomp_expl_var3 &lt;- sum(prcomp_expl_var[1:3])</code></pre>
<pre class="r"><code># 2D scatterplot of PC1-2
# fig &lt;- plot_ly(prcomp_data, x = ~PC1, y = ~PC2, color = ~stimulus, colors = colors_stim) %&gt;%
#   add_markers(size = 12)
# fig

fig12 &lt;- ggplot(arrange(prcomp_data, inhibitor)) + 
  geom_point(aes(x = PC1, y = PC2, color = inhib_conc_text, shape = stimulus), size = 2.5) + 
  facet_wrap(~cell_line, ncol = 1) +
  xlab(paste0(&quot;PC1: &quot;, prcomp_expl_var[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, prcomp_expl_var[2], &quot;% variance&quot;)) + 
  scale_color_manual(values = colors_inhib_conc, breaks = inhib_full_DS108) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
fig13 &lt;- ggplot(arrange(prcomp_data, inhibitor)) + 
  geom_point(aes(x = PC1, y = PC3, color = inhib_conc_text, shape = stimulus), size = 2.5) + 
  facet_wrap(~cell_line, ncol = 1) +
  xlab(paste0(&quot;PC1: &quot;, prcomp_expl_var[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, prcomp_expl_var[3], &quot;% variance&quot;)) + 
  scale_color_manual(values = colors_inhib_conc, breaks = inhib_full_DS108) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
fig23 &lt;- ggplot(arrange(prcomp_data, inhibitor)) + 
  geom_point(aes(x = PC2, y = PC3, color = inhib_conc_text, shape = stimulus), size = 2.5) + 
  facet_wrap(~cell_line, ncol = 1) +
  xlab(paste0(&quot;PC2: &quot;, prcomp_expl_var[2], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, prcomp_expl_var[3], &quot;% variance&quot;)) + 
  scale_color_manual(values = colors_inhib_conc, breaks = inhib_full_DS108) +
  theme_bw() +
  textsize_small
fig &lt;- plot_grid(fig12, fig13, fig23, ncol = 3)
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/prcomp_plotly_2D-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-prcomp_plotly_2D-1">
Past versions of prcomp_plotly_2D-1.png
</button>
</p>
<div id="fig-prcomp_plotly_2D-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>fig12 &lt;- ggplot(arrange(prcomp_data, inhibitor)) + 
  geom_point(aes(x = PC1, y = PC2, color = paste(cell_line, inhib_conc), shape = stimulus), size = 2.5) + 
  facet_wrap(~inhibitor, ncol = 1) +
  xlab(paste0(&quot;PC1: &quot;, prcomp_expl_var[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;, prcomp_expl_var[2], &quot;% variance&quot;)) + 
  scale_color_manual(values = c(colors_pr9[c(3:7)], colors_yb9[c(3:7)])) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
fig13 &lt;- ggplot(arrange(prcomp_data, inhibitor)) + 
  geom_point(aes(x = PC1, y = PC3, color = paste(cell_line, inhib_conc), shape = stimulus), size = 2.5) + 
  facet_wrap(~inhibitor, ncol = 1) +
  xlab(paste0(&quot;PC1: &quot;, prcomp_expl_var[1], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, prcomp_expl_var[3], &quot;% variance&quot;)) + 
  scale_color_manual(values = c(colors_pr9[c(3:7)], colors_yb9[c(3:7)])) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  textsize_small
fig23 &lt;- ggplot(arrange(prcomp_data, inhibitor)) + 
  geom_point(aes(x = PC2, y = PC3, color = paste(cell_line, inhib_conc), shape = stimulus), size = 2.5) + 
  facet_wrap(~inhibitor, ncol = 1) +
  xlab(paste0(&quot;PC2: &quot;, prcomp_expl_var[2], &quot;% variance&quot;)) +
  ylab(paste0(&quot;PC3: &quot;, prcomp_expl_var[3], &quot;% variance&quot;)) + 
  scale_color_manual(values = c(colors_pr9[c(3:7)], colors_yb9[c(3:7)])) +
  theme_bw() +
  textsize_small
fig &lt;- plot_grid(fig12, fig13, fig23, ncol = 3)
print(fig)</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/prcomp_plotly_2D-2.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-prcomp_plotly_2D-2">
Past versions of prcomp_plotly_2D-2.png
</button>
</p>
<div id="fig-prcomp_plotly_2D-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>for (cells in cells_DS108) {
  fig12 &lt;- ggplot(arrange(subset(prcomp_data, cell_line == cells), inhibitor)) + 
    geom_point(aes(x = PC1, y = PC2, color = inhib_conc_text, shape = stimulus), size = 2.5) + 
    facet_wrap(~inhibitor, ncol = 1) +
    xlab(paste0(&quot;PC1: &quot;, prcomp_expl_var[1], &quot;% variance&quot;)) +
    ylab(paste0(&quot;PC2: &quot;, prcomp_expl_var[2], &quot;% variance&quot;)) + 
    ggtitle(cells) +
    scale_color_manual(values = colors_inhib_conc, breaks = inhib_full_DS108) +
    theme_bw() +
    theme(legend.position = &quot;none&quot;) +
    textsize_small
  fig13 &lt;- ggplot(arrange(subset(prcomp_data, cell_line == cells), inhibitor)) + 
    geom_point(aes(x = PC1, y = PC3, color = inhib_conc_text, shape = stimulus), size = 2.5) + 
    facet_wrap(~inhibitor, ncol = 1) +
    xlab(paste0(&quot;PC1: &quot;, prcomp_expl_var[1], &quot;% variance&quot;)) +
    ylab(paste0(&quot;PC3: &quot;, prcomp_expl_var[3], &quot;% variance&quot;)) + 
    scale_color_manual(values = colors_inhib_conc, breaks = inhib_full_DS108) +
    theme_bw() +
    theme(legend.position = &quot;none&quot;) +
    textsize_small
  fig23 &lt;- ggplot(arrange(subset(prcomp_data, cell_line == cells), inhibitor)) + 
    geom_point(aes(x = PC2, y = PC3, color = inhib_conc_text, shape = stimulus), size = 2.5) + 
    facet_wrap(~inhibitor, ncol = 1) +
    xlab(paste0(&quot;PC2: &quot;, prcomp_expl_var[2], &quot;% variance&quot;)) +
    ylab(paste0(&quot;PC3: &quot;, prcomp_expl_var[3], &quot;% variance&quot;)) + 
    scale_color_manual(values = colors_inhib_conc, breaks = inhib_full_DS108) +
    theme_bw() +
    textsize_small
  fig &lt;- plot_grid(fig12, fig13, fig23, ncol = 3, align = &quot;h&quot;)
  print(fig)
}</code></pre>
<p><img src="figure/DS108_r_seq_pca.Rmd/prcomp_plotly_2D-3.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-prcomp_plotly_2D-3">
Past versions of prcomp_plotly_2D-3.png
</button>
</p>
<div id="fig-prcomp_plotly_2D-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><img src="figure/DS108_r_seq_pca.Rmd/prcomp_plotly_2D-4.png" width="1440" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-prcomp_plotly_2D-4">
Past versions of prcomp_plotly_2D-4.png
</button>
</p>
<div id="fig-prcomp_plotly_2D-4" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
4492de7
</td>
<td>
mwitmond
</td>
<td>
2024-10-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># 3D scatter plot of PC1-3
# inhibitor
fig &lt;- plot_ly(prcomp_data, x = ~PC1, y = ~PC2, z = ~PC3, color = ~inhibitor, colors = colors_inhib) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, prcomp_expl_var3))
fig
# inhib_conc
fig &lt;- plot_ly(arrange(prcomp_data, inhibitor), x = ~PC1, y = ~PC2, z = ~PC3, shape = ~stimulus, color = ~inhib_conc, colors = colors_blue9[c(2, 3, 5, 7, 9)]) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, prcomp_expl_var3))
fig
# inhib_conc_text
fig &lt;- plot_ly(arrange(prcomp_data, inhibitor), x = ~PC1, y = ~PC2, z = ~PC3, shape = ~stimulus, color = ~inhib_conc_text, colors = colors_inhib_conc) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, prcomp_expl_var3))
fig
# stimulus
fig &lt;- plot_ly(prcomp_data, x = ~PC1, y = ~PC2, z = ~PC3, color = ~stimulus, colors = colors_stim) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, prcomp_expl_var3))
fig
# cell_line
fig &lt;- plot_ly(prcomp_data, x = ~PC1, y = ~PC2, z = ~PC3, color = ~cell_line, colors = colors_cell) %&gt;%
  add_markers(size = 12) %&gt;%
  layout(title = paste(&quot;Variance explained:&quot;, prcomp_expl_var3))
fig

# # Faceted 3D scatter plot
# prcomp_data %&gt;%
#   arrange(inhibitor) %&gt;%
#   group_by(cell_line) %&gt;%
#   do(p = plot_ly(., x = ~PC1, y = ~PC2, z = ~PC3, type = &quot;scatter&quot;, color = ~inhib_conc_text, colors = colors_inhib_conc)) %&gt;%
#   # add_markers(size = 12) %&gt;%
#   subplot(nrows = 1) #%&gt;%
#   # layout(title = paste(&quot;Variance explained:&quot;, expl_var))</code></pre>
<pre class="r"><code>fig &lt;- plot3d(prcomp_data[, 2:4], col = colors_stim)
fig</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.4.1 (2024-06-14 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 10 x64 (build 19045)

Matrix products: default


locale:
[1] LC_COLLATE=English_Netherlands.utf8  LC_CTYPE=English_Netherlands.utf8   
[3] LC_MONETARY=English_Netherlands.utf8 LC_NUMERIC=C                        
[5] LC_TIME=English_Netherlands.utf8    

time zone: Europe/Amsterdam
tzcode source: internal

attached base packages:
[1] grid      stats4    stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] ashr_2.2-63                 apeglm_1.26.1              
 [3] MASS_7.3-60.2               ggbreak_0.1.2              
 [5] geomtextpath_0.1.4          ggh4x_0.2.8                
 [7] cowplot_1.1.3               patchwork_1.2.0            
 [9] greekLetters_1.0.2          ggpubr_0.6.0               
[11] ggrepel_0.9.5               scales_1.3.0               
[13] ggthemes_5.1.0              RColorBrewer_1.1-3         
[15] scico_1.5.0                 viridis_0.6.5              
[17] viridisLite_0.4.2           gridExtra_2.3              
[19] mmtable2_0.1.3              gt_0.10.1                  
[21] ggvenn_0.1.10               rgl_1.3.1                  
[23] plotly_4.10.4               ggcorrplot_0.1.4.1         
[25] corrplot_0.92               umap_0.2.10.0              
[27] ggplotify_0.1.2             dendsort_0.3.4             
[29] vsn_3.72.0                  ComplexHeatmap_2.20.0      
[31] platetools_0.1.7            kableExtra_1.4.0           
[33] DESeq2_1.44.0               SummarizedExperiment_1.34.0
[35] Biobase_2.64.0              MatrixGenerics_1.16.0      
[37] matrixStats_1.3.0           GenomicRanges_1.56.1       
[39] GenomeInfoDb_1.40.1         IRanges_2.38.0             
[41] S4Vectors_0.42.0            BiocGenerics_0.50.0        
[43] Seurat_5.1.0                SeuratObject_5.0.2         
[45] sp_2.1-4                    rstatix_0.7.2              
[47] factoextra_1.0.7            FactoMineR_2.11            
[49] readxl_1.4.3                Matrix_1.7-0               
[51] lubridate_1.9.3             forcats_1.0.0              
[53] stringr_1.5.1               dplyr_1.1.4                
[55] purrr_1.0.2                 readr_2.1.5                
[57] tidyr_1.3.1                 tibble_3.2.1               
[59] ggplot2_3.5.1               tidyverse_2.0.0            
[61] workflowr_1.7.1            

loaded via a namespace (and not attached):
  [1] vroom_1.6.5             goftest_1.2-3           DT_0.33                
  [4] TH.data_1.1-2           vctrs_0.6.5             spatstat.random_3.2-3  
  [7] digest_0.6.36           png_0.1-8               shape_1.4.6.1          
 [10] git2r_0.33.0            mixsqp_0.3-54           deldir_2.0-4           
 [13] parallelly_1.37.1       SQUAREM_2021.1          reshape2_1.4.4         
 [16] httpuv_1.6.15           foreach_1.5.2           withr_3.0.0            
 [19] xfun_0.45               ggfun_0.1.5             survival_3.6-4         
 [22] memoise_2.0.1           emmeans_1.10.2          systemfonts_1.1.0      
 [25] zoo_1.8-12              GlobalOptions_0.1.2     pbapply_1.7-2          
 [28] promises_1.3.0          scatterplot3d_0.3-44    httr_1.4.7             
 [31] globals_0.16.3          fitdistrplus_1.1-11     ps_1.7.6               
 [34] rstudioapi_0.16.0       UCSC.utils_1.0.0        miniUI_0.1.1.1         
 [37] generics_0.1.3          base64enc_0.1-3         processx_3.8.4         
 [40] zlibbioc_1.50.0         polyclip_1.10-6         GenomeInfoDbData_1.2.12
 [43] SparseArray_1.4.8       xtable_1.8-4            doParallel_1.0.17      
 [46] evaluate_0.24.0         S4Arrays_1.4.1          preprocessCore_1.66.0  
 [49] hms_1.1.3               irlba_2.3.5.1           colorspace_2.1-0       
 [52] ROCR_1.0-11             reticulate_1.38.0       spatstat.data_3.1-2    
 [55] magrittr_2.0.3          lmtest_0.9-40           later_1.3.2            
 [58] lattice_0.22-6          spatstat.geom_3.2-9     future.apply_1.11.2    
 [61] getPass_0.2-4           scattermore_1.2         RcppAnnoy_0.0.22       
 [64] pillar_1.9.0            nlme_3.1-164            iterators_1.0.14       
 [67] compiler_4.4.1          RSpectra_0.16-1         stringi_1.8.4          
 [70] tensor_1.5              plyr_1.8.9              crayon_1.5.3           
 [73] abind_1.4-5             truncnorm_1.0-9         gridGraphics_0.5-1     
 [76] emdbook_1.3.13          locfit_1.5-9.10         bit_4.0.5              
 [79] sandwich_3.1-0          whisker_0.4.1           codetools_0.2-20       
 [82] multcomp_1.4-25         textshaping_0.4.0       openssl_2.2.0          
 [85] crosstalk_1.2.1         bslib_0.7.0             GetoptLong_1.0.5       
 [88] mime_0.12               splines_4.4.1           circlize_0.4.16        
 [91] Rcpp_1.0.12             fastDummies_1.7.3       cellranger_1.1.0       
 [94] Rttf2pt1_1.3.12         leaps_3.2               knitr_1.47             
 [97] utf8_1.2.4              clue_0.3-65             fs_1.6.4               
[100] listenv_0.9.1           ggsignif_0.6.4          estimability_1.5.1     
[103] callr_3.7.6             statmod_1.5.0           tzdb_0.4.0             
[106] svglite_2.1.3           pkgconfig_2.0.3         tools_4.4.1            
[109] cachem_1.1.0            numDeriv_2016.8-1.1     fastmap_1.2.0          
[112] rmarkdown_2.27          ica_1.0-3               broom_1.0.6            
[115] sass_0.4.9              coda_0.19-4.1           BiocManager_1.30.23    
[118] dotCall64_1.1-1         carData_3.0-5           RANN_2.6.1             
[121] farver_2.1.2            yaml_2.3.8              cli_3.6.3              
[124] leiden_0.4.3.1          lifecycle_1.0.4         askpass_1.2.0          
[127] uwot_0.2.2              mvtnorm_1.2-5           backports_1.5.0        
[130] BiocParallel_1.38.0     timechange_0.3.0        gtable_0.3.5           
[133] rjson_0.2.21            ggridges_0.5.6          progressr_0.14.0       
[136] parallel_4.4.1          limma_3.60.3            jsonlite_1.8.8         
[139] RcppHNSW_0.6.0          bit64_4.0.5             multcompView_0.1-10    
[142] assertthat_0.2.1        Rtsne_0.17              yulab.utils_0.1.4      
[145] spatstat.utils_3.0-5    bdsmatrix_1.3-7         highr_0.11             
[148] jquerylib_0.1.4         lazyeval_0.2.2          shiny_1.8.1.1          
[151] htmltools_0.5.8.1       affy_1.82.0             sctransform_0.4.1      
[154] glue_1.7.0              spam_2.10-0             XVector_0.44.0         
[157] rprojroot_2.0.4         flashClust_1.01-2       invgamma_1.1           
[160] igraph_2.0.3            extrafontdb_1.0         R6_2.5.1               
[163] labeling_0.4.3          bbmle_1.0.25.1          cluster_2.1.6          
[166] aplot_0.2.3             DelayedArray_0.30.1     tidyselect_1.2.1       
[169] xml2_1.3.6              car_3.1-2               future_1.33.2          
[172] munsell_0.5.1           KernSmooth_2.23-24      affyio_1.74.0          
[175] data.table_1.15.4       htmlwidgets_1.6.4       rlang_1.1.4            
[178] spatstat.sparse_3.1-0   extrafont_0.19          spatstat.explore_3.2-7 
[181] fansi_1.0.6            </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
